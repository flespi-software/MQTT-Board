(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{0:function(e,t){},"049c":function(e,t,s){"use strict";s("52f0")},"04a0":function(e,t,s){"use strict";s("c0fa")},"0a8d":function(e,t,s){"use strict";s("636b")},"1f15":function(e,t,s){},2:function(e,t){},"24bc":function(e,t,s){},"2cd3":function(e,t,s){},3:function(e,t){},"3b81":function(e,t,s){"use strict";s("df50")},4:function(e,t){},"52f0":function(e,t,s){},"57fe":function(e,t,s){"use strict";s("1f15")},"5aba":function(e,t,s){},"636b":function(e,t,s){},"6ee5":function(e,t,s){},"744b":function(e,t,s){"use strict";s("24bc")},9224:function(e){e.exports=JSON.parse('{"a":"2.6.7"}')},ab66:function(e,t,s){"use strict";s("5aba")},acb2:function(e,t,s){},b2fe:function(e,t,s){"use strict";s("6ee5")},b9c9:function(e,t,s){},c0fa:function(e,t,s){},d0b1:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return o}));const i={clientId:`mqtt-board-${Math.random().toString(16).substr(2,8)}`,wsOptions:{objectMode:!1,perMessageDeflate:!0},host:"wss://mqtt.flespi.io",keepalive:420,protocolVersion:5,resubscribe:!1,clean:!0,username:"FlespiToken XXXXXXXXXXXXXXXXXXX",password:"",properties:{sessionExpiryInterval:void 0,receiveMaximum:void 0,maximumPacketSize:void 0,topicAliasMaximum:void 0,requestResponseInformation:!1,requestProblemInformation:!1,userProperties:void 0,authenticationMethod:void 0,authenticationData:void 0},will:{topic:void 0,payload:void 0,qos:0,retain:!1,properties:{willDelayInterval:void 0,payloadFormatIndicator:!1,messageExpiryInterval:void 0,contentType:void 0,responseTopic:void 0,correlationData:void 0,userProperties:void 0}}},r={topic:"#",mode:0,treeField:"",highlight:!0,options:{qos:0,nl:!1,rap:!1,rh:0,properties:{subscriptionIdentifier:void 0,userProperties:void 0}},unsubscribeProperties:{userProperties:void 0}},o={topic:"my/topic",payload:'{"hello": "world"}',options:{qos:0,retain:!1,dup:!1,properties:{payloadFormatIndicator:void 0,messageExpiryInterval:void 0,topicAlias:void 0,responseTopic:void 0,correlationData:void 0,userProperties:void 0,contentType:void 0}}}},db71:function(e,t,s){"use strict";s("2cd3")},db97:function(e){e.exports=JSON.parse('{"devices":{"selectors":[{"name":"devices","getter":{"name":"getDevices","params":[]},"value":{"label":"all","value":"+"}}],"children":{"state":{"topic":{"topicPattern":"flespi/state/gw/devices/${devices}/${fields}","payloadType":"string"},"selectors":[{"name":"fields","list":[{"label":"ID","value":"id"},{"label":"Name","value":"name"},{"label":"Device type ID","value":"device_type_id"},{"label":"Configuration","value":"configuration"},{"label":"Settings","value":"settings"},{"label":"Messages size","value":"messages_size"},{"label":"Messages TTL","value":"messages_ttl"},{"label":"Messages rotate","value":"messages_rotate"},{"label":"Blocked status","value":"blocked"},{"label":"Connected status","value":"connected"},{"label":"CID","value":"cid"}],"value":{"label":"all","value":"+"}}]},"messages":{"topic":{"topicPattern":"flespi/message/gw/devices/${devices}","payloadType":"JSON"}},"intervals":{"topic":{"topicPattern":"flespi/interval/gw/calcs/${calcs}/devices/${devices}/${events}","payloadType":"JSON"},"selectors":[{"name":"calcs","getter":{"name":"getCalcs","params":["devices"]},"value":{"label":"all","value":"+"}},{"name":"events","list":[{"label":"Created","value":"created"},{"label":"Updated","value":"updated"},{"label":"Deleted","value":"deleted"}],"value":{"label":"all","value":"+"}}]},"logs":{"topic":{"topicPattern":"flespi/log/gw/devices/${devices}/${event type}","payloadType":"JSON"},"selectors":[{"name":"event type","list":[{"label":"Created","value":"created"},{"label":"Updated","value":"updated"},{"label":"Deleted","value":"deleted"},{"label":"Blocked","value":"blocked"},{"label":"Unblocked","value":"unblocked"},{"label":"Connected","value":"connected"},{"label":"Disconnected","value":"disconnected"}],"value":{"label":"all","value":"+"}}]},"telemetry":{"topic":{"topicPattern":"flespi/state/gw/devices/${devices}/telemetry/${parameters}","payloadType":"string"},"selectors":[{"name":"parameters","getter":{"name":"getDevicesTelemetry","params":["devices"]},"value":{"label":"all","value":"+"}}]},"settings":{"topic":{"topicPattern":"flespi/state/gw/devices/${devices}/settings/${name}","payloadType":"JSON"},"selectors":[{"name":"name","getter":{"name":"getDevicesSettings","params":["devices"]},"value":{"label":"all","value":"+"}}]}}},"analytics":{"selectors":[{"name":"calcs","getter":{"name":"getCalcs","params":["devices"]},"value":{"label":"all","value":"+"}},{"name":"devices","getter":{"name":"getDevices","params":["calcs"]},"value":{"label":"all","value":"+"}}],"children":{"state":{"topic":{"topicPattern":"flespi/state/gw/calcs/${calcs}/devices/${devices}/${statuses}","payloadType":"JSON"},"selectors":[{"name":"statuses","list":[{"label":"Synchronization state","value":"synced"},{"label":"Last detected interval","value":"last"},{"label":"Currently active interval","value":"active"}],"value":{"label":"all","value":"+"}}]},"intervals":{"topic":{"topicPattern":"flespi/interval/gw/calcs/${calcs}/devices/${devices}/${events}","payloadType":"JSON"},"selectors":[{"name":"events","list":[{"label":"Created","value":"created"},{"label":"Updated","value":"updated"},{"label":"Deleted","value":"deleted"}],"value":{"label":"all","value":"+"}}]}}}}')},dec3:function(e,t,s){"use strict";s("acb2")},df50:function(e,t,s){},e567:function(e,t,s){"use strict";var i=function(){var e,t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"absolute-full"},[i("q-layout",{attrs:{view:"hhh LpR lff",container:""}},[i("q-header",{attrs:{reveal:""}},[i("q-toolbar",{class:(e={},e["bg-"+t.color]=!0,e["text-white"]=!!t.color,e),staticStyle:{position:"absolute","z-index":"1"}},[t.activeClient&&t.clientsCloseable?i("q-btn",{attrs:{round:"",flat:"",dense:"",icon:"mdi-close"},on:{click:t.clearActiveClient}}):t._e(),i("q-toolbar-title",[t.activeClient||""!==t.whiteLabel?t._e():i("img",{staticStyle:{height:"30px"},attrs:{src:"mqttboard.png",alt:"MQTT Board"}}),t.activeClient?i("span",[t._v("\n             "+t._s(""+(t.activeClient.config.clientName||t.activeClient.config.clientId))+"\n             "),t.activeClient.config.clientName?i("q-tooltip",[t._v(t._s(""+t.activeClient.config.clientId))]):t._e()],1):i("span",[t._v("\n             "+t._s(t.whiteLabel||"MQTT Board")+"\n           ")]),t.activeClient&&t.$q.platform.is.desktop?i("sup",{staticClass:"absolute",class:["bg-"+(t.activeClient.status?"green":"red")],staticStyle:{"border-radius":"5px","font-size":".6rem",padding:"2px","min-width":"15px",top:"5px"}},[t._v(t._s(t.activeClient.status?"online":"offline"))]):t._e(),t.activeClient&&t.$q.platform.is.desktop&&t.activeClient.cid?i("sub",{staticStyle:{"border-radius":"5px","font-size":".7rem",padding:"2px"},attrs:{title:"cid"}},[t._v(t._s(t.activeClient.cid))]):t._e(),t.activeClient||""!==t.whiteLabel?t._e():i("sup",{staticStyle:{position:"relative","font-size":".9rem","padding-left":"4px"}},[t._v(t._s(t.version))])]),t.activeClient?i("q-btn",{attrs:{round:"",flat:"",dark:"",icon:"mdi-cog"},on:{click:function(e){return e.stopPropagation(),t.editClientHandler(t.activeClient.id)}}}):t._e(),t.activeClient?i("q-btn",{attrs:{round:"",flat:"",icon:"mdi-plus"}},[i("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[i("q-list",[i("q-item-label",{attrs:{header:""}},[t._v("Add pane")]),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.addPublisher()}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"mdi-publish"}})],1),i("q-item-section",[i("q-item-label",[t._v("Publisher")])],1)],1),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.addSubscriber()}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"mdi-arrow-down-bold"}})],1),i("q-item-section",[i("q-item-label",[t._v("Subscriber")])],1)],1)],1)],1)],1):t._e(),t.activeClient?i("q-btn",{attrs:{round:"",flat:"",dark:"",icon:"mdi-menu"},on:{click:function(e){e.stopPropagation(),t.drawerRight=!t.drawerRight}}}):t._e(),t.activeClient||t.whiteLabel?t._e():i("q-btn",{staticStyle:{"margin-right":"60px"},attrs:{dense:"",flat:"",color:"white",icon:"mdi-github",label:t.$q.platform.is.mobile?"":"Fork me!"},on:{click:function(e){return t.openURL("https://github.com/flespi-software/MQTT-Board")}}})],1),t.activeClient?t._e():i("q-btn",{staticStyle:{position:"absolute",right:"16px",top:"21px","z-index":"2"},attrs:{fab:"",icon:"mdi-plus",color:t.accentColor},nativeOn:{click:function(e){return t.addClientHandler.apply(null,arguments)}}})],1),t.activeClient?i("q-drawer",{attrs:{side:"right",bordered:"",breakpoint:500,"content-class":"bg-grey-3 absolute"},model:{value:t.drawerRight,callback:function(e){t.drawerRight=e},expression:"drawerRight"}},[i("entities-menu",{staticClass:"full-width relative-position",staticStyle:{height:"calc(100% - 98px)",top:"50px"},attrs:{entities:t.menuEnitites,active:[t.firstViewedPanelIndex,t.firstViewedPanelIndex+t.colsCount-1]},on:{pick:t.pickEntity,"subscriber:play":function(e){return t.subscribeMessageHandler(t.activeClient.id,e)},"subscriber:stop":function(e){return t.unsubscribeMessageHandler(t.activeClient.id,e)},publish:t.publishFreeMessage}}),t.needCloseAll?[i("q-btn",{staticClass:"absolute-bottom",staticStyle:{bottom:"7px",left:"4px",width:"calc(50% - 8px)"},attrs:{color:"grey-7",unelevated:"",label:"Close"},on:{click:function(e){t.needCloseAll=!1}}}),i("q-btn",{staticClass:"absolute-bottom",staticStyle:{bottom:"7px",left:"calc(50% + 4px)",width:"calc(50% - 8px)"},attrs:{color:"red",unelevated:"",label:"remove"},on:{click:function(){t.closeAllHandler(),t.needCloseAll=!1}}})]:i("q-btn",{staticClass:"absolute-bottom",staticStyle:{bottom:"7px",left:"4px",width:"calc(100% - 8px)"},attrs:{color:"red",disable:!t.subscribers.length&&!t.publishers.length,unelevated:"",label:"remove all"},on:{click:function(e){t.needCloseAll=!0}}})],2):t._e(),i("q-page-container",[i("q-page",[i("div",[t.republishMessage?i("publisher-modal",{ref:"publisherModal",attrs:{message:t.republishMessage,version:t.activeClient.config.protocolVersion},on:{publish:t.publishFreeMessage,hide:function(e){t.republishMessage=null}}}):t._e(),t.settingsModalModel?i("client-settings-modal",{attrs:{color:t.color,secure:t.secure,settings:null!==t.editedClientId?t.clients[t.editedClientId].config:{},initSettings:t.initSettings},on:{save:t.saveSettingsHandler,close:t.closeSettingsHandler}}):t._e(),t.activeClient?t.renderedEntities.length?i("div",[i("div",{directives:[{name:"touch-swipe",rawName:"v-touch-swipe.horizontal",value:t.swipeHandler,expression:"swipeHandler",modifiers:{horizontal:!0}}],ref:"wrapper",staticClass:"no-wrap row client__wrapper",on:{scroll:t.wrapperScroll}},[i("q-resize-observer",{attrs:{debounce:0},on:{resize:t.onWrapperResize}}),t._l(t.renderedEntities,(function(e,s){return["publisher"===e.type?i("publisher",{key:"publ"+e.id,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{value:t.publishers[e.index],version:t.activeClient.config.protocolVersion},on:{input:function(s){t.inputPublisher(e.index,s)},remove:function(s){return t.removePublisher(e.index)},publish:function(s){return t.publishMessageHandler(t.activeClient.id,e.index)},hide:function(s){return t.$set(e,"rendered",!1)}}}):"subscriber"===e.type?i("subscriber",{key:"subs"+e.id,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{value:t.subscribers[e.index],status:t.subscribersStatuses[e.index],subscribed:t.subscribersConnectivityStatuses[e.index],messages:t.subscribersMessages[e.index],client:t.activeClient},on:{input:function(s){t.inputSubscriber(e.index,s)},remove:function(s){return t.removeSubscriber(e.index)},subscribe:function(s){return t.subscribeMessageHandler(t.activeClient.id,e.index)},unsubscribe:function(s){return t.unsubscribeMessageHandler(t.activeClient.id,e.index)},play:function(s){return t.playSubscriberHandler(e.index)},pause:function(s){return t.pauseSubscriberHandler(e.index)},clear:function(s){return t.clearMessagesHandler(e.index)},"action-send":t.sendFromSubscriberHandler,hide:function(s){return t.$set(e,"rendered",!1)}}}):"unresolved"===e.type?i("unresolved",{key:"unresolved"+s,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{messages:t.notResolvedMessages},on:{clear:t.clearUnresolvedMessages,hide:function(s){return t.$set(e,"rendered",!1)}}}):"logs"===e.type?i("logs",{key:"subs"+s,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{logs:t.activeClient.logs},on:{clear:t.clearLogs,hide:function(s){return t.$set(e,"rendered",!1)}}}):t._e()]}))],2),i("slider-controller",{attrs:{entities:t.renderedEntities,"buttons-disable":{prev:0===t.firstViewedPanelIndex,next:t.entities.length-t.colsCount===t.firstViewedPanelIndex},active:[t.firstViewedPanelIndex,t.firstViewedPanelIndex+t.colsCount-1]},on:{swipe:function(e){return t.swipeHandler({direction:e})},"swipe-to":t.scrollToEntity}})],1):t.renderedEntities.length?t.statuses[t.activeClient.id]?t._e():i("div",{staticClass:"text-center q-mt-lg text-grey-9 text-weight-bold absolute",staticStyle:{"font-size":"2.5rem",top:"50px",bottom:"0",left:"0",right:"0"}},[i("div",[t._v("Ð¡lient is disconnected")])]):i("div",{staticClass:"text-center q-mt-lg text-grey-9 text-weight-bold absolute",staticStyle:{"font-size":"2.5rem",top:"50px",bottom:"0",left:"0",right:"0"}},[t._v("No active entities")]):i("div",{staticClass:"absolute scroll",staticStyle:{top:"50px",left:"0",right:"0",bottom:"0"}},[Object.keys(t.clients).length?i("div",{staticClass:"mqtt-clients row q-pt-md"},t._l(t.clients,(function(e,s){return i("div",{key:s,staticClass:"client__item q-pt-md q-px-md cursor-pointer col-xl-3 col-md-4 col-sm-6 col-xs-12"},[i("q-card",{class:{"bg-red-2":!t.statuses[s],"bg-green-2":t.statuses[s]},nativeOn:{click:function(e){return t.setActiveClient(s)}}},[i("q-card-section",{staticClass:"q-py-sm"},[i("div",{staticClass:"ellipsis q-mb-xs",staticStyle:{"font-size":"18px","line-height":"18px","min-height":"18px"}},[t._v(t._s(e.config.clientName||e.config.clientId))]),i("div",{staticClass:"ellipsis text-grey-9",staticStyle:{"font-size":"14px","line-height":"14px","min-height":"14px"}},[t._v(t._s(e.config.clientName?e.config.clientId:""))]),i("div",{staticClass:"text-grey-9 q-mt-sm"},[t._v(t._s(e.config.host))])]),i("q-separator"),i("q-card-actions",{attrs:{align:"right"}},[e.client?i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-stop",loading:!!e.client&&!t.statuses[s]&&e.inited},on:{click:function(e){return e.stopPropagation(),t.disconnectClientHandler(s)}}},[i("div",{attrs:{slot:"loading"},on:{click:function(e){e.stopPropagation()}},slot:"loading"},[i("q-spinner")],1),i("q-tooltip",[t._v("Deactivate client")])],1):i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-play"},on:{click:function(e){return e.stopPropagation(),t.connectClientHandler(s)}}},[i("q-tooltip",[t._v("Activate client")])],1),i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-cog"},on:{click:function(e){return e.stopPropagation(),t.editClientHandler(s)}}}),i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-delete"},on:{click:function(e){return e.stopPropagation(),t.deleteClientHandler(s)}}})],1)],1)],1)})),0):i("div",{staticClass:"text-center q-mt-lg text-grey-9 text-weight-bold",staticStyle:{"font-size":"2.5rem"}},[i("div",[t._v("No clients")]),t.activeClient?t._e():i("q-btn",{nativeOn:{click:function(e){return t.addClientHandler.apply(null,arguments)}}},[t._v("Create client")])],1)])],1)])],1)],1)],1)},r=[],o=(s("ddb0"),s("caad"),s("5319"),s("d9e2"),s("e7fc")),n=s.n(o);class a{constructor(e){this._client=e}set handleMessage(e){this._client.handleMessage=e}get handleMessage(){return this._client.handleMessage}get connected(){return this._client.connected}get reconnecting(){return this._client.reconnecting}publish(...e){return new Promise(((t,s)=>{this._client.publish(...e,((e,i)=>{e?s(e):t(i)}))}))}subscribe(...e){return new Promise(((t,s)=>{this._client.subscribe(...e,((e,i)=>{e?s(e):t(i)}))}))}unsubscribe(...e){return new Promise(((t,s)=>{this._client.unsubscribe(...e,((e,i)=>{e?s(e):t(i)}))}))}end(...e){return new Promise(((t,s)=>{this._client.end(...e,((e,i)=>{e?s(e):t(i)}))}))}reconnect(...e){return this._client.reconnect(...e)}addListener(...e){return this._client.addListener(...e)}emit(...e){return this._client.emit(...e)}eventNames(...e){return this._client.eventNames(...e)}getLastMessageId(...e){return this._client.getLastMessageId(...e)}getMaxListeners(...e){return this._client.getMaxListeners(...e)}listenerCount(...e){return this._client.listenerCount(...e)}listeners(...e){return this._client.listeners(...e)}off(...e){return this._client.off(...e)}on(...e){return this._client.on(...e)}once(...e){return this._client.once(...e)}prependListener(...e){return this._client.prependListener(...e)}prependOnceListener(...e){return this._client.prependOnceListener(...e)}rawListeners(...e){return this._client.rawListeners(...e)}removeAllListeners(...e){return this._client.removeAllListeners(...e)}removeListener(...e){return this._client.removeListener(...e)}removeOutgoingMessage(...e){return this._client.removeOutgoingMessage(...e)}setMaxListeners(...e){return this._client.setMaxListeners(...e)}}var l={connect(e,t){const s=n.a.connect(e,t),i=new a(s);return i},connectAsync(e,t,s=!0){const i=n.a.connect(e,t),r=new a(i);return new Promise(((e,t)=>{const o={connect:t=>{n(),e(r)},end:()=>{n(),e(r)},error:e=>{n(),i.end(),t(e)}};!1===s&&(o.close=()=>{o.error("Couldn't connect to server")});const n=()=>{Object.keys(o).forEach((e=>{i.removeListener(e,o[e])}))};Object.keys(o).forEach((e=>{i.on(e,o[e])}))}))},AsyncClient:a},c=s("42454"),p=s.n(c),d=s("0644"),u=s.n(d),m=s("9b02"),h=s.n(m),b=s("b047c"),g=s.n(b),v=s("18d6"),f=s("b06b"),y=s("1732");const q=e=>e,x={};function _({name:e,duration:t=300,to:s,from:i,apply:r,done:o,cancel:n,easing:a}){let l=e;const c=new Date;l?S(l):l=Object(y["a"])();const p=a||q,d=()=>{let e=(new Date-c)/t;e>1&&(e=1);const n=i+(s-i)*p(e);if(r(n,e),1===e)return delete x[l],void(o&&o(n));u.last={pos:n,progress:e},u.timer=requestAnimationFrame(d)},u=x[l]={cancel:n,timer:requestAnimationFrame(d)};return l}function S(e){if(!e)return;const t=x[e];t&&t.timer&&(cancelAnimationFrame(t.timer),t.cancel&&t.cancel(t.last),delete x[e])}var C={start:_,stop:S},w=s("9224"),P=s("b697"),k=s.n(P),$=s("0f5c"),M=s.n($);const I={"2.5.1":e=>{h()(e.config,"properties.userProperties",void 0)||M()(e.config,"properties.userProperties",void 0),h()(e.config,"will.properties.userProperties",void 0)||M()(e.config,"properties.userProperties",void 0),e.publishers.forEach((e=>{h()(e,"options.properties.userProperties",void 0)||M()(e,"options.properties.userProperties",void 0)})),e.subscribers.forEach((e=>{h()(e,"options.properties.userProperties",void 0)||M()(e,"options.properties.userProperties",void 0),h()(e,"unsubscribeProperties",void 0)||M()(e,"unsubscribePropertie",void 0)}))}};var T={methods:{migrateClient(e){const t=Object.keys(I),s=e.appVersion||"2.5.0",i=w["a"];return t.forEach((t=>{if(k.a.compare(t,s,">")&&k.a.compare(t,i,"<="))try{I[t](e)}catch(r){console.log(r)}})),e}}},U=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__subscriber"},[e.status||null!==e.isPlayed?s("q-card",{staticClass:"subscriber__item q-ma-sm"},[e.filterMode?s("q-input",{staticClass:"q-ma-sm q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Filter by topic",autofocus:""},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-btn",{attrs:{slot:"prepend",color:"grey-9",icon:"mdi-arrow-left",flat:"",round:""},on:{click:function(t){e.filterMode=!1,e.filter=""}},slot:"prepend"}),e.filter?s("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-close",flat:"",round:""},on:{click:function(t){e.filter=""}},slot:"append"}):e._e()],1):s("q-toolbar",{staticClass:"q-pr-none text-white bg-orange",staticStyle:{"border-top-right-radius":"0","border-top-left-radius":"0"}},[s("q-toolbar-title",{staticStyle:{width:"calc(100% - 150px)"}},[s("span",[e._v("\n          "+e._s(e.config.topic)+"\n          "),s("q-tooltip",[e._v(e._s(e.config.topic))])],1)]),0===e.config.mode?s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-magnify"},on:{click:function(t){e.filterMode=!0}}}):e._e(),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-stop",title:"Unsubscribe"},on:{click:function(t){return e.unsubscribeMessageHandler()}}}),s("q-btn",{attrs:{round:"",flat:"",icon:e.isPlayed&&"paused"!==e.status?"mdi-pause":"mdi-play",title:e.isPlayed&&"paused"!==e.status?"Pause":"Resume"},on:{click:e.playStopHandler}},["paused"===e.status&&e.value.missedMessages?s("q-chip",{staticClass:"absolute-top-right",staticStyle:{top:"-5px",right:"-5px"},attrs:{color:"red",dense:"","text-color":"white",size:".6rem",square:""}},[e._v("\n          "+e._s(e.value.missedMessages)+"\n        ")]):e._e()],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[0===e.config.mode?s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},nativeOn:{click:function(t){return e.clearMessagesHandler.apply(null,arguments)}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-playlist-remove"}})],1),s("q-item-section",[s("q-item-label",[e._v("Clear messages")])],1)],1):e._e(),0===e.config.mode?s("q-separator",{attrs:{spaced:""}}):e._e(),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{highlight:"",clickable:""},nativeOn:{click:function(t){return e.removeSubscriber()}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"mdi-delete-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Remove")])],1)],1)],1)],1)],1)],1),s("div",{staticStyle:{position:"relative"},style:{height:"calc(100% - "+(e.filterMode?"62px":"50px")+")"}},[e.messages&&e.messages.length&&0===e.config.mode?s("virtual-list",{directives:[{name:"autoscroll",rawName:"v-autoscroll",value:e.needAutoScroll,expression:"needAutoScroll"}],ref:"scroller",staticClass:"subscriber__list",attrs:{onscroll:e.listScroll,size:110,remain:15,item:e.Message,itemcount:e.renderedMessages.length,itemprops:e.getMessageProps}}):1===e.config.mode&&Object.keys(e.renderedMessages).length&&e.subscribed?s("div",{staticClass:"subscriber__list subscriber__list--tree"},[s("div",{staticClass:"scroll",style:{height:e.treeModeValue?"60%":"100%"}},[s("tree",{attrs:{topic:e.treeSelectedTopic,data:e.renderedMessages,expandByValue:!0},on:{change:e.treeValueChangeHandler}})],1),e.treeModeValue?s("div",{staticClass:"scroll tree__message"},[e._l(e.treeModeValue,(function(t,i,r){return[s("message",{key:"tree-message-"+i+"-"+r,attrs:{message:t,highlight:e.config.highlight},on:{"action-send":function(t){e.$emit("action-send",t)}}})]}))],2):e._e()]):e.status&&e.subscribed&&!e.processingFlag?s("div",{staticClass:"subscriber__list--empty"},[e._v("No messages")]):e._e(),s("q-inner-loading",{attrs:{showing:e.isNeedLoading}},[s("q-spinner-gears",{attrs:{size:"150px",color:"orange"}})],1)],1)],1):s("q-card",{staticClass:"subscriber__item q-ma-sm"},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none text-white bg-orange"},[s("q-toolbar-title",[e._v("Subscriber")]),s("q-btn",{attrs:{round:"",flat:"",disable:!e.isValidSubscriber,icon:"mdi-play"},on:{click:e.subscribeMessageHandler}},[s("q-tooltip",[e._v("Subscribe")])],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide panel")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.removeSubscriber()}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"mdi-delete-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Remove")])],1)],1)],1)],1)],1)],1)],1),s("q-card-section",{staticClass:"item__main q-py-none"},[s("div",{staticClass:"q-pt-md"},[s("q-input",{staticClass:"q-mb-xs",attrs:{disable:e.status,autogrow:"",type:"aria",color:"grey-9",outlined:"","hide-bottom-space":"",label:"Topic",error:e.validateSetting("topic"),"error-message":e.getValidateMessage("topic"),"reactive-rules":"","no-error-icon":""},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("topic")))])],1),0===e.config.topic.indexOf("$share")?s("q-btn",{attrs:{slot:"append",color:"yellow-9",icon:"mdi-alert",flat:"",round:""},on:{click:e.showSharedSubscriptionNotification},slot:"append"}):e._e(),e.isFlespiMode?s("q-btn",{attrs:{slot:"append",color:"red-9",icon:"icon-flespi2-02-01",flat:"",round:""},on:{click:function(t){e.flespiTopicOpened=!0}},slot:"append"},[s("q-tooltip",[e._v("flespi topic generator")])],1):e._e()],1),s("q-btn-toggle",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mt-md",staticStyle:{width:"100%"},attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:e.modeSelectOptions},on:{input:e.changeModeHandler},model:{value:e.config.mode,callback:function(t){e.$set(e.config,"mode",t)},expression:"config.mode"}}),1===e.config.mode&&5===e.version?s("q-input",{staticClass:"q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Field to group by",hint:"User properties field name by which messages will be grouped."},model:{value:e.config.treeField,callback:function(t){e.$set(e.config,"treeField",t)},expression:"config.treeField"}}):e._e(),s("q-toggle",{staticClass:"q-my-md",attrs:{color:"grey-9",label:"Highlight messages content"},model:{value:e.config.highlight,callback:function(t){e.$set(e.config,"highlight",t)},expression:"config.highlight"}}),s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{value:!0,label:"Options"}},[s("div",[s("div",{staticClass:"q-mx-md",staticStyle:{"line-height":"34px"}},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("\n                QoS\n                "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{disable:e.status,flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.qos,callback:function(t){e.$set(e.config.options,"qos",t)},expression:"config.options.qos"}})],1),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.qos")))])],1)],1),5===e.version?s("div",{staticClass:"q-mr-md q-ml-sm"},[s("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{disable:e.status,color:"grey-9",label:"No local"},model:{value:e.config.options.nl,callback:function(t){e.$set(e.config.options,"nl",t)},expression:"config.options.nl"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.nl")))])],1)],1):e._e(),5===e.version?s("div",{staticClass:"q-mr-md q-ml-sm"},[s("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{disable:e.status,color:"grey-9",label:"Retain as Published"},model:{value:e.config.options.rap,callback:function(t){e.$set(e.config.options,"rap",t)},expression:"config.options.rap"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.rap")))])],1)],1):e._e(),5===e.version?s("div",{staticClass:"q-mx-md",staticStyle:{"line-height":"34px"}},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("\n                Retain handling\n                "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{disable:e.status,flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.rh,callback:function(t){e.$set(e.config.options,"rh",t)},expression:"config.options.rh"}})],1),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.rh")))])],1)],1):e._e(),5===e.version?s("q-expansion-item",{staticClass:"q-mt-sm bg-grey-4",attrs:{label:"Properties"}},[s("div",{staticClass:"q-px-md q-py-sm"},[s("q-input",{staticClass:"q-my-xs",attrs:{disable:e.status,color:"grey-9",label:"Subscription identifier",type:"number",outlined:"","hide-bottom-space":"",error:e.validateSetting("options.properties.subscriptionIdentifier"),"error-message":e.getValidateMessage("options.properties.subscriptionIdentifier"),"no-error-icon":""},on:{input:function(t){t||(e.config.options.properties.subscriptionIdentifier=void 0)}},model:{value:e.config.options.properties.subscriptionIdentifier,callback:function(t){e.$set(e.config.options.properties,"subscriptionIdentifier",e._n(t))},expression:"config.options.properties.subscriptionIdentifier"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.subscriptionIdentifier")))])],1)],1),!e.status||e.config.options.properties.userProperties?s("div",[s("div",{staticClass:"q-mt-md q-mb-sm"},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("User Properties")]),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.userProperties")))])],1)],1),s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Also use to unsubscribe"},model:{value:e.needUseSubUserPropsToUnsub,callback:function(t){e.needUseSubUserPropsToUnsub=t},expression:"needUseSubUserPropsToUnsub"}}),s("div",[e.config.options.properties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.options.properties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[e.status?e._e():s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removeSubscriberUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{outlined:"","hide-bottom-space":"",color:"grey-9",label:"User property name"},model:{value:e.subscriberUserProperty.name,callback:function(t){e.$set(e.subscriberUserProperty,"name",t)},expression:"subscriberUserProperty.name"}}),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{outlined:"","hide-bottom-space":"",color:"grey-9",label:"User property value"},model:{value:e.subscriberUserProperty.value,callback:function(t){e.$set(e.subscriberUserProperty,"value",t)},expression:"subscriberUserProperty.value"}}),e.status?e._e():s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.subscriberUserProperty.name||!e.subscriberUserProperty.value,color:"grey-9"},on:{click:e.addSubscriberUserProperty}},[e._v("Add")])],1)],1):e._e()],1)]):e._e(),s("q-separator",{attrs:{dark:"",color:"grey-5"}}),5!==e.version||e.needUseSubUserPropsToUnsub?e._e():s("q-expansion-item",{staticClass:"q-mb-sm bg-grey-4",attrs:{value:!!e.config.unsubscribeProperties.userProperties,label:"Unsubscribe properties"}},[!e.status||e.config.unsubscribeProperties.userProperties?s("div",{staticClass:"q-px-md q-py-sm"},[s("div",{staticClass:"q-mt-md q-mb-sm"},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("User Properties")]),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("unsubscribeProperties.userProperties")))])],1)],1),s("div",[e.config.unsubscribeProperties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.unsubscribeProperties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[e.status?e._e():s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removeUnsubscribeUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property name"},model:{value:e.unsubscribeUserProperty.name,callback:function(t){e.$set(e.unsubscribeUserProperty,"name",t)},expression:"unsubscribeUserProperty.name"}}),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property value"},model:{value:e.unsubscribeUserProperty.value,callback:function(t){e.$set(e.unsubscribeUserProperty,"value",t)},expression:"unsubscribeUserProperty.value"}}),e.status?e._e():s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.unsubscribeUserProperty.name||!e.unsubscribeUserProperty.value,color:"grey-9"},on:{click:e.addUnsubscribeUserProperty}},[e._v("Add")])],1)]):e._e()])],1)])],1)])],1),e.flespiTopicOpened?s("flespi-topic-configurator",{ref:"ftopic",attrs:{opened:e.flespiTopicOpened,color:"orange",bus:e.client.restBus},on:{close:function(t){e.flespiTopicOpened=!1}},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}}):e._e()],1)},O=[],Q=function(){var e,t,s=this,i=s.$createElement,r=s._self._c||i;return r("q-dialog",{attrs:{value:s.opened,"content-class":"mqtt-board__popup",maximized:s.$q.platform.is.mobile}},[r("q-card",{style:{minWidth:s.$q.platform.is.mobile?"100%":"30vw"}},[r("q-card-section",{staticClass:"q-pa-none"},[r("q-toolbar",{class:(e={},e["bg-"+s.color]=!0,e["text-white"]=!!s.color,e)},[r("q-toolbar-title",[s._v("\n          Flespi topic generator\n        ")])],1)],1),r("q-separator"),r("q-card-section",{staticClass:"scroll",style:{height:s.$q.platform.is.mobile?"calc(100% - 96px)":""}},[r("flespi-selector",{attrs:{value:this.currentTopic,connector:s.bus,theme:{color:"orange"}},on:{input:s.update}})],1),r("q-separator"),r("q-card-actions",{class:(t={},t["bg-"+s.color]=!0,t["text-white"]=!!s.color,t),attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:""},on:{click:function(e){return s.$emit("close")}}},[s._v("Close")]),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:""},on:{click:s.saveSettingsHandler}},[s._v("Save")])],1)],1)],1)},D=[],E=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.$q.platform.is.desktop?s("q-btn-toggle",{staticClass:"q-mb-md",attrs:{options:e.options,spread:"",unelevated:"","toggle-color":e.cTheme.color},model:{value:e.entity,callback:function(t){e.entity=t},expression:"entity"}}):s("q-select",{staticClass:"q-mb-md",attrs:{options:e.options,"emit-value":"","map-options":"",outlined:"",dense:"",color:e.cTheme.color},model:{value:e.entity,callback:function(t){e.entity=t},expression:"entity"}}),s("div",{staticClass:"relative-position"},[e.entity?e._e():s("div",{staticClass:"selectors__settings-splash"}),e.renderConfig.selectors?e._l(e.renderConfig.selectors,(function(t){return s("div",{key:e.entity+"-"+t.name},[s("q-select",{staticClass:"q-mb-md",attrs:{value:e.model[t.name],options:e.renderLists[t.name],"emit-value":"","map-options":"",multiple:"",clearable:"","use-input":"","use-chips":"",outlined:"",dense:"",color:e.cTheme.color,label:e.model[t.name]?t.name:"All "+t.name},on:{input:function(s){return e.update(t.name,s)},filter:function(s,i){return e.filterItems(t,s,i)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",[s("div",{staticClass:"text-italic text-grey-9 text-h6 text-center text-bold"},[e._v(e._s("No "+t.name))]),s("div",{staticClass:"text-grey text-center"},[e._v("Maybe you need to clean another related selectors")])])],1)]},proxy:!0},{key:"option",fn:function(t){return[s("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[s("q-item-section",[s("q-item-label",{domProps:{innerHTML:e._s(t.opt.label||"*Empty*")}}),s("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.opt.value))])],1)],1)]}}],null,!0)})],1)})):e._e(),e.renderConfig.children?[s("flespi-selectors",{key:e.entity,attrs:{value:e.value,config:e.renderConfig.children,connector:e.connector,entities:e.model,theme:e.cTheme},on:{input:e.updateModel}})]:e._e()],2)],1)},A=[],N=s("db97"),j={name:"FlespiSelectors",props:{config:{type:Object,default(){return N}},connector:Object,entities:{type:Object,default(){return{}}},value:String,theme:Object,default(){return{color:"grey-9",bgColor:"white"}}},data(){const e=void 0,t={},s={},i="";return{entity:e,lists:s,renderLists:{...s},model:t,topic:i,cTheme:{color:"grey-9",bgColor:"white",...this.theme}}},computed:{options(){return Object.keys(this.config).map((e=>({label:e,value:e})))},entitiesNames(){return Object.keys(this.config)},renderConfig(){return this.entity?this.config[this.entity]:this.config[this.entitiesNames[0]]}},methods:{initByEntity(e){const t=this.config[e].selectors,s={},i={};return t&&t.forEach((e=>{e.value&&(i[e.name]=null),e.list?(s[e.name]=e.list,s[e.name].inited=!0):(s[e.name]=[],s[e.name].inited=!1)})),{lists:s,model:i}},filterItems(e,t,s){if(this.lists[e.name].inited)return this.$set(this.renderLists,e.name,t?this.lists[e.name].filter((e=>e.label.toLowerCase().indexOf(t.toLowerCase())>-1)):this.lists[e.name]),void s();this.connector[e.getter.name](...e.getter.params.map((e=>this.model[e]||"all"))).then((i=>{this.$set(this.lists,e.name,i),this.$set(this.renderLists,e.name,t?this.lists[e.name].filter((e=>e.label.toLowerCase().indexOf(t.toLowerCase())>-1)):this.lists[e.name]),this.lists[e.name].inited=!0,s()}))},update(e,t){this.$set(this.model,e,t&&t.length?t:null),this.entity&&this.config[this.entity].selectors&&this.config[this.entity].selectors.forEach((t=>{t.getter&&t.getter.params&&t.getter.params.includes(e)&&(this.$set(this.lists,t.name,[]),this.$set(this.renderLists,t.name,[]))})),this.$emit("input",this.getCurrentTopic(this.topic,this.model))},updateModel(e){this.topic=e,this.$emit("input",this.getCurrentTopic(this.topic,this.model))},getCurrentTopic(e,t){let s=e&&e.topicPattern;if(e&&this.entity&&this.config[this.entity].selectors){const e=this.config[this.entity].selectors.map((e=>e.name));s=e.reduce(((e,s)=>{const i=s,r=t[i];return void 0!==r&&(e=r&&r.length?e.replace(`\${${i}}`,r):e.replace(`\${${i}}`,"+")),e}),s)}return{...e,topicPattern:s}},topicToModelHandler(e){function t(e){const s=[];for(const i in e){const r=e[i],o=[i],n=r.topic&&r.topic.topicPattern;if(r.children){const e=t(r.children);for(const t of e)s.push({path:[...o,...t.path],topic:t.topic})}else s.push({path:o,topic:n})}return s}const s=t(this.config),i=s.filter((({path:t,topic:s})=>(s=new RegExp(s.replace(/\$\{\w+\}/g,".*")),s.test(e)))),r=i.pop();let o;if(r){o={path:r.path,values:{}};const t=r.topic.split("/"),s=e.split("/");t.forEach(((e,t)=>{e.replace(/\$\{(\w+)\}/,((e,i)=>{const r=s[t];o.values[i]="+"===r?null:r.split(",")}))}))}return o},setModel(e){if(!e)return!1;const{lists:t,model:s}=this.initByEntity(e.path[0]);this.entity=e.path[0],this.lists=t,this.model=Object.assign(s,e.values),this.topic=this.config[e.path[0]].topic,this.topic&&this.$emit("input",this.getCurrentTopic(this.topic,this.model))},changeEntity(e){const{lists:t,model:s}=this.initByEntity(e);this.lists=t,this.model={...s,...this.entities},this.topic=this.config[e].topic,this.topic&&this.$emit("input",this.getCurrentTopic(this.topic,this.model))}},created(){this.setModel(this.topicToModelHandler(this.value));const e=this.getCurrentTopic(this.topic,this.model);this.$watch("entity",this.changeEntity),e&&this.$emit("input",e)},watch:{entities:{deep:!0,handler(e){if(this.model={...this.model,...e},this.entity){const{lists:e}=this.initByEntity(this.entity);this.lists=e}}}}},H=j,L=(s("049c"),s("2877")),z=s("6a67"),R=s("ddd8"),B=s("66e5"),V=s("4074"),F=s("0170"),W=s("eebe"),J=s.n(W),X=Object(L["a"])(H,E,A,!1,null,null,null),Y=X.exports;J()(X,"components",{QBtnToggle:z["a"],QSelect:R["a"],QItem:B["a"],QItemSection:V["a"],QItemLabel:F["a"]});var K={name:"FlespiTopicConfigurator",props:{color:{type:String,default:"grey-9"},value:String,bus:Object,opened:Boolean},data(){return{currentTopic:this.value}},methods:{saveSettingsHandler(){this.$emit("input",this.currentTopic),this.$emit("close")},update(e){const t=e.topicPattern;t&&(this.currentTopic=t)}},components:{FlespiSelector:Y}},G=K,Z=s("24e8"),ee=s("f09f"),te=s("a370"),se=s("65c6"),ie=s("6ac5"),re=s("eb85"),oe=s("4b7e"),ne=s("9c40"),ae=s("7f67"),le=Object(L["a"])(G,Q,D,!1,null,null,null),ce=le.exports;J()(le,"components",{QDialog:Z["a"],QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QToolbarTitle:ie["a"],QSeparator:re["a"],QCardActions:oe["a"],QBtn:ne["a"]}),J()(le,"directives",{ClosePopup:ae["a"]});var pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{"user-select":"none"},style:e.$q.platform.is.desktop?{display:"inline-block",minWidth:"100%"}:[]},[e._l(e.limitedKeys,(function(t,i){return[s("div",{key:""+t,staticClass:"cursor-pointer",class:{"bg-grey-2":e.topic&&e.topic===e.data[t].topic},style:{paddingLeft:10*e.nesting+(e.data[t].children?0:14)+"px",display:e.$q.platform.is.desktop?"inline-block":"",minWidth:e.$q.platform.is.desktop?"100%":"",overflow:e.$q.platform.is.desktop?"":"hidden",textOverflow:e.$q.platform.is.desktop?"":"ellipsis"},on:{click:function(s){return e.toggle(t,i)}}},[e.data[t].children?[e.showObj[t]?s("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:"grey-9",name:"mdi-menu-down"}}):s("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:"grey-9",name:"mdi-menu-right"}})]:e._e(),s("span",{class:{"text-grey-9":!0,"text-italic":!t,"text-grey-10":e.data[t].value,"text-bold":e.data[t].value},staticStyle:{"white-space":"nowrap"}},[e._v("\n        "+e._s(t||"*Empty*")+"\n        "),e.getRetainFlag(t)?s("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:"grey-9",name:"mdi-content-save-outline"}},[s("q-tooltip",[e._v("Retain message")])],1):e._e()],1)],2),e.showObj[t]&&e.data[t].children?s("tree-mode-view",{key:"nest-"+t,attrs:{nesting:e.nesting+1,expandByValue:e.expand,topic:e.topic,data:e.data[t].children},on:{change:function(t){e.$emit("change",t)}}}):e._e()]})),e.keys.length>e.limitedKeys.length?s("div",{staticClass:"more-button cursor-pointer text-bold",staticStyle:{display:"inline-block"},style:{marginLeft:10*e.nesting+14+"px"},on:{click:function(t){e.limit+=1e3}}},[e._v("\n    more "+e._s(e.keys.length-e.limit>=1e3?1e3:e.keys.length-e.limit)+"\n  ")]):e._e()],2)},de=[],ue={name:"TreeModeView",props:{data:Object,topic:String,nesting:{type:Number,default:0},expandByValue:{type:Boolean,default:!1}},data(){const e={},t=Object.keys(this.data),s=t.length;let i=this.expandByValue;for(let r=0,o=s;r<o;r++)i&&(this.data[t[r]].value||t.length>1)&&(i=!1),e[t[r]]=i;return{showObj:e,limit:1e4,expand:i}},computed:{keys(){return Object.keys(this.data).sort(((e,t)=>{if(e=e.toLowerCase(),t=t.toLowerCase(),e!==t){const s=Number(e),i=Number(t);return s+""===e&&i+""===t?s-i:e>t?1:-1}}))},limitedKeys(){return this.keys.slice(0,this.limit)}},methods:{toggle(e,t){this.$set(this.showObj,e,!this.showObj[e]),this.$emit("change",this.data[e].topic)},getRetainFlag(e){const t=this.data[e].value;return!!t&&Object.values(t).reduce(((e,t)=>e?(e=t.retain,e):e),!0)}}},me=ue,he=(s("fbcf"),s("0016")),be=s("05c0"),ge=Object(L["a"])(me,pe,de,!1,null,null,null),ve=ge.exports;J()(ge,"components",{QIcon:he["a"],QTooltip:be["a"]});var fe=s("89c1"),ye=s.n(fe),qe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-card",{staticClass:"message q-my-sm q-mx-sm"},[s("div",{staticClass:"message__title q-pt-sm q-pl-sm q-pr-sm"},[s("div",{staticClass:"message__topic ellipsis",attrs:{title:e.message.topic}},[e._v("\n      "+e._s(e.message.topic)+"\n    ")]),s("div",{staticClass:"message__sys text-grey-7"},[e._v("\n      "+e._s("qos: "+e.message.qos+", dup: "+(e.message.dup?"+":"-")+", retain: "+(e.message.retain?"+":"-")+e.timestamp)+"\n    ")]),s("q-btn",{staticClass:"absolute-top-right",staticStyle:{top:"10px",right:"8px",transform:"rotate(-45deg)"},attrs:{color:"indigo-4",size:"sm",flat:"",icon:"mdi-send",round:""},on:{click:function(t){return e.$emit("action-send",e.message)}}},[s("q-tooltip",{staticClass:"desktop-only"},[e._v("Resend message")])],1)],1),s("div",{staticClass:"message__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2 relative-position"},["string"!==typeof e.payload||e.payload.length?e.highlight?s("json-tree",{attrs:{data:e.payload}}):e.highlight?e._e():s("div",{staticClass:"message__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2"},[e._v(e._s(e.message.payload))]):s("div",[e._v("No message")]),e.canCopy?s("q-btn",{staticStyle:{position:"absolute",right:"0",bottom:"2px"},attrs:{icon:"content_copy",size:"0.7rem",flat:"",color:"orange"},on:{click:e.copyPayloadHandler}}):e._e()],1),s("div",{staticClass:"message__properties q-pa-sm text-grey-7"},[e._v(e._s(JSON.stringify(e.message.properties)))])])},xe=[],_e=s("bd4c"),Se=s("cdde"),Ce=function(){var e,t=this,s=t.$createElement,i=t._self._c||s;return t.data&&(Array.isArray(t.data)||"object"===typeof t.data)?i("div",[i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(t._s(Array.isArray(t.data)?"[":"{"))]),t._l(t.data,(function(e,s,r){var o;return i("div",{key:s+"-"+r,staticClass:"margin-left"},[e&&"object"===typeof e?i("div",[i("div",{staticClass:"cursor-pointer",on:{click:function(e){t.toggle(Array.isArray(t.data)?s:r)}}},[t.showObj[Array.isArray(t.data)?s:r]?i("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:void 0!==t.inverted?"white":"grey-9",name:"mdi-menu-down"}}):i("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:void 0!==t.inverted?"white":"grey-9",name:"mdi-menu-right"}}),i("span",{class:[t.theme.label]},[t._v(t._s(s))]),i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(" : "+t._s(Array.isArray(e)?"Array ["+e.length+"]":"Object"))])],1),t.showObj[Array.isArray(t.data)?s:r]?i("json-tree",{staticClass:"margin-left",attrs:{data:e,inverted:t.inverted}}):t._e()],1):i("div",[i("span",{class:[t.theme.label]},[t._v(t._s(s))]),i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(" : ")]),i("span",{class:(o={},o[t.theme.typeNumberOrBool]="number"===typeof e||"boolean"===typeof e,o[t.theme.typeString]="string"===typeof e,o[t.theme.typeEmpty]="undefined"===typeof e||null===e,o)},[t._v(t._s(JSON.stringify(e)))])])])})),i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(t._s(Array.isArray(t.data)?"]":"}"))])],2):i("div",[i("span",{class:(e={},e[t.theme.typeNumberOrBool]="number"===typeof t.data||"boolean"===typeof t.data,e[t.theme.typeString]="string"===typeof t.data,e[t.theme.typeEmpty]="undefined"===typeof t.data||null===t.data,e),staticStyle:{"font-size":"1rem"}},[t._v(t._s(""+t.data))])])},we=[],Pe={name:"JsonTree",props:{data:{requered:!0},inverted:()=>!0},data(){const e=[],t=this.data?Object.keys(this.data).length:0;for(let s=0,i=t;s<i;s++)e.push(!0);return{showObj:e}},computed:{theme(){return void 0!==this.inverted?{label:"text-pink-4",typeString:"text-red-3",typeNumberOrBool:"text-blue-3",typeEmpty:"text-grey-5"}:{label:"text-pink-8",typeString:"text-red-6",typeNumberOrBool:"text-blue-6",typeEmpty:"text-grey-6"}}},methods:{toggle(e){this.$set(this.showObj,e,!this.showObj[e])}}},ke=Pe,$e=(s("ab66"),Object(L["a"])(ke,Ce,we,!1,null,null,null)),Me=$e.exports;J()($e,"components",{QIcon:he["a"]});var Ie={name:"Message",props:["message","highlight"],computed:{canCopy(){return!("string"===typeof this.payload&&!this.payload.length)&&!!Se["a"]},payload(){return this.message.payload},timestamp(){return this.message.properties&&this.message.properties.userProperties&&this.message.properties.userProperties.timestamp?`, ${_e["a"].formatDate(1e3*this.message.properties.userProperties.timestamp,"DD/MM/YYYY HH:mm:ss")}`:""}},methods:{copyPayloadHandler(){Object(Se["a"])("string"===typeof this.payload?this.payload:JSON.stringify(this.payload)).then((e=>{this.$q.notify({color:"positive",icon:"content_copy",message:'<div class="text-center" style="font-size: 1.2rem;">Payload copied</div>',html:!0,timeout:1e3})}),(e=>{this.$q.notify({color:"negative",icon:"content_copy",message:'<div class="text-center" style="font-size: 1.2rem;">Coping error</div>',html:!0,timeout:1e3})}))}},components:{JsonTree:Me}},Te=Ie,Ue=(s("04a0"),Object(L["a"])(Te,qe,xe,!1,null,"299524db",null)),Oe=Ue.exports;J()(Ue,"components",{QCard:ee["a"],QBtn:ne["a"],QTooltip:be["a"]});const Qe={clientName:{desc:"Human readable client name",type:"String"},clientId:{desc:"The Client Identifier (ClientID) identifies the Client on the Server",type:"String",required:!0},host:{desc:"It`s a web app so you can use wss protocol only",type:"String",required:!0},keepalive:{desc:"Maximum time interval that is permitted to elapse between the point at which the Client finishes transmitting one MQTT Control Packet and the point it starts sending the next",type:"Number",min:0,max:65535,required:!0},protocolVersion:{desc:"Revision level of the protocol used by the Client",type:"Number",options:[3,4,5]},clean:{desc:"If true, instructs the connection to start a new session; if false, instructs to continue an existing session",type:"Boolean"},username:{desc:"Client username (valid flespi token)",type:"String"},password:{desc:"Client password (should be left blank for flespi)",type:"String"},properties:{sessionExpiryInterval:{desc:"Session Expiry Interval in seconds",type:"Number",min:0,max:4294967295},receiveMaximum:{desc:"Receive Maximum value in bytes",type:"Number",min:1,max:65535},maximumPacketSize:{desc:"Maximum Packet Size in bytes the Client is willing to accept",type:"Number",min:1,max:4294967295},topicAliasMaximum:{desc:"The highest value that the Client will accept as a Topic Alias sent by the Server",type:"Number",min:0,max:65535},requestResponseInformation:{desc:"Run a Request/Response interaction over MQTT",type:"Boolean"},requestProblemInformation:{desc:"The Client uses this value to indicate whether the Reason String or User Properties are sent in the case of failures",type:"Boolean"},userProperties:{desc:"Used to send connection-related properties from the Client to the Server",type:"Object"},authenticationMethod:{desc:"Name of the authentication method used for extended authentication",type:"String"},authenticationData:{desc:"Identifier of the authentication data",type:"String"}},will:{topic:{desc:"Topic for will message",type:"String"},payload:{desc:"Will message payload",type:"String"},qos:{desc:"Specify the QoS level to be used when publishing the Will Message",type:"Number",options:[0,1,2]},retain:{desc:"If the Will Message is to be retained when it is published",type:"Boolean"},properties:{willDelayInterval:{desc:"Will Delay Interval in seconds",type:"Number",max:4294967295,min:0},payloadFormatIndicator:{desc:"Identifier of the Payload Format Indicator where false - unspecified, true - String",type:"Boolean"},messageExpiryInterval:{desc:"Message Expiry Interval",type:"Number",max:4294967295,min:1},contentType:{desc:"Content of the Will Message",type:"String"},responseTopic:{desc:"String which is used as the Topic Name for a response message",type:"String"},correlationData:{desc:"Used by the sender of the Request Message to identify which request the Response Message is for when it is received",type:"String"},userProperties:{desc:"Used to send will-related properties",type:"Object"}}}},De={topic:{desc:"String topic to subscribe to",type:"String",required:!0},options:{qos:{desc:"Maximum QoS field. This gives the maximum QoS level at which the Server can send Application Messages to the Client",type:"Number",options:[0,1,2]},nl:{desc:"No Local option. If the value is true, Application Messages MUST NOT be forwarded to a connection with a ClientID equal to the ClientID of the publishing connection",type:"Boolean"},rap:{desc:"Retain As Published option. If true, Application Messages forwarded using this subscription keep the RETAIN flag they were published with. If false, Application Messages forwarded using this subscription have the RETAIN flag set to false",type:"Boolean"},rh:{desc:"Retain Handling option. This option specifies whether retained messages are sent when the subscription is established. \n\r0 = Send retained messages at the time of the subscribe, \n\r1 = Send retained messages at subscribe only if the subscription does not currently exist, \n\r2 = Do not send retained messages at the time of the subscribe",type:"Number",options:[0,1,2]},properties:{subscriptionIdentifier:{desc:"Identifier of the subscription",type:"Number",min:1,max:268435455},userProperties:{desc:"Used to send related properties",type:"Object"}}},unsubscribeProperties:{userProperties:{desc:"Used to send related properties on unsubscribe operation",type:"Object"}}},Ee={topic:{desc:"The Topic Name identifies the information channel to which Payload data is published",type:"String",required:!0},payload:{desc:"Payload contains the Application Message that is being published",type:"String"},options:{qos:{desc:"Level of assurance for delivery of an Application Message",type:"Number",options:[0,1,2]},retain:{desc:"If the RETAIN flag is set to 1 in a PUBLISH packet sent by a Client to a Server, the Server MUST replace any existing retained message for this topic and store the Application Message",type:"Boolean"},dup:{desc:"If the DUP flag is set to false, it indicates that this is the first occasion that the Client or Server has attempted to send this PUBLISH packet. If the DUP flag is set to true, it indicates that this might be re-delivery of an earlier attempt to send the packet",type:"Boolean"},properties:{payloadFormatIndicator:{type:"Boolean",desc:"Identifier of the Payload Format Indicator where false - unspecified, true - String"},messageExpiryInterval:{desc:"Lifetime of the Application Message in seconds",type:"Number",min:1,max:4294967295},topicAlias:{desc:"Integer value that is used to identify the Topic instead of using the Topic Name",type:"Number",min:0,max:65535},responseTopic:{type:"String",desc:"String used as the Topic Name for a response message"},correlationData:{type:"String",desc:"The Correlation Data is used by the sender of the Request Message to identify which request the Response Message is for when it is received"},userProperties:{type:"Object",desc:"Used to send related properties"},contentType:{type:"String",desc:"String describing the MIME content type of the Application Message"}}}},Ae={type:{type:"String"},index:{type:"Number"},id:{type:"String"}};var Ne={settings:Qe,subscriber:De,publisher:Ee,entity:Ae};function je(e){const t=e.split("/");for(let s=0;s<t.length;s++)if("+"!==t[s]){if("#"===t[s])return s===t.length-1;if(-1!==t[s].indexOf("+")||-1!==t[s].indexOf("#"))return!1}return!0}function He(e){let t="";const s=Object.prototype.toString.call(e);return t=s.replace(/\[object /gi,"").replace(/\]/gi,""),t}function Le(e,t,s){let i=!0;const r=h()(Ne,t,void 0);if(void 0!==r.min){const t=`Value must be more or equal ${r.min}`;i=r.min<=e||t}return i}function ze(e,t,s){let i=!0;const r=h()(Ne,t,void 0);if(void 0!==r.max){const t=`Value must be less or equal ${r.max}`;i=r.max>=e||t}return i}function Re(e,t,s){let i=!0;const r=h()(Ne,t,void 0);if(void 0!==r.options){const t=`Value must be ${r.options.join(" or ")}`;i=r.options.includes(e)||t}return i}function Be(e,t,s){let i=!0;const r=Le(e,t,s),o=ze(e,t,s),n=Re(e,t,s);return"string"===typeof n?i=n:"string"===typeof o?i=o:"string"===typeof r&&(i=r),i}const Ve={min:Le,max:ze,options:Re,typeDetails:Be,types(e,t,s){let i=!0;const r=this.getType(e),o=h()(Ne,t,void 0),n=r===o.type,a="String"===r&&!e.length,l=Be(e,t,s);return o.required?a?i="Value cannot be empty":n?"string"===typeof l&&(i=l):i="Value has invalid type":o.required||"Undefined"===r||(n?"string"===typeof l&&(i=l):i="Value has invalid type"),i},custom(e,t,s){let i=!0;if(Fe[t])for(const r of Fe[t]){const o=r.apply(this,[e,t,s]);if("string"===typeof o){i=o;break}}return i}},Fe={"settings.host":[function(e,t,s){return!(this.secure&&0===e.indexOf("ws:"))||"Host must be only over secured sockets"}],"publisher.topic":[function(e,t,s){return je(e)||"Topic is invalid"}],"subscriber.topic":[function(e,t,s){return je(e)||"Topic is invalid"},function(e,t,s){return(-1===e.indexOf(",")||-1!==e.indexOf(",")&&s.options.properties.subscriptionIdentifier)&&(0!==e.indexOf("$filter")||0===e.indexOf("$filter")&&s.options.properties.subscriptionIdentifier)||"You need to set up subscription identifier in the properties below"}]};var We={methods:{getType:He,validateField(e,t,s,i=!1){let r=!0;const o=["types","custom"];for(const n of o){const o=Ve[n],a=o.apply(this,[e,t,s]);if("string"===typeof a){r=!!i&&a;break}}return r},validateObjectBySchema(e,t,s=!1){const i=h()(Ne,t,{});let r=Object.keys(i).reduce(((r,o)=>{const n=e[o],a=!!i[o].type,l=`${t}.${o}`;let c=!0;return c=a?this.validateField(n,l,e,s):this.validateObjectBySchema(n,l,s),"boolean"===typeof c&&c||(r[o]=c),r}),{});const o=!!Object.keys(r).length;return s&&o||(r=!o),r},validateEntity(e){switch(e.type){case"publisher":return this.validatePublisher(e.settings);case"subscriber":return this.validateSubscriber(e.settings);default:return!1}},validateSettings(e,t=!1){return this.validateObjectBySchema(e,"settings",t)},validatePublisher(e,t=!1){return this.validateObjectBySchema(e,"publisher",t)},validateSubscriber(e,t=!1){return this.validateObjectBySchema(e,"subscriber",t)},validateEntityRecord(e,t=!1){return this.validateObjectBySchema(e,"entity",t)}}},Je=s("2768"),Xe=s.n(Je);const Ye=0,Ke=1;var Ge={name:"Subscriber",props:["value","messages","status","client","subscribed"],data(){return{declarations:De,version:this.client.config.protocolVersion,filterMode:!1,config:this.value,loadingStatus:!1,needUseSubUserPropsToUnsub:!1,subscriberUserProperty:{value:"",name:""},unsubscribeUserProperty:{value:"",name:""},modeSelectOptions:[{label:"List",value:Ye},{label:"Tree",value:Ke}],needAutoScroll:!0,isPlayed:this.status||null,filter:"",treeSelectedTopic:null,processingFlag:null,Message:Oe,flespiTopicOpened:!1}},computed:{isFlespiMode(){return this.client.config.host.indexOf("flespi")>-1},renderedMessages(){let e=[];switch(this.config.mode){case Ye:e=this.filter?this.messages.filter((e=>-1!==e.topic.indexOf(this.filter))):this.messages;break;case Ke:e=this.messages;break}return e},treeModeValue(){let e=null;if(this.config.mode===Ke){if(null===this.treeSelectedTopic)return null;const t=this.treeSelectedTopic.split("/");e=t.reduce(((e,s,i)=>(e&&e[s]?e=i===t.length-1?e[s].value&&Object.keys(e[s].value).reduce(((t,i)=>(t[i]=e[s].value[i],t)),{}):e[s].children:(this.treeValueChangeHandler(null),e=null),e)),this.messages),e&&Object.keys(e).length||(e=null)}return e},validationModel(){return this.validateSubscriber(this.config,!0)},isValidSubscriber(){return!Object.keys(this.validationModel).length},isNeedLoading(){return 1===this.config.mode&&this.status&&this.subscribed&&null===this.processingFlag&&this.checkProcessing(),1===this.config.mode&&this.status&&(!this.subscribed||!!this.processingFlag)}},methods:{isNil:Xe.a,checkProcessing(){Object.keys(this.messages).length||(this.processingFlag=!0,setTimeout((()=>{this.processingFlag=!1}),500))},getMessageProps(e){const t={key:`subMsg$${e}`,props:{highlight:this.config.highlight,message:this.renderedMessages[e]},on:{"action-send":e=>{this.$emit("action-send",e)}}};return t},playStopHandler(){this.isPlayed?this.$emit("pause"):this.$emit("play"),this.isPlayed=!this.isPlayed},subscribeMessageHandler(){this.loadingStatus=!0,this.needUseSubUserPropsToUnsub&&this.$set(this.config.unsubscribeProperties,"userProperties",Object.assign({},this.config.options.properties.userProperties)),this.$emit("subscribe")},unsubscribeMessageHandler(e,t){this.isPlayed=null,this.treeSelectedTopic=null,this.clearScrollParams(),this.$emit("unsubscribe"),this.processingFlag=null},removeSubscriber(e){this.$emit("remove")},addSubscriberUserProperty(){this.config.options.properties.userProperties||this.$set(this.config.options.properties,"userProperties",{}),this.$set(this.config.options.properties.userProperties,this.subscriberUserProperty.name,this.subscriberUserProperty.value),this.subscriberUserProperty={value:"",name:""}},removeSubscriberUserProperty(e){this.$delete(this.config.options.properties.userProperties,e),Object.keys(this.config.options.properties.userProperties).length||this.$set(this.config.options.properties,"userProperties",void 0)},addUnsubscribeUserProperty(){this.config.unsubscribeProperties.userProperties||this.$set(this.config.unsubscribeProperties,"userProperties",{}),this.$set(this.config.unsubscribeProperties.userProperties,this.unsubscribeUserProperty.name,this.unsubscribeUserProperty.value),this.unsubscribeUserProperty={value:"",name:""}},removeUnsubscribeUserProperty(e){this.$delete(this.config.unsubscribeProperties.userProperties,e),Object.keys(this.config.unsubscribeProperties.userProperties).length||this.$set(this.config.unsubscribeProperties,"userProperties",void 0)},showSharedSubscriptionNotification(){this.$q.dialog({title:"Shared subscription info",message:"You are trying to subscribe to a Shared Subscription. Publication that matches its Topic Filter is sent to one of the subscribed sessions only.",color:"primary",ok:!0,preventClose:!0})},listScroll(e){if(this.status){const e=this.$refs.scroller&&this.$refs.scroller.$el;if(!e)return!1;e.scrollTop<e.scrollHeight-e.clientHeight?this.needAutoScroll=!1:this.needAutoScroll=!0}},clearScrollParams(){this.currentScrollTop=0,this.allScrollTop=0,this.needAutoScroll=!0},clearMessagesHandler(){this.$emit("clear")},treeValueChangeHandler(e){this.treeSelectedTopic=e},changeModeHandler(){this.treeSelectedTopic=null},validateSetting(e){return!!h()(this.validationModel,e,!1)},getValidateMessage(e){return h()(this.validationModel,e,"")},getDescription(e){return h()(this.declarations,`${e}.desc`,"")}},watch:{config:{deep:!0,handler(e){this.$emit("input",e)}},status(e){e&&this.loadingStatus?(this.loadingStatus=!1,this.isPlayed=!0):e||(this.isPlayed=null)},value:{deep:!0,handler(e){this.config=e}}},components:{VirtualList:ye.a,Tree:ve,Message:Oe,FlespiTopicConfigurator:ce},directives:{autoscroll:{inserted(e,{value:t}){t&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated(e,{value:t}){setTimeout((()=>{t&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),50)}}},mixins:[We]},Ze=Ge,et=(s("db71"),s("4e73")),tt=s("1c1c"),st=s("27f9"),it=s("9564"),rt=s("3b73"),ot=s("8f8e"),nt=s("b047"),at=s("74f7"),lt=s("cf57"),ct=s("714f"),pt=Object(L["a"])(Ze,U,O,!1,null,null,null),dt=pt.exports;J()(pt,"components",{QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QToolbarTitle:ie["a"],QBtn:ne["a"],QTooltip:be["a"],QMenu:et["a"],QList:tt["a"],QItem:B["a"],QItemSection:V["a"],QIcon:he["a"],QItemLabel:F["a"],QInput:st["a"],QBtnToggle:z["a"],QToggle:it["a"],QExpansionItem:rt["a"],QCheckbox:ot["a"],QSeparator:re["a"],QChip:nt["a"],QInnerLoading:at["a"],QSpinnerGears:lt["a"]}),J()(pt,"directives",{ClosePopup:ae["a"],Ripple:ct["a"]});var ut=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__publisher"},[s("q-card",{staticClass:"publisher__item q-ma-sm"},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none text-white bg-indigo"},[s("q-toolbar-title",[e._v("Publisher")]),s("q-btn",{attrs:{round:"",disable:!e.isValidPublisher,flat:"",icon:"mdi-send"},on:{click:function(t){return e.$emit("publish")}}},[s("q-tooltip",[e._v("Publish")])],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide panel")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("remove")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"mdi-delete-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Remove")])],1)],1)],1)],1)],1)],1)],1),s("q-card-section",{staticClass:"publisher__main q-pb-none"},[s("div",[s("q-input",{staticClass:"q-mb-xs",attrs:{"no-error-icon":"",color:"grey-9",autogrow:"",type:"aria",label:"Topic",error:e.validateSetting("topic"),"error-message":e.getValidateMessage("topic"),outlined:"","hide-bottom-space":""},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("topic")))])],1)],1),s("q-input",{ref:"messageInput",staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",autogrow:"",type:"textarea",label:"Message"},model:{value:e.config.payload,callback:function(t){e.$set(e.config,"payload",t)},expression:"config.payload"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("payload")))])],1)],1),s("q-expansion-item",{staticClass:"bg-grey-2",attrs:{value:!0,label:"Options"}},[s("div",[s("div",{staticClass:"q-mx-md",staticStyle:{"line-height":"34px"}},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("\n                QoS\n                "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.qos,callback:function(t){e.$set(e.config.options,"qos",t)},expression:"config.options.qos"}})],1),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.qos")))])],1)],1),s("div",{staticClass:"q-mr-md q-ml-sm"},[s("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Retain"},model:{value:e.config.options.retain,callback:function(t){e.$set(e.config.options,"retain",t)},expression:"config.options.retain"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.retain")))])],1)],1),s("div",{staticClass:"q-mr-md q-ml-sm"},[s("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Duplicate flag"},model:{value:e.config.options.dup,callback:function(t){e.$set(e.config.options,"dup",t)},expression:"config.options.dup"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.dup")))])],1)],1),5===e.version?s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-4",attrs:{label:"Properties"}},[s("div",{staticClass:"q-px-md q-pb-sm"},[s("div",[s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Payload format indicator"},model:{value:e.config.options.properties.payloadFormatIndicator,callback:function(t){e.$set(e.config.options.properties,"payloadFormatIndicator",t)},expression:"config.options.properties.payloadFormatIndicator"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.payloadFormatIndicator")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Message expiry interval",outlined:"","hide-bottom-space":"",error:e.validateSetting("options.properties.messageExpiryInterval"),"error-message":e.getValidateMessage("options.properties.messageExpiryInterval"),"no-error-icon":""},on:{input:function(t){t||(e.config.options.properties.messageExpiryInterval=void 0)}},model:{value:e.config.options.properties.messageExpiryInterval,callback:function(t){e.$set(e.config.options.properties,"messageExpiryInterval",e._n(t))},expression:"config.options.properties.messageExpiryInterval"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.messageExpiryInterval")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Topic alias",outlined:"","hide-bottom-space":"",error:e.validateSetting("options.properties.topicAlias"),"error-message":e.getValidateMessage("options.properties.topicAlias"),"no-error-icon":""},on:{input:function(t){t||(e.config.options.properties.topicAlias=void 0)}},model:{value:e.config.options.properties.topicAlias,callback:function(t){e.$set(e.config.options.properties,"topicAlias",e._n(t))},expression:"config.options.properties.topicAlias"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.topicAlias")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Response topic",outlined:"","hide-bottom-space":""},model:{value:e.config.options.properties.responseTopic,callback:function(t){e.$set(e.config.options.properties,"responseTopic",t)},expression:"config.options.properties.responseTopic"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.responseTopic")))])],1)],1),s("q-input",{staticClass:"q-textarea--fix q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"textarea",autogrow:"",label:"Correlation data"},model:{value:e.config.options.properties.correlationData,callback:function(t){e.$set(e.config.options.properties,"correlationData",t)},expression:"config.options.properties.correlationData"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.properties.correlationData")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Content type"},model:{value:e.config.options.properties.contentType,callback:function(t){e.$set(e.config.options.properties,"contentType",t)},expression:"config.options.properties.contentType"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.contentType")))])],1)],1),s("div",{staticClass:"q-mb-sm"},[s("div",{staticClass:"q-mt-md q-mb-sm"},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("User Properties")]),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.userProperties")))])],1)],1),s("div",[e.config.options.properties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.options.properties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removePublishUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property name"},model:{value:e.publishUserProperty.name,callback:function(t){e.$set(e.publishUserProperty,"name",t)},expression:"publishUserProperty.name"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property value"},model:{value:e.publishUserProperty.value,callback:function(t){e.$set(e.publishUserProperty,"value",t)},expression:"publishUserProperty.value"}}),s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.publishUserProperty.name||!e.publishUserProperty.value,color:"grey-9"},on:{click:function(t){return e.addPublishUserProperty()}}},[e._v("Add")])],1)])],1)]):e._e()],1)])],1)])],1)],1)},mt=[],ht={name:"Publisher",props:["value","version"],data(){return{declarations:Ee,config:this.value,publishUserProperty:{value:"",name:""}}},computed:{validationModel(){return this.validatePublisher(this.config,!0)},isValidPublisher(){return!Object.keys(this.validationModel).length}},methods:{isNil:Xe.a,addPublishUserProperty(){this.config.options.properties.userProperties||this.$set(this.config.options.properties,"userProperties",{});const e=this.config.options.properties.userProperties;e[this.publishUserProperty.name]?Array.isArray(e[this.publishUserProperty.name])?e[this.publishUserProperty.name].push(this.publishUserProperty.value):this.$set(e,this.publishUserProperty.name,[e[this.publishUserProperty.name],this.publishUserProperty.value]):this.$set(e,this.publishUserProperty.name,this.publishUserProperty.value),this.publishUserProperty={value:"",name:""}},removePublishUserProperty(e){this.$delete(this.config.options.properties.userProperties,e),Object.keys(this.config.options.properties.userProperties).length||this.$set(this.config.options.properties,"userProperties",void 0)},validateSetting(e){return!!h()(this.validationModel,e,!1)},getValidateMessage(e){return h()(this.validationModel,e,"")},getDescription(e){return h()(this.declarations,`${e}.desc`,"")}},watch:{config:{deep:!0,handler(e){this.$emit("input",e)}},value:{deep:!0,handler(e){this.config=e}}},mounted(){this.$nextTick((()=>this.$refs.messageInput.__adjustHeight()))},mixins:[We]},bt=ht,gt=(s("57fe"),s("8572")),vt=Object(L["a"])(bt,ut,mt,!1,null,null,null),ft=vt.exports;J()(vt,"components",{QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QToolbarTitle:ie["a"],QBtn:ne["a"],QTooltip:be["a"],QMenu:et["a"],QList:tt["a"],QItem:B["a"],QItemSection:V["a"],QIcon:he["a"],QItemLabel:F["a"],QInput:st["a"],QExpansionItem:rt["a"],QBtnToggle:z["a"],QCheckbox:ot["a"],QField:gt["a"]}),J()(vt,"directives",{ClosePopup:ae["a"],Ripple:ct["a"]});var yt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__not-resolved-msgs"},[s("q-card",{staticClass:"not-resolved-msgs__main q-ma-sm"},[s("q-card-section",{staticClass:"q-pa-none"},[e.filterMode?s("q-input",{staticClass:"q-ma-sm q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Filter by topic",autofocus:""},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-btn",{attrs:{slot:"prepend",color:"grey-9",icon:"mdi-arrow-left",flat:"",round:""},on:{click:function(t){e.filterMode=!1,e.filter=""}},slot:"prepend"}),e.filter?s("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-close",flat:"",round:""},on:{click:function(t){e.filter=""}},slot:"append"}):e._e()],1):s("q-toolbar",{staticClass:"q-pr-none text-white bg-red-6"},[s("q-toolbar-title",[e._v("Unresolved messages")]),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-magnify"},on:{click:function(t){e.filterMode=!0}}}),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide panel")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.clearMessagesHandler}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-playlist-remove"}})],1),s("q-item-section",[s("q-item-label",[e._v("Clear messages")])],1)],1)],1)],1)],1)],1)],1),s("virtual-list",{directives:[{name:"autoscroll",rawName:"v-autoscroll",value:e.needAutoScroll,expression:"needAutoScroll"}],ref:"scroller",staticClass:"not-resolved-msgs__list",attrs:{size:110,remain:15,onscroll:e.listScroll}},e._l(e.filteredNotResolvedMessages,(function(e,t){return s("message",{key:"subNRMsg"+t,attrs:{message:e}})})),1)],1)],1)},qt=[],xt={name:"Unresolved",props:["messages"],data(){return{filter:"",needAutoScroll:!0,filterMode:!1}},computed:{filteredNotResolvedMessages(){return this.messages.filter((e=>-1!==e.topic.indexOf(this.filter)))}},methods:{listScroll:function(e,t){const s=this.$refs.scroller&&this.$refs.scroller.$el;if(!s)return!1;s.scrollTop<s.scrollHeight-s.clientHeight?this.needAutoScroll=!1:this.needAutoScroll=!0},clearMessagesHandler(){this.$emit("clear")}},components:{VirtualList:ye.a,Message:Oe},directives:{autoscroll:{inserted(e,{value:t}){t&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated(e,{value:t}){setTimeout((()=>{t&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),50)}}}},_t=xt,St=(s("744b"),Object(L["a"])(_t,yt,qt,!1,null,null,null)),Ct=St.exports;J()(St,"components",{QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QToolbarTitle:ie["a"],QBtn:ne["a"],QMenu:et["a"],QList:tt["a"],QItem:B["a"],QItemSection:V["a"],QIcon:he["a"],QItemLabel:F["a"],QInput:st["a"]}),J()(St,"directives",{ClosePopup:ae["a"],Ripple:ct["a"]});var wt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__logs"},[s("q-card",{staticClass:"logs__wrapper q-ma-sm",staticStyle:{overflow:"hidden"}},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none text-white bg-blue"},[s("q-toolbar-title",[e._v("Logs")]),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.clearLogsHandler}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-playlist-remove"}})],1),s("q-item-section",[s("q-item-label",[e._v("Clear logs")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide panel")])],1)],1)],1)],1)],1)],1)],1),s("q-card-section",{directives:[{name:"autoscroll",rawName:"v-autoscroll",value:e.needAutoScroll,expression:"needAutoScroll"}],ref:"scroller",staticClass:"scroll q-pa-none",staticStyle:{height:"calc(100% - 50px)"},nativeOn:{scroll:function(t){return e.listScroll.apply(null,arguments)}}},e._l(e.logs,(function(t,i){return s("q-card",{key:"log"+i,staticClass:"log__item q-ma-sm",class:["bg-"+e.getColor(t)+"-3"]},[s("div",{staticClass:"log__title q-py-xs q-px-sm text-bold"},[e._v("\n          "+e._s(t.type)+"\n        ")]),"offline"===t.type||"reconnect"===t.type||"end"===t.type?[s("div",{staticClass:"log__payload q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}})]:"disconnect"===t.type?[t.data?s("div",{staticClass:"log__payload q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[e._v("\n            disconnected by broker:\n            "),s("div",[e._v(e._s(t.data.reasonCode+": "+e.codes[t.data.reasonCode]))])]):e._e()]:"created"===t.type||"updated"===t.type?[s("div",{staticClass:"log__payload q-px-sm q-pt-xs q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticClass:"q-ma-none",staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[s("json-tree",{attrs:{data:t.data}})],1)])]:"connect"===t.type?[e.codes[t.data.returnCode]||e.codes[t.data.reasonCode]?s("div",{staticClass:"log__payload q-px-sm q-py-xs q-mr-xs q-ml-xs bg-grey-2"},[e._v("\n            "+e._s(e.codes[t.data.returnCode]||e.codes[t.data.reasonCode])+"\n          ")]):e._e(),t.data.properties?s("div",{staticClass:"log__properties q-pt-xs q-mr-xs q-ml-xs text-grey-7 bg-green-1",staticStyle:{"font-size":".75rem","word-break":"break-all"}},[s("json-tree",{attrs:{data:t.data.properties}})],1):e._e()]:"error"===t.type?[s("div",{staticClass:"log__payload q-px-sm q-py-xs q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticClass:"q-ma-none",staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(t.data.error.message))])])]:"subscribe"===t.type?[s("div",{staticClass:"log__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2 row",staticStyle:{"font-size":".75rem"}},[t.data.restored?e._e():s("div",{staticClass:"col-6 q-pr-xs"},[s("div",{staticClass:"text-bold"},[e._v("Request")]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.settings.topic))]),s("div",[s("span",{staticClass:"text-bold"},[e._v("QoS: ")]),e._v(e._s(t.data.settings.options.qos))]),void 0!==t.data.settings.options.nl?s("div",[s("span",{staticClass:"text-bold"},[e._v("No Local: ")]),e._v(e._s(t.data.settings.options.nl))]):e._e(),void 0!==t.data.settings.options.rap?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain as Published: ")]),e._v(e._s(t.data.settings.options.rap))]):e._e(),void 0!==t.data.settings.options.rh?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain handling: ")]),e._v(e._s(t.data.settings.options.rh))]):e._e()]),t.data.grants[0]&&0===(128&t.data.grants[0].qos)?s("div",{staticClass:"col-6 q-pl-xs"},[t.data.restored?s("div",{staticClass:"col-6 q-pr-xs text-bold"},[e._v("Access (restored by broker)")]):s("div",{staticClass:"col-6 q-pr-xs text-bold"},[e._v("Access")]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.grants[0].topic))]),s("div",[s("span",{staticClass:"text-bold"},[e._v("QoS: ")]),e._v(e._s(t.data.grants[0].qos))]),void 0!==t.data.grants[0].nl?s("div",[s("span",{staticClass:"text-bold"},[e._v("No Local: ")]),e._v(e._s(t.data.grants[0].nl))]):e._e(),void 0!==t.data.grants[0].rap?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain as Published: ")]),e._v(e._s(t.data.grants[0].rap))]):e._e(),void 0!==t.data.grants[0].rh?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain handling: ")]),e._v(e._s(t.data.grants[0].rh))]):e._e()]):e._e(),t.data.grants[0]&&(128&t.data.grants[0].qos)>0?s("div",[s("div",{staticClass:"col-6 q-pr-xs text-bold"},[e._v("Error")]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.grants[0].topic))]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Message: ")]),e._v(e._s(e.codes[t.data.grants[0].qos]))])]):e._e()])]:"unsubscribe"===t.type?[s("div",{staticClass:"log__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.topic))]),s("div",[s("span",{staticClass:"text-bold"},[e._v("QoS: ")]),e._v(e._s(t.data.options.qos))]),void 0!==t.data.options.nl?s("div",[s("span",{staticClass:"text-bold"},[e._v("No Local: ")]),e._v(e._s(t.data.options.nl))]):e._e(),void 0!==t.data.options.rap?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain as Published: ")]),e._v(e._s(t.data.options.rap))]):e._e(),void 0!==t.data.options.rh?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain handling: ")]),e._v(e._s(t.data.options.rh))]):e._e()])]:[s("div",{staticClass:"log__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(t.data))])])],s("div",{staticClass:"log__timestamp q-py-xs q-px-sm text-grey-7"},[e._v(e._s(e.date.formatDate(t.timestamp,"DD/MM/YYYY HH:mm:ss")))])],2)})),1)],1)],1)},Pt=[],kt={name:"Logs",props:["logs"],data(){return{needAutoScroll:!0,colors:{connect:"green",error:"red",offline:"grey",reconnect:"yellow",subscribe:"orange",unsubscribe:"purple",disconnect:"red",end:"grey",created:"green",updated:"yellow"},date:_e["a"],codes:{0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"}}},methods:{getColor(e){return"connect"===e.type&&(this.codes[e.data.returnCode]||this.codes[e.data.reasonCode])?"red":"subscribe"===e.type&&e.data.restored?"blue":"subscribe"===e.type&&e.data.grants&&(128&e.data.grants[0].qos)>0?"red":"disconnect"===e.type&&e.data?"brown":this.colors[e.type]},listScroll(e){const t=this.$refs.scroller.$el;t.scrollTop<t.scrollHeight-t.clientHeight?this.needAutoScroll=!1:this.needAutoScroll=!0},clearScrollParams(){this.currentScrollTop=0,this.allScrollTop=0,this.needAutoScroll=!0},clearLogsHandler(){this.$emit("clear")}},created(){this.$nextTick((()=>{if(this.needAutoScroll&&this.$refs.scroller){const e=this.$refs.scroller.$el;e.scrollTop=e.scrollHeight-e.clientHeight}}))},directives:{autoscroll:{inserted(e,{value:t}){t&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated(e,{value:t}){setTimeout((()=>{t&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),50)}}},components:{JsonTree:Me}},$t=kt,Mt=(s("3b81"),Object(L["a"])($t,wt,Pt,!1,null,null,null)),It=Mt.exports;J()(Mt,"components",{QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QToolbarTitle:ie["a"],QBtn:ne["a"],QMenu:et["a"],QList:tt["a"],QItem:B["a"],QItemSection:V["a"],QIcon:he["a"],QItemLabel:F["a"]}),J()(Mt,"directives",{ClosePopup:ae["a"],Ripple:ct["a"]});var Tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"modal",attrs:{"content-class":"mqtt-board__popup",maximized:e.$q.platform.is.mobile},on:{show:function(t){return e.$emit("show")},hide:function(t){return e.$emit("hide")}}},[s("q-card",{style:{width:e.$q.platform.is.mobile?"100%":"50vw"}},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none bg-indigo text-white"},[s("q-toolbar-title",[e._v("Publisher")]),s("q-btn",{attrs:{round:"",disable:!e.isValidPublisher,flat:"",icon:"mdi-send"},on:{click:function(t){e.$emit("publish",e.config),e.hide()}}},[s("q-tooltip",[e._v("Publish")])],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-close"},on:{click:e.hide}})],1)],1),s("q-separator"),s("q-card-section",{staticClass:"scroll q-pa-none",style:{height:e.$q.platform.is.mobile?"calc(100% - 50px)":"70vh"}},[s("div",{staticClass:"mqtt-client__publisher"},[s("div",{staticClass:"q-pa-md"},[s("q-input",{staticClass:"q-mb-xs",attrs:{"no-error-icon":"",color:"grey-9",autogrow:"",type:"aria",label:"Topic",error:e.validateSetting("topic"),"error-message":e.getValidateMessage("topic"),outlined:"","hide-bottom-space":""},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("topic")))])],1)],1),s("q-input",{ref:"messageInput",staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",autogrow:"",type:"textarea",label:"Message"},model:{value:e.config.payload,callback:function(t){e.$set(e.config,"payload",t)},expression:"config.payload"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("payload")))])],1)],1),s("q-expansion-item",{staticClass:"bg-grey-2",attrs:{value:!0,label:"Options"}},[s("div",[s("div",{staticClass:"q-mx-md",staticStyle:{"line-height":"34px"}},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("\n                  QoS\n                  "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.qos,callback:function(t){e.$set(e.config.options,"qos",t)},expression:"config.options.qos"}})],1),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.qos")))])],1)],1),s("div",{staticClass:"q-mr-md q-ml-sm"},[s("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Retain"},model:{value:e.config.options.retain,callback:function(t){e.$set(e.config.options,"retain",t)},expression:"config.options.retain"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.retain")))])],1)],1),s("div",{staticClass:"q-mr-md q-ml-sm"},[s("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Duplicate flag"},model:{value:e.config.options.dup,callback:function(t){e.$set(e.config.options,"dup",t)},expression:"config.options.dup"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.dup")))])],1)],1),5===e.version?s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-4",attrs:{value:!0,label:"Properties"}},[s("div",{staticClass:"q-px-md q-pb-sm"},[s("div",[s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Payload format indicator"},model:{value:e.config.options.properties.payloadFormatIndicator,callback:function(t){e.$set(e.config.options.properties,"payloadFormatIndicator",t)},expression:"config.options.properties.payloadFormatIndicator"}}),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.payloadFormatIndicator")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Message expiry interval",outlined:"","hide-bottom-space":"",error:e.validateSetting("options.properties.messageExpiryInterval"),"error-message":e.getValidateMessage("options.properties.messageExpiryInterval"),"no-error-icon":""},on:{input:function(t){t||(e.config.options.properties.messageExpiryInterval=void 0)}},model:{value:e.config.options.properties.messageExpiryInterval,callback:function(t){e.$set(e.config.options.properties,"messageExpiryInterval",e._n(t))},expression:"config.options.properties.messageExpiryInterval"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.messageExpiryInterval")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Topic alias",outlined:"","hide-bottom-space":"",error:e.validateSetting("options.properties.topicAlias"),"error-message":e.getValidateMessage("options.properties.topicAlias"),"no-error-icon":""},on:{input:function(t){t||(e.config.options.properties.topicAlias=void 0)}},model:{value:e.config.options.properties.topicAlias,callback:function(t){e.$set(e.config.options.properties,"topicAlias",e._n(t))},expression:"config.options.properties.topicAlias"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.topicAlias")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Response topic",outlined:"","hide-bottom-space":""},model:{value:e.config.options.properties.responseTopic,callback:function(t){e.$set(e.config.options.properties,"responseTopic",t)},expression:"config.options.properties.responseTopic"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.responseTopic")))])],1)],1),s("q-input",{staticClass:"q-textarea--fix q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"textarea",autogrow:"",label:"Correlation data"},model:{value:e.config.options.properties.correlationData,callback:function(t){e.$set(e.config.options.properties,"correlationData",t)},expression:"config.options.properties.correlationData"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",{attrs:{"max-width":"200px"}},[e._v(e._s(e.getDescription("options.properties.correlationData")))])],1)],1),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Content type"},model:{value:e.config.options.properties.contentType,callback:function(t){e.$set(e.config.options.properties,"contentType",t)},expression:"config.options.properties.contentType"}},[s("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.contentType")))])],1)],1),s("div",{staticClass:"q-mb-sm"},[s("div",{staticClass:"q-mt-md q-mb-sm"},[s("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[e._v("User Properties")]),s("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[s("q-tooltip",[e._v(e._s(e.getDescription("options.properties.userProperties")))])],1)],1),s("div",[e.config.options.properties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.options.properties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removePublishUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property name"},model:{value:e.publishUserProperty.name,callback:function(t){e.$set(e.publishUserProperty,"name",t)},expression:"publishUserProperty.name"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property value"},model:{value:e.publishUserProperty.value,callback:function(t){e.$set(e.publishUserProperty,"value",t)},expression:"publishUserProperty.value"}}),s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.publishUserProperty.name||!e.publishUserProperty.value,color:"grey-9"},on:{click:function(t){return e.addPublishUserProperty()}}},[e._v("Add")])],1)])],1)]):e._e()],1)])],1)])])],1)],1)},Ut=[],Ot={name:"PublisherModal",props:["message","version"],data(){return{declarations:Ee,config:{topic:this.message.topic,payload:JSON.stringify(this.message.payload),options:{qos:this.message.qos,retain:this.message.retain,dup:this.message.dup,properties:u()(this.message.properties)}},publishUserProperty:{value:"",name:""}}},computed:{validationModel(){return this.validatePublisher(this.config,!0)},isValidPublisher(){return!Object.keys(this.validationModel).length}},methods:{isNil:Xe.a,addPublishUserProperty(){this.config.options.properties.userProperties||this.$set(this.config.options.properties,"userProperties",{});const e=this.config.options.properties.userProperties;e[this.publishUserProperty.name]?Array.isArray(e[this.publishUserProperty.name])?e[this.publishUserProperty.name].push(this.publishUserProperty.value):this.$set(e,this.publishUserProperty.name,[e[this.publishUserProperty.name],this.publishUserProperty.value]):this.$set(e,this.publishUserProperty.name,this.publishUserProperty.value),this.publishUserProperty={value:"",name:""}},removePublishUserProperty(e){this.$delete(this.config.options.properties.userProperties,e),Object.keys(this.config.options.properties.userProperties).length||this.$set(this.config.options.properties,"userProperties",void 0)},show(){this.$refs.modal.show()},hide(){this.$refs.modal.hide()},validateSetting(e){return!!h()(this.validationModel,e,!1)},getValidateMessage(e){return h()(this.validationModel,e,"")},getDescription(e){return h()(this.declarations,`${e}.desc`,"")}},mounted(){this.$nextTick((()=>this.$refs.messageInput.__adjustHeight()))},mixins:[We]},Qt=Ot,Dt=(s("0a8d"),Object(L["a"])(Qt,Tt,Ut,!1,null,null,null)),Et=Dt.exports;J()(Dt,"components",{QDialog:Z["a"],QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QToolbarTitle:ie["a"],QBtn:ne["a"],QTooltip:be["a"],QSeparator:re["a"],QInput:st["a"],QIcon:he["a"],QExpansionItem:rt["a"],QBtnToggle:z["a"],QCheckbox:ot["a"],QList:tt["a"],QItem:B["a"],QField:gt["a"]});var At=function(){var e,t,s,i=this,r=i.$createElement,o=i._self._c||r;return o("q-dialog",{attrs:{"content-class":"mqtt-board__popup",maximized:i.$q.platform.is.mobile,"no-backdrop-dismiss":"","no-esc-dismiss":""},model:{value:i.model,callback:function(e){i.model=e},expression:"model"}},[o("q-card",{style:{minWidth:i.$q.platform.is.mobile?"100%":"50vw"}},[o("q-card-section",{staticClass:"q-pa-none",class:(e={},e["bg-"+i.color]=!0,e["text-white"]=!!i.color,e)},[o("q-toolbar",{class:(t={},t["bg-"+i.color]=!0,t["text-white"]=!!i.color,t)},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"keyboard_arrow_left"},on:{click:i.close}}),o("q-toolbar-title",[i._v("\n          Connection settings\n        ")])],1)],1),o("q-separator"),o("q-card-section",{staticClass:"scroll",style:{height:i.$q.platform.is.mobile?"calc(100% - 94px)":"50vh"}},[o("div",[o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","no-error-icon":"",label:"Client name"},model:{value:i.currentSettings.clientName,callback:function(e){i.$set(i.currentSettings,"clientName",e)},expression:"currentSettings.clientName"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("clientName")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","no-error-icon":"",label:"Client ID",error:i.validateSetting("clientId"),"error-message":i.getValidateMessage("clientId"),"hide-bottom-space":""},model:{value:i.currentSettings.clientId,callback:function(e){i.$set(i.currentSettings,"clientId",e)},expression:"currentSettings.clientId"}},[o("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-refresh",flat:"",round:""},on:{click:function(e){i.currentSettings.clientId="mqtt-board-"+Math.random().toString(16).substr(2,8)}},slot:"append"}),o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("clientId")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9","no-error-icon":"",outlined:"",label:"Host",error:i.validateSetting("host"),"error-message":i.getValidateMessage("host"),"hide-bottom-space":""},model:{value:i.currentSettings.host,callback:function(e){i.$set(i.currentSettings,"host",e)},expression:"currentSettings.host"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("host")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9","no-error-icon":"",outlined:"","hide-bottom-space":"",type:"number",label:"Keep alive",error:i.validateSetting("keepalive"),"error-message":i.getValidateMessage("keepalive")},model:{value:i.currentSettings.keepalive,callback:function(e){i.$set(i.currentSettings,"keepalive",i._n(e))},expression:"currentSettings.keepalive"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",{attrs:{"max-width":"200px"}},[i._v(i._s(i.getDescription("keepalive")))])],1)],1),o("q-select",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","popup-content-class":"mqtt-board__popup","map-options":"","emit-value":"",options:[{label:"3.1.1",value:4},{label:"5.0",value:5}],label:"Version of MQTT","hide-bottom-space":"","options-selected-class":"bg-grey-2 text-grey-9"},model:{value:i.currentSettings.protocolVersion,callback:function(e){i.$set(i.currentSettings,"protocolVersion",e)},expression:"currentSettings.protocolVersion"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("protocolVersion")))])],1)],1),o("div",[o("q-checkbox",{staticClass:"q-my-sm",staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:5===i.currentSettings.protocolVersion?"Clean start":"Clean session"},model:{value:i.currentSettings.clean,callback:function(e){i.$set(i.currentSettings,"clean",e)},expression:"currentSettings.clean"}}),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("clean")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Username"},model:{value:i.currentSettings.username,callback:function(e){i.$set(i.currentSettings,"username",e)},expression:"currentSettings.username"}},[-1!==i.currentSettings.host.indexOf("flespi")?o("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-login",flat:"",round:""},on:{click:i.flespiLoginHandler},slot:"append"},[o("q-tooltip",[i._v("Get flespi token")])],1):i._e(),o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("username")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Password"},model:{value:i.currentSettings.password,callback:function(e){i.$set(i.currentSettings,"password",e)},expression:"currentSettings.password"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("password")))])],1)],1),5===i.currentSettings.protocolVersion?o("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{label:"Properties"}},[o("div",{staticClass:"q-px-md q-py-sm"},[o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"number",min:0,label:"Session expiry interval",error:i.validateSetting("properties.sessionExpiryInterval"),"error-message":i.getValidateMessage("properties.sessionExpiryInterval"),"no-error-icon":""},on:{input:function(e){e||(i.currentSettings.properties.sessionExpiryInterval=void 0)}},model:{value:i.currentSettings.properties.sessionExpiryInterval,callback:function(e){i.$set(i.currentSettings.properties,"sessionExpiryInterval",i._n(e))},expression:"currentSettings.properties.sessionExpiryInterval"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.sessionExpiryInterval")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Receive maximum",outlined:"","hide-bottom-space":"",error:i.validateSetting("properties.receiveMaximum"),"error-message":i.getValidateMessage("properties.receiveMaximum"),"no-error-icon":""},on:{input:function(e){e||(i.currentSettings.properties.receiveMaximum=void 0)}},model:{value:i.currentSettings.properties.receiveMaximum,callback:function(e){i.$set(i.currentSettings.properties,"receiveMaximum",i._n(e))},expression:"currentSettings.properties.receiveMaximum"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.receiveMaximum")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Maximum packet size",outlined:"","hide-bottom-space":"",error:i.validateSetting("properties.maximumPacketSize"),"error-message":i.getValidateMessage("properties.maximumPacketSize"),"no-error-icon":""},on:{input:function(e){e||(i.currentSettings.properties.maximumPacketSize=void 0)}},model:{value:i.currentSettings.properties.maximumPacketSize,callback:function(e){i.$set(i.currentSettings.properties,"maximumPacketSize",i._n(e))},expression:"currentSettings.properties.maximumPacketSize"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.maximumPacketSize")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Topic alias maximum",outlined:"","hide-bottom-space":"",error:i.validateSetting("properties.topicAliasMaximum"),"error-message":i.getValidateMessage("properties.topicAliasMaximum"),"no-error-icon":""},on:{input:function(e){e||(i.currentSettings.properties.topicAliasMaximum=void 0)}},model:{value:i.currentSettings.properties.topicAliasMaximum,callback:function(e){i.$set(i.currentSettings.properties,"topicAliasMaximum",i._n(e))},expression:"currentSettings.properties.topicAliasMaximum"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.topicAliasMaximum")))])],1)],1),o("div",[o("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Request-Response information"},model:{value:i.currentSettings.properties.requestResponseInformation,callback:function(e){i.$set(i.currentSettings.properties,"requestResponseInformation",e)},expression:"currentSettings.properties.requestResponseInformation"}}),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.requestResponseInformation")))])],1)],1),o("div",[o("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Request problem information"},model:{value:i.currentSettings.properties.requestProblemInformation,callback:function(e){i.$set(i.currentSettings.properties,"requestProblemInformation",e)},expression:"currentSettings.properties.requestProblemInformation"}}),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",{attrs:{"max-width":"200px"}},[i._v(i._s(i.getDescription("properties.requestProblemInformation")))])],1)],1),o("div",{staticClass:"q-mb-sm"},[o("div",{staticClass:"q-mt-md q-mb-sm"},[o("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[i._v("User Properties")]),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.userProperties")))])],1)],1),o("div",[i.currentSettings.properties.userProperties?o("q-list",{staticClass:"q-mb-xs",attrs:{bordered:""}},i._l(i.currentSettings.properties.userProperties,(function(e,t){return o("q-item",{key:t+": "+e,staticStyle:{"min-height":"17px"}},[o("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1.2rem",name:"mdi-close-circle"},nativeOn:{click:function(e){return i.removeConnectUserProperty(t)}}}),o("span",[i._v(i._s(t+": "+e))])],1)})),1):i._e(),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"User property name",outlined:"","hide-bottom-space":""},model:{value:i.connectUserProperty.name,callback:function(e){i.$set(i.connectUserProperty,"name",e)},expression:"connectUserProperty.name"}}),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"User property value",outlined:"","hide-bottom-space":""},model:{value:i.connectUserProperty.value,callback:function(e){i.$set(i.connectUserProperty,"value",e)},expression:"connectUserProperty.value"}}),o("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{color:"grey-9"},on:{click:i.addUserProperty}},[i._v("Add")])],1)]),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Authentication method",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.properties.authenticationMethod,callback:function(e){i.$set(i.currentSettings.properties,"authenticationMethod",e)},expression:"currentSettings.properties.authenticationMethod"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.authenticationMethod")))])],1)],1),o("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",type:"textarea",label:"Authentication data",outlined:"","hide-bottom-space":"",autogrow:""},model:{value:i.currentSettings.properties.authenticationData,callback:function(e){i.$set(i.currentSettings.properties,"authenticationData",e)},expression:"currentSettings.properties.authenticationData"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("properties.authenticationData")))])],1)],1)],1)]):i._e(),o("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{label:"Will"}},[o("div",{staticClass:"q-px-md q-pb-sm"},[o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9","no-error-icon":"",error:i.validateSetting("will.topic"),"error-message":i.getValidateMessage("will.topic"),label:"Will topic",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.will.topic,callback:function(e){i.$set(i.currentSettings.will,"topic",e)},expression:"currentSettings.will.topic"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.topic")))])],1)],1),o("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9","no-error-icon":"",error:i.validateSetting("will.payload"),"error-message":i.getValidateMessage("will.payload"),type:"textarea",label:"Will payload",outlined:"","hide-bottom-space":"",autogrow:""},model:{value:i.currentSettings.will.payload,callback:function(e){i.$set(i.currentSettings.will,"payload",e)},expression:"currentSettings.will.payload"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.payload")))])],1)],1),o("div",{staticClass:"q-ml-xs",staticStyle:{"line-height":"48px"}},[o("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[i._v("\n                QoS\n                "),o("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:i.currentSettings.will.qos,callback:function(e){i.$set(i.currentSettings.will,"qos",e)},expression:"currentSettings.will.qos"}})],1),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.qos")))])],1)],1),o("div",[o("q-checkbox",{staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Will retain"},model:{value:i.currentSettings.will.retain,callback:function(e){i.$set(i.currentSettings.will,"retain",e)},expression:"currentSettings.will.retain"}}),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.retain")))])],1)],1),5===i.currentSettings.protocolVersion?o("q-expansion-item",{staticClass:"bg-grey-4",attrs:{label:"Will properties"}},[o("div",{staticClass:"q-px-md q-py-sm"},[o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"number",label:"Will delay interval",error:i.validateSetting("will.properties.willDelayInterval"),"error-message":i.getValidateMessage("will.properties.willDelayInterval"),"no-error-icon":""},on:{input:function(e){e||(i.currentSettings.will.properties.willDelayInterval=void 0)}},model:{value:i.currentSettings.will.properties.willDelayInterval,callback:function(e){i.$set(i.currentSettings.will.properties,"willDelayInterval",i._n(e))},expression:"currentSettings.will.properties.willDelayInterval"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.properties.willDelayInterval")))])],1)],1),o("div",[o("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{width:"calc(100% - 36px)"},attrs:{color:"grey-9",label:"Payload format indicator"},model:{value:i.currentSettings.will.properties.payloadFormatIndicator,callback:function(e){i.$set(i.currentSettings.will.properties,"payloadFormatIndicator",e)},expression:"currentSettings.will.properties.payloadFormatIndicator"}}),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.properties.payloadFormatIndicator")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Message expiry interval",outlined:"","hide-bottom-space":"",error:i.validateSetting("will.properties.messageExpiryInterval"),"error-message":i.getValidateMessage("will.properties.messageExpiryInterval"),"no-error-icon":""},on:{input:function(e){e||(i.currentSettings.will.properties.messageExpiryInterval=void 0)}},model:{value:i.currentSettings.will.properties.messageExpiryInterval,callback:function(e){i.$set(i.currentSettings.will.properties,"messageExpiryInterval",i._n(e))},expression:"currentSettings.will.properties.messageExpiryInterval"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.properties.messageExpiryInterval")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Content type",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.will.properties.contentType,callback:function(e){i.$set(i.currentSettings.will.properties,"contentType",e)},expression:"currentSettings.will.properties.contentType"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.properties.contentType")))])],1)],1),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Response topic",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.will.properties.responseTopic,callback:function(e){i.$set(i.currentSettings.will.properties,"responseTopic",e)},expression:"currentSettings.will.properties.responseTopic"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.properties.responseTopic")))])],1)],1),o("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",type:"textarea",label:"Correlation data",outlined:"","hide-bottom-space":"",autogrow:""},model:{value:i.currentSettings.will.properties.correlationData,callback:function(e){i.$set(i.currentSettings.will.properties,"correlationData",e)},expression:"currentSettings.will.properties.correlationData"}},[o("q-icon",{attrs:{slot:"after",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",{attrs:{"max-width":"200px"}},[i._v(i._s(i.getDescription("will.properties.correlationData")))])],1)],1),o("div",[o("div",{staticClass:"q-mt-md q-mb-sm"},[o("div",{staticStyle:{width:"calc(100% - 36px)",display:"inline-flex"}},[i._v("Will user properties")]),o("q-icon",{staticStyle:{"margin-left":"12px"},attrs:{slot:"after",size:"24px",color:"grey-7",name:"mdi-information-outline"},slot:"after"},[o("q-tooltip",[i._v(i._s(i.getDescription("will.properties.userProperties")))])],1)],1),o("div",[i.currentSettings.will.properties.userProperties?o("q-list",{staticClass:"q-mb-xs",staticStyle:{"border-color":"#b7b7b7"}},i._l(i.currentSettings.will.properties.userProperties,(function(e,t){return o("q-item",{key:t+": "+e,staticStyle:{"min-height":"17px"}},[o("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1.2rem",name:"mdi-close-circle"},nativeOn:{click:function(e){return i.removeWillConnectUserProperty(t)}}}),o("span",[i._v(i._s(t+": "+e))])],1)})),1):i._e(),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Will user property name",outlined:"","hide-bottom-space":""},model:{value:i.willConnectUserProperty.name,callback:function(e){i.$set(i.willConnectUserProperty,"name",e)},expression:"willConnectUserProperty.name"}}),o("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Will user property value",outlined:"","hide-bottom-space":""},model:{value:i.willConnectUserProperty.value,callback:function(e){i.$set(i.willConnectUserProperty,"value",e)},expression:"willConnectUserProperty.value"}}),o("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{color:"grey-9"},on:{click:i.addWillUserProperty}},[i._v("Add")])],1)])],1)]):i._e()],1)])],1)]),o("q-separator"),o("q-card-actions",{class:(s={},s["bg-"+i.color]=!0,s["text-white"]=!!i.color,s),attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-sm",attrs:{flat:"",dense:""},on:{click:i.close}},[i._v("Close")]),o("q-btn",{attrs:{flat:"",dense:"",disable:!i.isCurrentSettingsValid},on:{click:i.save}},[i._v("Save")])],1)],1)],1)},Nt=[],jt=s("d0b1"),Ht={props:{initSettings:{type:Object,default(){return{}}},settings:{type:Object,default(){return{}}},color:String,secure:Boolean},mixins:[We],data(){return{model:!0,declarations:Qe,currentSettings:u()(p()({},jt["b"],this.initSettings,this.settings)),connectUserProperty:{value:"",name:""},willConnectUserProperty:{value:"",name:""}}},computed:{validationModel(){return this.validateSettings(this.currentSettings,!0)},isCurrentSettingsValid(){return!Object.keys(this.validationModel).length}},methods:{isNil:Xe.a,close(){this.$emit("close")},save(){this.$emit("save",this.currentSettings),this.close()},addUserProperty(){this.currentSettings.properties.userProperties||(this.currentSettings.properties.userProperties={}),this.currentSettings.properties.userProperties[this.connectUserProperty.name]=this.connectUserProperty.value,this.connectUserProperty={value:"",name:""}},addWillUserProperty(){this.currentSettings.will.properties.userProperties||(this.currentSettings.will.properties.userProperties={}),this.currentSettings.will.properties.userProperties[this.willConnectUserProperty.name]=this.willConnectUserProperty.value,this.willConnectUserProperty={value:"",name:""}},removeConnectUserProperty(e){this.$delete(this.currentSettings.properties.userProperties,e),Object.keys(this.currentSettings.properties.userProperties).length||(this.currentSettings.properties.userProperties=void 0)},removeWillConnectUserProperty(e){this.$delete(this.currentSettings.will.properties.userProperties,e),Object.keys(this.currentSettings.will.properties.userProperties).length||(this.currentSettings.will.properties.userProperties=void 0)},openWindow(e,t){t=t||"auth";const s=500,i=600,r=void 0!==window.screenLeft?window.screenLeft:screen.left,o=void 0!==window.screenTop?window.screenTop:screen.top,n=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=n/2-s/2+r,c=a/2-i/2+o,p=window.open(e,t,"toolbar=no,location=no,status=yes,resizable=yes,scrollbars=yes, width="+s+", height="+i+", top="+c+", left="+l);window.focus&&p.focus()},flespiLoginHandler(){const e=t=>{if("string"===typeof t.data&&~t.data.indexOf("FlespiLogin|token:")){let s=t.data;s=s.replace("FlespiLogin|token:",""),s=JSON.parse(s),this.currentSettings.username=s.token,this.currentSettings.host=`wss://${s.region["mqtt-ws"]}`,window.removeEventListener("message",e)}};window.addEventListener("message",e),this.openWindow("https://flespi.io/login/#/providers")},validateSetting(e){return!!h()(this.validationModel,e,!1)},getValidateMessage(e){return h()(this.validationModel,e,"")},getDescription(e){return h()(this.declarations,`${e}.desc`,"")}}},Lt=Ht,zt=Object(L["a"])(Lt,At,Nt,!1,null,null,null),Rt=zt.exports;J()(zt,"components",{QDialog:Z["a"],QCard:ee["a"],QCardSection:te["a"],QToolbar:se["a"],QBtn:ne["a"],QToolbarTitle:ie["a"],QSeparator:re["a"],QInput:st["a"],QIcon:he["a"],QTooltip:be["a"],QSelect:R["a"],QCheckbox:ot["a"],QExpansionItem:rt["a"],QList:tt["a"],QItem:B["a"],QBtnToggle:z["a"],QCardActions:oe["a"]}),J()(zt,"directives",{ClosePopup:ae["a"]});var Bt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrapper__footer row no-wrap items-center justify-between bg-grey-9"},[s("q-resize-observer",{on:{resize:function(t){var s=t.width;return e.wrapperWidth=s}}}),s("div",[e.needScrollButtons?s("q-btn",{attrs:{disable:e.buttonsDisable.prev,color:"white",icon:"mdi-chevron-left",dense:"",flat:"",size:"21px"},on:{click:function(t){return e.$emit("swipe","right")}}},[s("q-tooltip",[e._v("Previous panel")])],1):e._e()],1),s("div",{staticClass:"flex relative-position"},[e.needShowMore[0]?s("q-btn",{staticClass:"wrapper__left-more",attrs:{color:"white",icon:"mdi-dots-horizontal",dense:"",flat:"",size:"10px"},on:{click:function(t){return e.$emit("swipe-to",0)}}},[s("q-tooltip",[e._v("Go to first panel")])],1):e._e(),e._l(e.shownItems,(function(t){return s("div",{key:t.queue,staticClass:"q-py-xs row inline",class:e.getItemClasses(t.queue),on:{click:function(s){return e.$emit("swipe-to",t.queue)}}},[s("q-btn",{staticClass:"q-mx-xs",attrs:{round:"",size:"4px",color:e.colors[t.type],unelevated:""}},[s("q-tooltip",{attrs:{"content-class":["bg-"+e.colors[t.type]],"max-width":"250px"}},[s("div",[s("div",{staticClass:"text-bold"},[e._v(e._s(t.type.toUpperCase()))]),t.config&&t.config.topic?s("div",{staticClass:"ellipsis"},[e._v("Topic: "+e._s(t.config.topic))]):e._e(),t.config&&t.config.payload?s("div",{staticClass:"ellipsis"},[e._v("Payload: "+e._s(t.config.payload))]):e._e()])])],1)],1)})),e.needShowMore[1]?s("q-btn",{staticClass:"wrapper__right-more",attrs:{color:"white",icon:"mdi-dots-horizontal",dense:"",flat:"",size:"10px"},on:{click:function(t){return e.$emit("swipe-to",e.entities.length-1)}}},[s("q-tooltip",[e._v("Go to last panel")])],1):e._e()],2),s("div",[e.needScrollButtons?s("q-btn",{attrs:{disable:e.buttonsDisable.next,color:"white",icon:"mdi-chevron-right",dense:"",flat:"",size:"21px"},on:{click:function(t){return e.$emit("swipe","left")}}},[s("q-tooltip",[e._v("Next panel")])],1):e._e()],1)],1)},Vt=[],Ft={props:{entities:Array,buttonsDisable:Object,active:Array},data(){return{colors:{logs:"blue",subscriber:"orange",publisher:"indigo",unresolved:"red-6"},wrapperWidth:0}},computed:{viewedItemsCount(){return Math.floor((this.wrapperWidth-96)/20)},visibleItemsRange(){const e=Math.floor((this.viewedItemsCount-(this.active[1]-this.active[0]+1))/2),t=0,s=this.entities.length-1,i=2*e+(this.active[1]-this.active[0]+1);let r=this.active[0]-e<0?0:this.active[0]-e,o=this.active[1]+e>s?s:this.active[1]+e;return r===t&&(o=i-1),o===s&&(r=s-i+1),[r,o]},shownItems(){return this.entities.reduce(((e,t,s)=>(this.visibleItemsRange[0]<=s&&this.visibleItemsRange[1]>=s&&e.push({queue:s,...t}),e)),[])},needScrollButtons(){return this.shownItems.length<this.entities.length},needShowMore(){const e=[!1,!1];return this.visibleItemsRange[0]>0&&(e[0]=!0),this.visibleItemsRange[1]<this.entities.length-1&&(e[1]=!0),e}},methods:{getItemClasses(e){const t=[];return this.active[0]<=e&&this.active[1]>=e&&t.push("item--active"),this.active[1]===e&&this.active[0]===e?t.push("item--active-all"):this.active[0]===e?t.push("item--active-left"):this.active[1]===e&&t.push("item--active-right"),t}}},Wt=Ft,Jt=(s("b2fe"),s("3980")),Xt=Object(L["a"])(Wt,Bt,Vt,!1,null,null,null),Yt=Xt.exports;J()(Xt,"components",{QResizeObserver:Jt["a"],QBtn:ne["a"],QTooltip:be["a"]});var Kt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-list",[s("q-item-label",{attrs:{header:""}},[e._v("Panes")]),s("div",{staticClass:"scroll absolute full-width",staticStyle:{height:"calc(100% - 48px)"}},e._l(e.visibleItems,(function(t,i){return s("q-item",{key:t.type+"-"+t.id,staticClass:"q-ma-xs rounded-borders",class:e.getItemClasses(t),staticStyle:{overflow:"hidden"},attrs:{active:t.rendered,clickable:""},on:{click:function(t){return e.$emit("pick",i)}}},[s("div",{staticClass:"absolute-top-left absolute-bottom-left",class:["bg-"+e.colorByType[t.type]+"-6"],staticStyle:{width:"10px"}}),s("q-item-section",[s("q-item-label",{staticClass:"q-pa-none text-bold",class:["text-"+(t.rendered?"white":e.colorByType[t.type]+"-10")],attrs:{header:""}},[e._v(e._s(e.labelByType[t.type]))]),"subscriber"===t.type||"publisher"===t.type?s("q-item-label",{staticClass:"ellipsis",class:["text-"+(t.rendered?"grey-2":e.colorByType[t.type]+"-10")],attrs:{caption:""}},[e._v(e._s(t.settings.topic))]):e._e(),"publisher"===t.type?s("q-item-label",{staticClass:"ellipsis",class:["text-"+(t.rendered?"grey-2":e.colorByType[t.type]+"-10")],attrs:{caption:""}},[s("small",[e._v(e._s(t.settings.payload))])]):e._e()],1),"subscriber"===t.type||"publisher"===t.type?s("q-item-section",{attrs:{side:""}},["publisher"===t.type?s("q-btn",{attrs:{dense:"",outline:"",color:"white",disable:!e.isValidPublisher(t.settings),icon:"mdi-send"},on:{click:function(s){return s.stopPropagation(),e.$emit("publish",t.settings)}}},[s("q-tooltip",[e._v("Publish")])],1):e._e(),"subscriber"===t.type?s("q-btn",{attrs:{dense:"",outline:"",color:"white",disable:!e.isValidSubscriber(t.settings),icon:t.status?"mdi-stop":"mdi-play"},on:{click:function(s){return s.stopPropagation(),e.$emit(t.status?"subscriber:stop":"subscriber:play",t.index)}}},[s("q-tooltip",[e._v(e._s(t.status?"Stop":"Subscribe"))])],1):e._e()],1):e._e()],1)})),1)],1)},Gt=[],Zt={props:["entities","active"],data(){return{colorByType:{subscriber:"orange",publisher:"indigo",logs:"blue",unresolved:"red"},labelByType:{subscriber:"Subscriber",publisher:"Publisher",logs:"Logs",unresolved:"Unresolved"}}},computed:{visibleItems(){let e=0;return this.entities.reduce(((t,s)=>{const i={...s};return s.rendered&&(i.visibleIndex=e,e++),t.push(i),t}),[])}},methods:{isValidPublisher(e){return!Object.keys(this.validatePublisher(e,!0)).length},isValidSubscriber(e){return!Object.keys(this.validateSubscriber(e,!0)).length},getItemClasses(e){const t=["bg-"+(e.rendered?`${this.colorByType[e.type]}-6`:"grey-13")];return(this.active[0]>e.visibleIndex||this.active[1]<e.visibleIndex||void 0===e.visibleIndex)&&t.push("q-ml-md"),t}},mixins:[We]},es=Zt,ts=Object(L["a"])(es,Kt,Gt,!1,null,null,null),ss=ts.exports;J()(ts,"components",{QList:tt["a"],QItemLabel:F["a"],QItem:B["a"],QItemSection:V["a"],QBtn:ne["a"],QTooltip:be["a"]});var is=s("2b0e");function rs(e,t,s){function i(e,s,i){const r=e.split("/");let o=i,n="";r.forEach(((e,i,r)=>{if(o[e]||is["default"].set(o,e,{children:void 0,topic:"",value:void 0}),0!==i&&(n+="/"),n+=`${e}`,is["default"].set(o[e],"topic",n),i!==r.length-1)o[e].children||is["default"].set(o[e],"children",{}),o=o[e].children;else{o[e].value||is["default"].set(o[e],"value",{});const i=s.properties&&s.properties.userProperties&&s.properties.userProperties[t]?s.properties.userProperties[t]:"";is["default"].set(o[e].value,i,s)}}))}function r(e,s,i){function r(e,t){const s=new Array(t.length).fill(void 0);return s[0]=e,t.reduce(((e,t,i,r)=>{const o={container:s[i]||null,name:t};return s[i+1]=o.container&&o.container[t]?o.container[t].children:null,o}),{container:e,name:t[0]})}const o=e.split("/");new Array(o.length).fill("").forEach(((e,n)=>{const a=o.length-n,l=o.slice(0,a),c=r(i,l);if(!c.container||!c.container[c.name])return!1;const p=c.container[c.name],d=p.children&&!!Object.keys(p.children).length;if(p.value&&0===n){const e=s.properties&&s.properties.userProperties&&s.properties.userProperties[t]?s.properties.userProperties[t]:"";is["default"].delete(p.value,e),Object.keys(p.value).length||is["default"].set(p,"value",void 0)}d||(is["default"].set(p,"children",void 0),p.value||is["default"].delete(c.container,c.name))}))}function o(e){return"string"!==typeof e.payload||e.payload.length?i:r}Array.isArray(e)?e.forEach((e=>{o(e)(e.topic,e,s)})):o(e)(e.topic,e,s)}var os=rs,ns=s("70e1"),as=s.n(ns);class ls{constructor(e){this.bus=new as.a(e)}get settings(){return this.bus.settings}set settings(e){this.bus.settings=e}get token(){return this.bus.token}set token(e){this.bus.token=e}async getDevices(e){let t="all";if(e&&"all"!==e){const s=e.join(",");try{const e=await this.bus.gw.getCalcsDevices(s,"all",{fileds:"device_id"}),i=h()(e,"data.result",[]),r=i.reduce(((e,t)=>(e[t.device_id]=!0,e)),{});t=Object.keys(r).join(",")}catch(r){return[]}}const s=await this.bus.gw.getDevices(t,{fields:"id,name"});let i=h()(s,"data.result",[]);return i=i.map((e=>({label:e.name||`#${e.id}`,value:`${e.id}`}))),i}async getChannels(){const e=await this.bus.gw.getChannels("all",{fileds:"id,name"});let t=h()(e,"data.result",[]);return t=t.map((e=>({label:e.name||`#${e.id}`,value:`${e.id}`}))),t}async getCalcs(e){let t="all";if(e&&"all"!==e)try{const s=e.join(","),i=await this.bus.gw.getCalcsDevices("all",s,{fields:"calc_id"}),r=h()(i,"data.result",[]),o=r.reduce(((e,t)=>(e[t.calc_id]=!0,e)),{});t=Object.keys(o).join(",")}catch(r){return[]}const s=await this.bus.gw.getCalcs(t,{fileds:"id,name"});let i=h()(s,"data.result",[]);return i=i.map((e=>({label:e.name||`#${e.id}`,value:`${e.id}`}))),i}async getDevicesTelemetry(e){const t=await this.bus.gw.getDevicesTelemetry(e,"all");let s=h()(t,"data.result",[]);return s=s.reduce(((e,t)=>{const s=t.telemetry;return s&&(e={...e,...s}),e}),{}),s=Object.keys(s).sort().map((e=>({label:e,value:e}))),s}async getDevicesSettings(e){const t=await this.bus.gw.getDevicesSettings(e,"all",{fields:"name,schema"});let s=h()(t,"data.result",[]);return s=s.reduce(((e,t)=>{const s=t.name,i=t.schema.title;return e[s]||(e[s]={}),e[s][i]=!0,e}),{}),s=Object.keys(s).map((e=>({label:Object.keys(s[e]).join(", "),value:e}))),s}}var cs=ls;const ps=e=>Object.keys(e).map((t=>{const s=e[t];return{appVersion:w["a"],status:s.status,config:s.config,publishers:s.publishers,subscribers:s.subscribers,entities:s.entities.filter((e=>"unresolved"!==e.type)),subscribersStatuses:s.subscribersStatuses,subscribersConnectivityStatuses:s.subscribersConnectivityStatuses}})),ds=g()((e=>{v["a"].set(us,ps(e))}),500,{trailing:!0}),us="clients",ms=!0,hs=!1,bs=null;var gs={name:"MqttClient",props:{initSettings:{type:Object},whiteLabel:{type:String,default:""},useLocalStorage:{type:Boolean,default:!0},needInitNewClient:{type:Boolean,default:!1},clientsCloseable:{type:Boolean,default:!0},secure:{type:Boolean,default:!0},color:{type:String,default:"grey-9"},accentColor:{type:String,default:"light-blue-7"},initEntities:{type:Array,default(){return[{type:"subscriber",rendered:!0,settings:u()(jt["c"])},{type:"publisher",settings:u()(jt["a"]),rendered:!0}]},validator(e){return e.reduce(((e,t,s)=>We.methods.validateEntity(t)?e&&!0:e&&!1),!0)}},configuredClients:{type:Array,default(){return[]},validator(e){let t=!0;return e.forEach((e=>{if(!e.config||!e.entities||!e.publishers||!e.subscribers)return t=!1,!1;t=t&&We.methods.validateSettings(e.config),e.entities.forEach((e=>{t=t&&We.methods.validateEntityRecord(e)})),e.publishers.forEach((e=>{t=t&&We.methods.validatePublisher(e)})),e.subscribers.forEach((e=>{t=t&&We.methods.validateSubscriber(e)}))})),t}}},data(){return{version:w["a"],drawerRight:this.$q.platform.is.desktop,clients:{},statuses:{},activeClient:null,entities:[],publishers:[],subscribers:[],subscribersStatuses:[!1],subscribersConnectivityStatuses:[!1],subscribersMessages:[[]],subscribersMessagesBuffer:[[]],settingsModalModel:!1,editedClientId:null,renderInterval:0,messagesLimitCount:3e3,notResolvedMessages:[],isNeedScroll:!1,isInited:!1,republishMessage:null,wrapperWidth:0,firstViewedPanelIndex:0,needCloseAll:!1}},computed:{renderedEntities(){const e=[];for(const t of this.entities)if(t.rendered||void 0===t.rendered){const s=t;"publisher"===t.type?s.config=this.publishers[t.index]:"subscriber"===t.type&&(s.config=this.subscribers[t.index]),e.push(s)}return e},menuEnitites(){const e=[];for(const t of this.entities){const s={...t};"subscriber"===t.type?(s.settings=this.subscribers[t.index],s.status=this.subscribersStatuses[t.index]):"publisher"===t.type&&(s.settings=this.publishers[t.index]),e.push(s)}return e},colsCount(){return this.getColsCount(this.wrapperWidth)}},methods:{openURL:f["a"],getColsCount(e){const t=350;let s=Math.floor(e/t);s=12/Math.ceil(12/s),s>this.renderedEntities.length&&(s=this.renderedEntities.length);const i=this.wrapperWidth<600?1:s;return i},closeSettingsHandler(){this.settingsModalModel=!1,this.editedClientId=null},saveSettingsHandler(e){this.createClient(e,this.editedClientId)},clearObject(e){return Object.keys(e).reduce(((t,s)=>{let i=e[s];return i instanceof Object&&!Array.isArray(i)&&(i=this.clearObject(i),Object.keys(i).length||(i=void 0)),void 0!==i&&null!==i&&(t[s]=i),t}),{})},resolveSubscription(e,t){const s=h()(t,"options.properties.subscriptionIdentifier",void 0),i=h()(e,"properties.subscriptionIdentifier",void 0);return i&&s?!!("number"===typeof i&&i===s||Array.isArray(i)&&i.includes(s)):!!this.resolveTopics(e.topic,t.topic)},resolveSubscriptions(e,t,s){return t.reduce(((t,i,r)=>(s[r]&&this.resolveSubscription(e,i)&&t.push(r),t)),[])},getSharedTopicFilter(e){return e.replace(/^\$share\/[^/]+\//,"")},resolveTopics(e,t){0===t.indexOf("$share")&&(t=this.getSharedTopicFilter(t));const s=t.split("/"),i=e.split("/");return(i.length===s.length||"#"===s[s.length-1])&&s.reduce(((e,t,s)=>"#"===t||"+"===t?e&&!0:e&&t===i[s]),!0)},errorHandler(e,t,s){const i=this.clients[e];i.logs.push({type:"error",data:{error:t},timestamp:Date.now()}),s&&this.showError(t)},showError(e){this.$q.notify({message:`<div class="text-center" style="font-size: 1.2rem;">${e.message}</div>`,html:!0,color:"negative",icon:"mdi-alert-outline",timeout:2e3})},saveClients(){if(!this.isInited)return!1;this.$emit("change",ps(this.clients)),this.useLocalStorage&&ds(this.clients)},createConnectPacket(e){return e=this.clearObject(e),5!==e.protocolVersion&&(delete e.properties,e.will&&delete e.will.properties),!e.will||e.will.topic||e.will.payload||delete e.will,e},setClientStatus(e,t){return!!this.clients[e]&&(!(this.clients[e].status===bs&&!t)&&(this.$set(this.statuses,e,t),void this.$set(this.clients[e],"status",t)))},messageProcessing(e,t){e.payload=e.payload.toString();try{e.payload=JSON.parse(e.payload)}catch(i){}const s=this.clients[t];if(s.subscribersStatuses.length&&s.subscribersStatuses.filter((e=>!!e)).length){const t=this.resolveSubscriptions(e,s.subscribers,s.subscribersStatuses),i=!!t.length;i?t.forEach((t=>{!0===s.subscribersStatuses[t]?s.subscribersMessagesBuffer[t].push(e):"paused"===s.subscribersStatuses[t]&&(void 0===s.subscribers[t].missedMessages&&(s.subscribers[t].missedMessages=0),s.subscribers[t].missedMessages++)})):(s.notResolvedFlagInit||(this.$set(s,"notResolvedFlagInit",!0),this.entities.push({type:"unresolved",rendered:!1})),s.notResolvedMessages.push(e))}else s.subscribers.filter(((t,i)=>{this.resolveSubscription(e,t)&&!s.subscribersConnectivityStatuses[i]&&(s.notResolvedFlagInit||(this.$set(s,"notResolvedFlagInit",!0),this.entities.push({type:"unresolved",rendered:!1})),s.notResolvedMessages.push(e))}))},initClient(e,t){const s=this.clients[e],i=()=>{this.setClientStatus(e,hs)},r=l.connect(t.host,t);r.on("connect",(t=>{const i=s.subscribersStatuses,r=s.subscribers,o=t.properties&&t.properties.userProperties&&t.properties.userProperties.subscriptions?JSON.parse(t.properties.userProperties.subscriptions):[];r.forEach(((t,r)=>{const n=i[r],a=o.findIndex((e=>e.topic===t.topic)),l=-1!==a;if(l&&!n)this.$set(i,r,!0);else if(!l&&n){if(0===t.mode)s.messages[r].splice(0,s.messages[r].length);else{const e=s.messages[r],t=Object.keys(e);t.forEach((t=>{this.$delete(e,t)}))}s.subscribersMessagesBuffer[r]=[],this.subscribe(e,r)}l&&o.splice(a,1)})),o.forEach((t=>{this.addSubscriber(void 0,e);const o=r.length-1,n=r[o],a={nl:t.no_local,rap:t.rap,rh:t.retain_handling,qos:t.qos,properties:{}};t.subscription_id&&(a.subscriptionIdentifier=t.subscription_id),this.$set(n,"options",a),this.$set(n,"topic",t.topic),this.$set(i,o,!0);const l=[{nl:t.no_local,rap:t.rap,rh:t.retain_handling,qos:t.qos,topic:t.topic}];this.$nextTick((()=>{s.logs.push({type:"subscribe",data:{grants:l,restored:!0},timestamp:Date.now()})}))}))})),r.on("connect",(()=>{this.setClientStatus(e,ms)})),r.on("connect",(e=>{s.logs.push({type:"connect",data:{...e},timestamp:Date.now()})})),r.once("connect",(t=>{this.$set(s,"cid",this.getCid(t)),this.$set(s,"inited",!0),this.activateRender();let i=[];s.processTimer=setInterval((()=>{i.forEach((t=>{this.messageProcessing(t,e)})),i=[]}),500),r.on("message",((e,t,s)=>{i.push(s)}))})),r.on("error",(t=>{this.errorHandler(e,t,!1)})),r.on("disconnect",(e=>{143===e.reasonCode&&s.subscribersStatuses.forEach(((e,t)=>{e&&(this.$delete(s.client._client._resubscribeTopics,s.subscribers[t].topic),this.$set(s.subscribersStatuses,t,!1),this.$set(s.subscribersConnectivityStatuses,t,!1))})),s.logs.push({type:"disconnect",data:{...e},timestamp:Date.now()}),i()})),r.on("close",(()=>{s.logs.push({type:"disconnect",timestamp:Date.now()}),i()})),r.on("offline",(()=>{this.$set(s,"inited",!1),s.logs.push({type:"offline",timestamp:Date.now()}),i()})),r.on("end",(()=>{s.logs.push({type:"end",timestamp:Date.now()}),i()})),r.on("reconnect",(()=>{this.$set(s,"inited",!0),s.logs.push({type:"reconnect",timestamp:Date.now()})})),this.$set(this.clients[e],"client",r),this.makeFlespiRestBus(e)},async createClient(e,t){const s=this.createConnectPacket(e),i="string"===typeof t||"number"===typeof t,r=i?t:Object.keys(this.clients).reduce(((e,t)=>e>parseInt(t)?e:parseInt(t)),-1)+1;if(this.clients[r]){const e=this.clients[r];e.client&&(e.processTimer&&clearInterval(e.processTimer),this.destroyClient(e.client),this.setClientStatus(r,hs)),e.logs.push({type:"updated",data:{...s},timestamp:Date.now()})}else{const e={};e.id=r,e.status=!1,this.createInitEntities(e),e.logs=[{type:"created",data:{...s},timestamp:Date.now()}],e.notResolvedMessages=[],this.clients[r]=e}this.statuses[r]!==bs&&this.initClient(r,s),this.$set(this.clients[r],"config",s),this.saveClients()},initExternalClients(e){e&&e.forEach((e=>{e=this.migrateClient(e);const t=Object.keys(this.clients).length,s={};s.config=e.config,s.id=t,s.client=null,s.status=e.status,s.publishers=e.publishers,s.subscribers=e.subscribers,s.entities=e.entities.map(((e,t)=>(void 0===e.rendered&&(e.rendered=!0),e))),"logs"!==s.entities[0].type&&s.entities.unshift({type:"logs",rendered:!0}),s.messages=new Array(e.subscribers.length),s.subscribersMessagesBuffer=new Array(e.subscribers.length);for(let i=0;i<e.subscribers.length;i++)s.messages[i]=e.subscribers[i].mode?{}:[],s.subscribersMessagesBuffer[i]=[];e.subscribersStatuses?s.subscribersStatuses=e.subscribersStatuses:(s.subscribersStatuses=new Array(e.subscribers.length),s.subscribersStatuses.fill(!1)),e.subscribersConnectivityStatuses?s.subscribersConnectivityStatuses=e.subscribersConnectivityStatuses:(s.subscribersConnectivityStatuses=new Array(e.subscribers.length),s.subscribersConnectivityStatuses.fill(!1)),s.logs=[{type:"created",data:{...e.config},timestamp:Date.now()}],s.notResolvedMessages=[],this.$set(this.statuses,t,e.status),this.$set(this.clients,t,s),e.status!==bs&&this.initClient(t,this.createConnectPacket(e.config))}))},createInitEntities(e){const t=this.initEntities;e.subscribers=[],e.publishers=[],e.entities=[],e.messages=[],e.subscribersMessagesBuffer=[],e.subscribersStatuses=[],e.subscribersConnectivityStatuses=[],e.entities.push({type:"logs",rendered:!0}),t.forEach(((t,s)=>{switch(t.type){case"subscriber":e.subscribers.push(u()(p()({},jt["c"],t.settings))),e.messages.push(t.settings.mode?{}:[]),e.subscribersMessagesBuffer.push([]),e.subscribersStatuses.push(!1),e.subscribersConnectivityStatuses.push(!1),e.entities.push({type:"subscriber",rendered:t.rendered,index:e.subscribers.length-1,id:Math.random().toString(16).substr(2,8)});break;case"publisher":e.publishers.push(u()(p()({},jt["a"],t.settings))),e.entities.push({type:"publisher",rendered:t.rendered,index:e.publishers.length-1,id:Math.random().toString(16).substr(2,8)});break;default:this.showError(new Error(`Unknown type of entity: ${t.type}`))}}))},addClientHandler(){this.settingsModalModel=!0},editClientHandler(e){this.editedClientId=e,this.settingsModalModel=!0},connectClientHandler(e){const t=this.clients[e];t.client&&(t.processTimer&&clearInterval(t.processTimer),this.destroyClient(t.client),this.setClientStatus(e,hs)),this.initClient(e,t.config),this.saveClients()},destroyClient(e){return e.removeAllListeners(["reconnect","end","offline","close","disconnect","error","message","connect"]),e.end(!0)},async disconnectClientHandler(e){const t=this.clients[e];t.processTimer&&clearInterval(t.processTimer),this.setClientStatus(e,bs),await this.destroyClient(t.client),t.client=null,this.saveClients()},deleteClientHandler(e){const t=this.clients[e];this.$q.dialog({title:"Confirm",message:`Do you really want to delete client for ${t.config.clientId}?`,cancel:!0,ok:!0}).onOk((()=>{t.processTimer&&clearInterval(t.processTimer),t.client?this.destroyClient(t.client).then((()=>{this.$delete(this.statuses,e),this.$delete(this.clients,e),this.saveClients()})):(this.$delete(this.statuses,e),this.$delete(this.clients,e),this.saveClients())})).onCancel((()=>{}))},activateRender(){this.renderInterval||(this.renderInterval=setInterval((()=>{Object.values(this.clients).forEach((e=>{e.subscribersMessagesBuffer.forEach(((t,s)=>{if(!t.length)return!1;const i=e.subscribers[s],r=e.messages[s];0===i.mode?(r&&(t=t.splice(-this.messagesLimitCount),r.splice(r.length,0,...t),r.splice(0,r.length-this.messagesLimitCount)),e.subscribersMessagesBuffer[s]=[]):e.subscribersStatuses[s]&&e.subscribersConnectivityStatuses[s]&&(os(t,5===e.config.protocolVersion&&i.treeField?i.treeField:"",r),e.subscribersMessagesBuffer[s]=[])}))}))}),500))},setActiveClient(e){const t=this.clients[e];if(!t)return this.showError("No current client"),!1;this.entities=t.entities,this.subscribers=t.subscribers,this.publishers=t.publishers,this.subscribersMessages=t.messages,this.subscribersMessagesBuffer=t.subscribersMessagesBuffer,this.notResolvedMessages=t.notResolvedMessages,this.subscribersStatuses=t.subscribersStatuses,this.subscribersConnectivityStatuses=t.subscribersConnectivityStatuses,this.activeClient=t},clearActiveClient(){this.activeClient=null,this.entities=[],this.subscribers=[],this.publishers=[],this.subscribersMessagesBuffer=[],this.notResolvedMessages=[],this.subscribersStatuses=[],this.subscribersConnectivityStatuses=[]},findEntity(e){return this.entities.findIndex((t=>e.type===t.type&&e.index===t.index))},addPublisher(e){e=p()({},jt["a"],e),this.publishers.push(u()(e));const t={type:"publisher",rendered:!0,index:this.publishers.length-1,id:Math.random().toString(16).substr(2,8)};this.activeClient.notResolvedFlagInit?this.entities.splice(-1,0,t):this.entities.push(t),this.saveClients(),this.isNeedScroll=!0},addSubscriber(e,t){t="number"===typeof t||"string"===typeof t?t:this.activeClient.id;const s=this.clients[t];e=p()({},jt["c"],e),s.subscribers.push(u()(e)),s.messages.push([]),s.subscribersMessagesBuffer.push([]),s.subscribersStatuses.push(!1),s.subscribersConnectivityStatuses.push(!1);const i={type:"subscriber",rendered:!0,index:s.subscribers.length-1,id:Math.random().toString(16).substr(2,8)};this.activeClient.notResolvedFlagInit?this.entities.splice(-1,0,i):s.entities.push(i),this.saveClients(),this.activeClient&&(this.isNeedScroll=!0)},removePublisher(e){this.publishers.splice(e,1),this.entities.splice(this.findEntity({type:"publisher",index:e}),1),this.entities.forEach((t=>{"publisher"===t.type&&t.index>e&&t.index--})),this.saveClients()},async removeSubscriber(e){const t=this.subscribersStatuses[e];t&&await this.unsubscribeMessageHandler(this.activeClient.id,e),this.subscribers.splice(e,1),this.clients[this.activeClient.id].subscribersStatuses.splice(e,1),this.subscribersConnectivityStatuses.splice(e,1),this.subscribersMessages.splice(e,1),this.entities.splice(this.findEntity({type:"subscriber",index:e}),1),this.entities.forEach((t=>{"subscriber"===t.type&&t.index>e&&t.index--})),this.saveClients()},inputSubscriber(e,t){this.$set(this.subscribers,e,t),this.saveClients()},inputPublisher(e,t){this.$set(this.publishers,e,t),this.saveClients()},async publishMessageHandler(e,t){await this.publishFreeMessage(this.publishers[t])},async publishFreeMessage(e){e=this.clearObject(e);try{await this.activeClient.client.publish(e.topic,e.payload,e.options),this.$q.notify({message:`<div class="text-center" style="font-size: 1.2rem;">Published successfuly in topic ${e.topic}</div>`,html:!0,color:"positive",timeout:700})}catch(t){this.activeClient.status?this.errorHandler(this.activeClient.id,t,!0):this.errorHandler(this.activeClient.id,new Error("Client disconnected"),!0)}},async subscribeMessageHandler(e,t){const s=this.clearObject(this.subscribers[t]);if(this.subscribers.reduce(((e,t,s)=>(this.subscribersStatuses[s]&&e.push(t.topic),e)),[]).filter((e=>e===s.topic||s.topic===this.getSharedTopicFilter(e)||e===this.getSharedTopicFilter(s.topic))).length)return this.showError(new Error("You have another subscription with same topic")),!1;this.subscribersMessages&&this.subscribersMessages.length&&this.$set(this.subscribersMessages,t,1===s.mode?{}:[]),await this.subscribe(e,t)},async subscribe(e,t){const s=this.clients[e],i=this.clearObject(s.subscribers[t]);try{this.$set(this.clients[e].subscribersStatuses,t,!0),this.$set(this.clients[e].subscribersConnectivityStatuses,t,!1);const r=await s.client.subscribe(i.topic,i.options);if(this.$set(this.clients[e].subscribersConnectivityStatuses,t,!0),r.length&&(s.logs.push({type:"subscribe",data:{settings:i,grants:r},timestamp:Date.now()}),(128&r[0].qos)>0))throw new Error(`Subscription error ${r[0].qos}`)}catch(r){this.$set(this.clients[e].subscribersStatuses,t,!1),this.$set(this.clients[e].subscribersConnectivityStatuses,t,!1),s.status?this.errorHandler(e,r,!0):this.errorHandler(e,new Error("Client disconnected"),!0)}this.saveClients()},playSubscriberHandler(e){this.$set(this.subscribers[e],"missedMessages",void 0),this.$set(this.subscribersStatuses,e,!0)},pauseSubscriberHandler(e){this.$set(this.subscribers[e],"missedMessages",0),this.$set(this.subscribersStatuses,e,"paused")},clearMessagesHandler(e){const t=this.subscribersMessages[e];t.splice(0,t.length)},async unsubscribeMessageHandler(e,t){await this.unsubscribe(e,t)},async unsubscribe(e,t){const s=this.clients[e],i=this.clearObject(s.subscribers[t]);try{s.subscribersConnectivityStatuses[t]||this.$set(s.subscribersConnectivityStatuses,t,!0),this.$set(s.subscribersStatuses,t,!1),this.$set(s.messages,t,1===i.mode?{}:[]),this.$set(s.subscribersMessagesBuffer,t,[]),await s.client.unsubscribe(i.topic,{properties:i.unsubscribeProperties}),s.logs.push({type:"unsubscribe",data:this.clearObject(i),timestamp:Date.now()}),this.$set(s.subscribersConnectivityStatuses,t,!1)}catch(r){s.status?this.errorHandler(e,r,!0):this.errorHandler(e,new Error("Client disconnected"),!0)}},sendFromSubscriberHandler(e){this.republishMessage=u()(e),this.$nextTick((()=>{this.$refs.publisherModal.show()}))},clearLogs(){const e=this.activeClient.logs;e.splice(0,e.length)},pickEntity(e){const t=this.entities[e];t.rendered||this.$set(this.entities[e],"rendered",!0),this.scrollToEntity(e)},scrollToEntity(e){if(!this.$refs.wrapper)return;const t=this.$refs.wrapper,s=this.wrapperWidth/this.colsCount,i=s*e,r=Math.abs(t.scrollLeft-i)/s*50;C.start({from:t.scrollLeft,to:i,duration:r,apply(e){t.scrollLeft=e}})},clearUnresolvedMessages(){const e=this.activeClient.notResolvedMessages;e.splice(0,e.length)},swipeHandler(e){const t=this.$refs.wrapper,s=this.wrapperWidth/this.colsCount,{direction:i}=e;let r=0;t&&"left"===i?r=t.scrollLeft+s:t&&"right"===i&&(r=t.scrollLeft-s),C.start({from:t.scrollLeft,to:r,duration:200,apply(e){t.scrollLeft=e}})},getCid(e){return h()(JSON.parse(h()(e,"properties.userProperties.token","{}")),"cid",null)},makeFlespiRestBus(e){var t;const s=this.clients[e],i=new cs({flespiApp:`mqtt-board(client: ${null===s||void 0===s||null===(t=s.config)||void 0===t?void 0:t.clientId})`});i.bus.auth.getRegions().then((t=>{t=h()(t,"data.result",[]);const r=t.reduce(((e,t)=>{const i=t["mqtt-ws"].split(":")[0];return-1!==s.config.host.indexOf(i)?t:e}));r?(i.settings={server:r.rest},i.token=s.config.username,this.$set(this.clients[e],"restBus",i)):this.$set(this.clients[e],"restBus",null)}))},onWrapperResize({width:e}){this.wrapperWidth=e;const t=this.$refs.wrapper,s=this.getColsCount(e),i=e/s,r=i*this.firstViewedPanelIndex;t.scrollLeft=r},closeAllHandler(){for(let e=this.entities.length-1;e>=0;e--){const t=this.entities[e],s=t.type,i=t.index;"subscriber"===s?this.removeSubscriber(i):"publisher"===s&&this.removePublisher(i)}}},watch:{subscribersStatuses(e){this.saveClients()}},created(){if(this.wrapperScroll=g()((e=>{if(!this.$refs.wrapper)return;const t=this.$refs.wrapper,s=this.wrapperWidth/this.colsCount;this.firstViewedPanelIndex=Math.round(t.scrollLeft/s)}),100),this.needInitNewClient&&!this.configuredClients.length&&(this.createClient(u()(p()({},jt["b"],this.initSettings))),this.setActiveClient(0)),this.configuredClients.length)this.initExternalClients(this.configuredClients);else if(this.useLocalStorage){const e=v["a"].getItem(us);this.initExternalClients(e)}this.isInited=!0,window&&window.addEventListener("beforeunload",(()=>{for(const e in this.clients){const t=this.clients[e];t.status&&(t.processTimer&&clearInterval(t.processTimer),this.destroyClient(t.client))}}))},destroyed(){for(const e in this.clients){const t=this.clients[e];t.status&&(t.processTimer&&clearInterval(t.processTimer),this.destroyClient(t.client))}},components:{ClientSettingsModal:Rt,SliderController:Yt,Subscriber:dt,Publisher:ft,Unresolved:Ct,Logs:It,PublisherModal:Et,EntitiesMenu:ss},updated(){if(this.isNeedScroll){const e=this.$refs.wrapper;C.start({from:e.scrollLeft,to:e.scrollWidth,duration:300,apply(t){e.scrollLeft=t}}),this.isNeedScroll=!1}},mixins:[We,T]},vs=gs,fs=(s("dec3"),s("4d5a")),ys=s("e359"),qs=s("9404"),xs=s("09e3"),_s=s("9989"),Ss=s("0d59"),Cs=s("12c5"),ws=Object(L["a"])(vs,i,r,!1,null,null,null);t["a"]=ws.exports;J()(ws,"components",{QLayout:fs["a"],QHeader:ys["a"],QToolbar:se["a"],QBtn:ne["a"],QToolbarTitle:ie["a"],QTooltip:be["a"],QMenu:et["a"],QList:tt["a"],QItemLabel:F["a"],QItem:B["a"],QItemSection:V["a"],QIcon:he["a"],QDrawer:qs["a"],QPageContainer:xs["a"],QPage:_s["a"],QCard:ee["a"],QCardSection:te["a"],QSeparator:re["a"],QCardActions:oe["a"],QSpinner:Ss["a"],QResizeObserver:Jt["a"],QField:gt["a"]}),J()(ws,"directives",{ClosePopup:ae["a"],Ripple:ct["a"],TouchSwipe:Cs["a"]})},fbcf:function(e,t,s){"use strict";s("b9c9")}}]);