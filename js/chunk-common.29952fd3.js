(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"049c":function(e,t,s){"use strict";var i=s("b930"),r=s.n(i);r.a},"04a0":function(e,t,s){"use strict";var i=s("f67f"),r=s.n(i);r.a},"057c":function(e,t,s){},"0a8d":function(e,t,s){"use strict";var i=s("2d67"),r=s.n(i);r.a},1:function(e,t){},2:function(e,t){},"2d67":function(e,t,s){},"2f0a":function(e,t,s){},3:function(e,t){},"3b81":function(e,t,s){"use strict";var i=s("057c"),r=s.n(i);r.a},4:function(e,t){},5:function(e,t){},"57fe":function(e,t,s){"use strict";var i=s("2f0a"),r=s.n(i);r.a},"5e04":function(e,t,s){},6:function(e,t){},"744b":function(e,t,s){"use strict";var i=s("c276"),r=s.n(i);r.a},"82c0":function(e,t,s){},"91bb":function(e,t,s){},9224:function(e){e.exports=JSON.parse('{"a":"2.4.3"}')},ab66:function(e,t,s){"use strict";var i=s("5e04"),r=s.n(i);r.a},ae0d:function(e,t,s){},b2fe:function(e,t,s){"use strict";var i=s("91bb"),r=s.n(i);r.a},b930:function(e,t,s){},c276:function(e,t,s){},d0b1:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return n}));s("6b54"),s("06db");var i={clientId:"mqtt-board-".concat(Math.random().toString(16).substr(2,8)),wsOptions:{objectMode:!1,perMessageDeflate:!0},host:"wss://mqtt.flespi.io",keepalive:420,protocolVersion:5,resubscribe:!1,clean:!0,username:"FlespiToken XXXXXXXXXXXXXXXXXXX",password:"",properties:{sessionExpiryInterval:void 0,receiveMaximum:void 0,maximumPacketSize:void 0,topicAliasMaximum:void 0,requestResponseInformation:!1,requestProblemInformation:!1,userProperties:void 0,authenticationMethod:void 0,authenticationData:void 0},will:{topic:void 0,payload:void 0,qos:0,retain:!1,properties:{willDelayInterval:void 0,payloadFormatIndicator:!1,messageExpiryInterval:void 0,contentType:void 0,responseTopic:void 0,correlationData:void 0,userProperties:void 0}}},r={topic:"#",mode:0,treeField:"",highlight:!0,options:{qos:0,nl:!1,rap:!1,rh:0,properties:{subscriptionIdentifier:void 0,userProperties:void 0}},unsubscribeProperties:{userProperties:void 0}},n={topic:"my/topic",payload:'{"hello": "world"}',options:{qos:0,retain:!1,dup:!1,properties:{payloadFormatIndicator:void 0,messageExpiryInterval:void 0,topicAlias:void 0,responseTopic:void 0,correlationData:void 0,userProperties:void 0,contentType:void 0}}}},d619:function(e,t,s){},db71:function(e,t,s){"use strict";var i=s("82c0"),r=s.n(i);r.a},db97:function(e){e.exports=JSON.parse('{"devices":{"selectors":[{"name":"devices","getter":{"name":"getDevices","params":[]},"value":{"label":"all","value":"+"}}],"children":{"state":{"topic":{"topicPattern":"flespi/state/gw/devices/${devices}/${fields}","payloadType":"string"},"selectors":[{"name":"fields","list":[{"label":"ID","value":"id"},{"label":"Name","value":"name"},{"label":"Device type ID","value":"device_type_id"},{"label":"Configuration","value":"configuration"},{"label":"Settings","value":"settings"},{"label":"Messages size","value":"messages_size"},{"label":"Messages TTL","value":"messages_ttl"},{"label":"Messages rotate","value":"messages_rotate"},{"label":"Blocked status","value":"blocked"},{"label":"Connected status","value":"connected"},{"label":"CID","value":"cid"}],"value":{"label":"all","value":"+"}}]},"messages":{"topic":{"topicPattern":"flespi/message/gw/devices/${devices}","payloadType":"JSON"}},"intervals":{"topic":{"topicPattern":"flespi/interval/gw/calcs/${calcs}/devices/${devices}/${events}","payloadType":"JSON"},"selectors":[{"name":"calcs","getter":{"name":"getCalcs","params":["devices"]},"value":{"label":"all","value":"+"}},{"name":"events","list":[{"label":"Created","value":"created"},{"label":"Updated","value":"updated"},{"label":"Deleted","value":"deleted"}],"value":{"label":"all","value":"+"}}]},"logs":{"topic":{"topicPattern":"flespi/log/gw/devices/${devices}/${event type}","payloadType":"JSON"},"selectors":[{"name":"event type","list":[{"label":"Created","value":"created"},{"label":"Updated","value":"updated"},{"label":"Deleted","value":"deleted"},{"label":"Blocked","value":"blocked"},{"label":"Unblocked","value":"unblocked"},{"label":"Connected","value":"connected"},{"label":"Disconnected","value":"disconnected"}],"value":{"label":"all","value":"+"}}]},"telemetry":{"topic":{"topicPattern":"flespi/state/gw/devices/${devices}/telemetry/${parameters}","payloadType":"string"},"selectors":[{"name":"parameters","getter":{"name":"getDevicesTelemetry","params":["devices"]},"value":{"label":"all","value":"+"}}]},"settings":{"topic":{"topicPattern":"flespi/state/gw/devices/${devices}/settings/${name}","payloadType":"JSON"},"selectors":[{"name":"name","getter":{"name":"getDevicesSettings","params":["devices"]},"value":{"label":"all","value":"+"}}]}}},"analytics":{"selectors":[{"name":"calcs","getter":{"name":"getCalcs","params":["devices"]},"value":{"label":"all","value":"+"}},{"name":"devices","getter":{"name":"getDevices","params":["calcs"]},"value":{"label":"all","value":"+"}}],"children":{"state":{"topic":{"topicPattern":"flespi/state/gw/calcs/${calcs}/devices/${devices}/${statuses}","payloadType":"JSON"},"selectors":[{"name":"statuses","list":[{"label":"Synchronization state","value":"synced"},{"label":"Last detected interval","value":"last"},{"label":"Currently active interval","value":"active"}],"value":{"label":"all","value":"+"}}]},"intervals":{"topic":{"topicPattern":"flespi/interval/gw/calcs/${calcs}/devices/${devices}/${events}","payloadType":"JSON"},"selectors":[{"name":"events","list":[{"label":"Created","value":"created"},{"label":"Updated","value":"updated"},{"label":"Deleted","value":"deleted"}],"value":{"label":"all","value":"+"}}]}}}}')},dec3:function(e,t,s){"use strict";var i=s("ae0d"),r=s.n(i);r.a},e567:function(e,t,s){"use strict";var i=function(){var e,t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"absolute-full"},[i("q-layout",{attrs:{view:"hhh LpR lff",container:""}},[i("q-header",{attrs:{reveal:""}},[i("q-toolbar",{class:(e={},e["bg-"+t.color]=!0,e["text-white"]=!!t.color,e),staticStyle:{position:"absolute","z-index":"1"}},[t.activeClient&&t.clientsCloseable?i("q-btn",{attrs:{round:"",flat:"",dense:"",icon:"mdi-close"},on:{click:t.clearActiveClient}}):t._e(),i("q-toolbar-title",[t.activeClient||""!==t.whiteLabel?t._e():i("img",{staticStyle:{height:"30px"},attrs:{src:"statics/mqttboard.png",alt:"MQTT Board"}}),t.activeClient?i("span",[t._v("\n             "+t._s(""+(t.activeClient.config.clientName||t.activeClient.config.clientId))+"\n             "),t.activeClient.config.clientName?i("q-tooltip",[t._v(t._s(""+t.activeClient.config.clientId))]):t._e()],1):i("span",[t._v("\n             "+t._s(t.whiteLabel||"MQTT Board")+"\n           ")]),t.activeClient&&t.$q.platform.is.desktop?i("sup",{staticClass:"absolute",class:["bg-"+(t.activeClient.status?"green":"red")],staticStyle:{"border-radius":"5px","font-size":".6rem",padding:"2px","min-width":"15px",top:"5px"}},[t._v(t._s(t.activeClient.status?"online":"offline"))]):t._e(),t.activeClient&&t.$q.platform.is.desktop&&t.activeClient.cid?i("sub",{staticStyle:{"border-radius":"5px","font-size":".7rem",padding:"2px"},attrs:{title:"cid"}},[t._v(t._s(t.activeClient.cid))]):t._e(),t.activeClient||""!==t.whiteLabel?t._e():i("sup",{staticStyle:{position:"relative","font-size":".9rem","padding-left":"4px"}},[t._v(t._s(t.version))])]),t.activeClient?i("q-btn",{attrs:{round:"",flat:"",dark:"",icon:"mdi-settings"},on:{click:function(e){return e.stopPropagation(),t.editClientHandler(t.activeClient.id)}}}):t._e(),t.activeClient?i("q-btn",{attrs:{round:"",flat:"",icon:"mdi-plus"}},[i("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[i("q-list",[i("q-item-label",{attrs:{header:""}},[t._v("Add pane")]),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.addPublisher()}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"mdi-publish"}})],1),i("q-item-section",[i("q-item-label",[t._v("Publisher")])],1)],1),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.addSubscriber()}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"mdi-arrow-down-bold"}})],1),i("q-item-section",[i("q-item-label",[t._v("Subscriber")])],1)],1)],1)],1)],1):t._e(),t.activeClient?i("q-btn",{attrs:{round:"",flat:"",dark:"",icon:"mdi-menu"},on:{click:function(e){e.stopPropagation(),t.drawerRight=!t.drawerRight}}}):t._e(),t.activeClient||t.whiteLabel?t._e():i("q-btn",{staticStyle:{"margin-right":"60px"},attrs:{dense:"",flat:"",color:"white",icon:"mdi-github-circle",label:t.$q.platform.is.mobile?"":"Fork me!"},on:{click:function(e){return t.openURL("https://github.com/flespi-software/MQTT-Board")}}})],1),t.activeClient?t._e():i("q-btn",{staticStyle:{position:"absolute",right:"16px",top:"21px","z-index":"2"},attrs:{fab:"",icon:"mdi-plus",color:t.accentColor},nativeOn:{click:function(e){return t.addClientHandler(e)}}})],1),t.activeClient?i("q-drawer",{attrs:{side:"right",bordered:"",breakpoint:500,"content-class":"bg-grey-3 absolute"},model:{value:t.drawerRight,callback:function(e){t.drawerRight=e},expression:"drawerRight"}},[i("entities-menu",{staticClass:"full-width relative-position",staticStyle:{height:"calc(100% - 98px)",top:"50px"},attrs:{entities:t.menuEnitites,active:[t.firstViewedPanelIndex,t.firstViewedPanelIndex+t.colsCount-1]},on:{pick:t.pickEntity,"subscriber:play":function(e){return t.subscribeMessageHandler(t.activeClient.id,e)},"subscriber:stop":function(e){return t.unsubscribeMessageHandler(t.activeClient.id,e)},publish:t.publishFreeMessage}}),i("q-btn",{staticClass:"absolute-bottom",staticStyle:{bottom:"7px",left:"4px",width:"calc(100% - 8px)"},attrs:{color:"red",disable:!t.subscribers.length&&!t.publishers.length,unelevated:"",label:"remove all"},on:{click:t.closeAllHandler}})],1):t._e(),i("q-page-container",[i("q-page",[i("div",[t.republishMessage?i("publisher-modal",{ref:"publisherModal",attrs:{message:t.republishMessage,version:t.activeClient.config.protocolVersion},on:{publish:t.publishFreeMessage,hide:function(e){t.republishMessage=null}}}):t._e(),t.settingsModalModel?i("client-settings-modal",{attrs:{color:t.color,secure:t.secure,settings:null!==t.editedClientId?t.clients[t.editedClientId].config:{},initSettings:t.initSettings},on:{save:t.saveSettingsHandler,close:t.closeSettingsHandler}}):t._e(),t.activeClient?t.renderedEntities.length?i("div",[i("div",{directives:[{name:"touch-swipe",rawName:"v-touch-swipe.horizontal",value:t.swipeHandler,expression:"swipeHandler",modifiers:{horizontal:!0}}],ref:"wrapper",staticClass:"no-wrap row client__wrapper",on:{scroll:t.wrapperScroll}},[i("q-resize-observer",{attrs:{debounce:0},on:{resize:t.onWrapperResize}}),t._l(t.renderedEntities,(function(e,s){return["publisher"===e.type?i("publisher",{key:"publ"+e.id,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{value:t.publishers[e.index],version:t.activeClient.config.protocolVersion},on:{input:function(s){t.inputPublisher(e.index,s)},remove:function(s){return t.removePublisher(e.index)},publish:function(s){return t.publishMessageHandler(t.activeClient.id,e.index)},hide:function(s){return t.$set(e,"rendered",!1)}}}):"subscriber"===e.type?i("subscriber",{key:"subs"+e.id,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{value:t.subscribers[e.index],status:t.subscribersStatuses[e.index],subscribed:t.subscribersConnectivityStatuses[e.index],messages:t.subscribersMessages[e.index],client:t.activeClient},on:{input:function(s){t.inputSubscriber(e.index,s)},remove:function(s){return t.removeSubscriber(e.index)},subscribe:function(s){return t.subscribeMessageHandler(t.activeClient.id,e.index)},unsubscribe:function(s){return t.unsubscribeMessageHandler(t.activeClient.id,e.index)},play:function(s){return t.playSubscriberHandler(e.index)},pause:function(s){return t.pauseSubscriberHandler(e.index)},clear:function(s){return t.clearMessagesHandler(e.index)},"action-send":t.sendFromSubscriberHandler,hide:function(s){return t.$set(e,"rendered",!1)}}}):"unresolved"===e.type?i("unresolved",{key:"unresolved"+s,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{messages:t.notResolvedMessages},on:{clear:t.clearUnresolvedMessages,hide:function(s){return t.$set(e,"rendered",!1)}}}):"logs"===e.type?i("logs",{key:"subs"+s,ref:"entities",refInFor:!0,class:["col-"+12/t.colsCount],attrs:{logs:t.activeClient.logs},on:{clear:t.clearLogs,hide:function(s){return t.$set(e,"rendered",!1)}}}):t._e()]}))],2),i("slider-controller",{attrs:{entities:t.renderedEntities,"buttons-disable":{prev:0===t.firstViewedPanelIndex,next:t.entities.length-t.colsCount===t.firstViewedPanelIndex},active:[t.firstViewedPanelIndex,t.firstViewedPanelIndex+t.colsCount-1]},on:{swipe:function(e){return t.swipeHandler({direction:e})},"swipe-to":t.scrollToEntity}})],1):t.renderedEntities.length?t.statuses[t.activeClient.id]?t._e():i("div",{staticClass:"text-center q-mt-lg text-grey-9 text-weight-bold absolute",staticStyle:{"font-size":"2.5rem",top:"50px",bottom:"0",left:"0",right:"0"}},[i("div",[t._v("Ð¡lient is disconnected")])]):i("div",{staticClass:"text-center q-mt-lg text-grey-9 text-weight-bold absolute",staticStyle:{"font-size":"2.5rem",top:"50px",bottom:"0",left:"0",right:"0"}},[t._v("No active entities")]):i("div",{staticClass:"absolute scroll",staticStyle:{top:"50px",left:"0",right:"0",bottom:"0"}},[Object.keys(t.clients).length?i("div",{staticClass:"mqtt-clients row q-pt-md"},t._l(t.clients,(function(e,s){return i("div",{key:s,staticClass:"client__item q-pt-md q-px-md cursor-pointer col-xl-3 col-md-4 col-sm-6 col-xs-12"},[i("q-card",{class:{"bg-red-2":!t.statuses[s],"bg-green-2":t.statuses[s]},nativeOn:{click:function(e){return t.setActiveClient(s)}}},[i("q-card-section",{staticClass:"q-py-sm"},[i("div",{staticClass:"ellipsis q-mb-xs",staticStyle:{"font-size":"18px","line-height":"18px","min-height":"18px"}},[t._v(t._s(e.config.clientName||e.config.clientId))]),i("div",{staticClass:"ellipsis text-grey-9",staticStyle:{"font-size":"14px","line-height":"14px","min-height":"14px"}},[t._v(t._s(e.config.clientName?e.config.clientId:""))]),i("div",{staticClass:"text-grey-9 q-mt-sm"},[t._v(t._s(e.config.host))])]),i("q-separator"),i("q-card-actions",{attrs:{align:"right"}},[e.client?i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-stop",loading:!!e.client&&!t.statuses[s]&&e.inited},on:{click:function(e){return e.stopPropagation(),t.disconnectClientHandler(s)}}},[i("div",{attrs:{slot:"loading"},on:{click:function(e){e.stopPropagation()}},slot:"loading"},[i("q-spinner")],1),i("q-tooltip",[t._v("Deactivate client")])],1):i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-play"},on:{click:function(e){return e.stopPropagation(),t.connectClientHandler(s)}}},[i("q-tooltip",[t._v("Activate client")])],1),i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-settings"},on:{click:function(e){return e.stopPropagation(),t.editClientHandler(s)}}}),i("q-btn",{attrs:{round:"",flat:"",size:".7rem",icon:"mdi-delete"},on:{click:function(e){return e.stopPropagation(),t.deleteClientHandler(s)}}})],1)],1)],1)})),0):i("div",{staticClass:"text-center q-mt-lg text-grey-9 text-weight-bold",staticStyle:{"font-size":"2.5rem"}},[i("div",[t._v("No clients")]),t.activeClient?t._e():i("q-btn",{nativeOn:{click:function(e){return t.addClientHandler(e)}}},[t._v("Create client")])],1)])],1)])],1)],1)],1)},r=[],n=(s("8e6e"),s("ac4d"),s("8a81"),s("5df3"),s("1c4c"),s("7f7f"),s("4db1")),o=s.n(n),a=(s("8615"),s("6c7b"),s("967e")),l=s.n(a),c=(s("96cf"),s("fa84")),p=s.n(c),u=(s("20d6"),s("6b54"),s("28a5"),s("a481"),s("6762"),s("2fdb"),s("c47a")),d=s.n(u),b=(s("ac6a"),s("cadf"),s("06db"),s("456d"),s("551c"),s("fc74")),m=s.n(b),f=s("59a1"),h=s.n(f),g=s("e7fc"),v=s.n(g),y=function(){function e(t){m()(this,e),this._client=t}return h()(e,[{key:"publish",value:function(){for(var e=this,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return new Promise((function(t,i){var r;(r=e._client).publish.apply(r,s.concat([function(e,s){e?i(e):t(s)}]))}))}},{key:"subscribe",value:function(){for(var e=this,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return new Promise((function(t,i){var r;(r=e._client).subscribe.apply(r,s.concat([function(e,s){e?i(e):t(s)}]))}))}},{key:"unsubscribe",value:function(){for(var e=this,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return new Promise((function(t,i){var r;(r=e._client).unsubscribe.apply(r,s.concat([function(e,s){e?i(e):t(s)}]))}))}},{key:"end",value:function(){for(var e=this,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return new Promise((function(t,i){var r;(r=e._client).end.apply(r,s.concat([function(e,s){e?i(e):t(s)}]))}))}},{key:"reconnect",value:function(){var e;return(e=this._client).reconnect.apply(e,arguments)}},{key:"addListener",value:function(){var e;return(e=this._client).addListener.apply(e,arguments)}},{key:"emit",value:function(){var e;return(e=this._client).emit.apply(e,arguments)}},{key:"eventNames",value:function(){var e;return(e=this._client).eventNames.apply(e,arguments)}},{key:"getLastMessageId",value:function(){var e;return(e=this._client).getLastMessageId.apply(e,arguments)}},{key:"getMaxListeners",value:function(){var e;return(e=this._client).getMaxListeners.apply(e,arguments)}},{key:"listenerCount",value:function(){var e;return(e=this._client).listenerCount.apply(e,arguments)}},{key:"listeners",value:function(){var e;return(e=this._client).listeners.apply(e,arguments)}},{key:"off",value:function(){var e;return(e=this._client).off.apply(e,arguments)}},{key:"on",value:function(){var e;return(e=this._client).on.apply(e,arguments)}},{key:"once",value:function(){var e;return(e=this._client).once.apply(e,arguments)}},{key:"prependListener",value:function(){var e;return(e=this._client).prependListener.apply(e,arguments)}},{key:"prependOnceListener",value:function(){var e;return(e=this._client).prependOnceListener.apply(e,arguments)}},{key:"rawListeners",value:function(){var e;return(e=this._client).rawListeners.apply(e,arguments)}},{key:"removeAllListeners",value:function(){var e;return(e=this._client).removeAllListeners.apply(e,arguments)}},{key:"removeListener",value:function(){var e;return(e=this._client).removeListener.apply(e,arguments)}},{key:"removeOutgoingMessage",value:function(){var e;return(e=this._client).removeOutgoingMessage.apply(e,arguments)}},{key:"setMaxListeners",value:function(){var e;return(e=this._client).setMaxListeners.apply(e,arguments)}},{key:"handleMessage",set:function(e){this._client.handleMessage=e},get:function(){return this._client.handleMessage}},{key:"connected",get:function(){return this._client.connected}},{key:"reconnecting",get:function(){return this._client.reconnecting}}]),e}(),q={connect:function(e,t){var s=v.a.connect(e,t),i=new y(s);return i},connectAsync:function(e,t){var s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=v.a.connect(e,t),r=new y(i);return new Promise((function(e,t){var n={connect:function(t){o(),e(r)},end:function(){o(),e(r)},error:function(e){o(),i.end(),t(e)}};!1===s&&(n.close=function(){n.error("Couldn't connect to server")});var o=function(){Object.keys(n).forEach((function(e){i.removeListener(e,n[e])}))};Object.keys(n).forEach((function(e){i.on(e,n[e])}))}))},AsyncClient:y},x=s("42454"),C=s.n(x),S=s("0644"),w=s.n(S),_=s("9b02"),k=s.n(_),P=s("b047c"),$=s.n(P),O=s("18d6"),M=s("b06b"),I=s("1732"),U=function(e){return e},T={};function j(e){var t=e.name,s=e.duration,i=void 0===s?300:s,r=e.to,n=e.from,o=e.apply,a=e.done,l=e.cancel,c=e.easing,p=t,u=new Date;p?E(p):p=Object(I["a"])();var d=c||U,b=function e(){var t=(new Date-u)/i;t>1&&(t=1);var s=n+(r-n)*d(t);if(o(s,t),1===t)return delete T[p],void(a&&a(s));m.last={pos:s,progress:t},m.timer=requestAnimationFrame(e)},m=T[p]={cancel:l,timer:requestAnimationFrame(b)};return p}function E(e){if(e){var t=T[e];t&&t.timer&&(cancelAnimationFrame(t.timer),t.cancel&&t.cancel(t.last),delete T[e])}}var A={start:j,stop:E},N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__subscriber"},[e.status||null!==e.isPlayed?s("q-card",{staticClass:"subscriber__item q-ma-sm"},[e.filterMode?s("q-input",{staticClass:"q-ma-sm q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Filter by topic",autofocus:""},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-btn",{attrs:{slot:"prepend",color:"grey-9",icon:"mdi-arrow-left",flat:"",round:""},on:{click:function(t){e.filterMode=!1,e.filter=""}},slot:"prepend"}),e.filter?s("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-close",flat:"",round:""},on:{click:function(t){e.filter=""}},slot:"append"}):e._e()],1):s("q-toolbar",{staticClass:"q-pr-none text-white bg-orange",staticStyle:{"border-top-right-radius":"0","border-top-left-radius":"0"}},[s("q-toolbar-title",{staticStyle:{width:"calc(100% - 150px)"}},[s("span",[e._v("\n          "+e._s(e.config.topic)+"\n          "),s("q-tooltip",[e._v(e._s(e.config.topic))])],1)]),0===e.config.mode?s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-magnify"},on:{click:function(t){e.filterMode=!0}}}):e._e(),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-stop",title:"Unsubscribe"},on:{click:function(t){return e.unsubscribeMessageHandler()}}}),s("q-btn",{attrs:{round:"",flat:"",icon:e.isPlayed&&"paused"!==e.status?"mdi-pause":"mdi-play",title:e.isPlayed&&"paused"!==e.status?"Pause":"Resume"},on:{click:e.playStopHandler}},["paused"===e.status&&e.value.missedMessages?s("q-chip",{staticClass:"absolute-top-right",staticStyle:{top:"-5px",right:"-5px"},attrs:{color:"red",dense:"","text-color":"white",size:".6rem",square:""}},[e._v("\n          "+e._s(e.value.missedMessages)+"\n        ")]):e._e()],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[0===e.config.mode?s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},nativeOn:{click:function(t){return e.clearMessagesHandler(t)}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-playlist-remove"}})],1),s("q-item-section",[s("q-item-label",[e._v("Clear messages")])],1)],1):e._e(),0===e.config.mode?s("q-separator",{attrs:{spaced:""}}):e._e(),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{highlight:"",clickable:""},nativeOn:{click:function(t){return e.removeSubscriber()}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"mdi-delete-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Remove")])],1)],1)],1)],1)],1)],1),s("div",{staticStyle:{position:"relative"},style:{height:"calc(100% - "+(e.filterMode?"62px":"50px")+")"}},[e.messages&&e.messages.length&&0===e.config.mode?s("virtual-list",{directives:[{name:"autoscroll",rawName:"v-autoscroll",value:e.needAutoScroll,expression:"needAutoScroll"}],ref:"scroller",staticClass:"subscriber__list",attrs:{onscroll:e.listScroll,size:110,remain:15,item:e.Message,itemcount:e.renderedMessages.length,itemprops:e.getMessageProps}}):1===e.config.mode&&Object.keys(e.renderedMessages).length&&e.subscribed?s("div",{staticClass:"subscriber__list subscriber__list--tree"},[s("div",{staticClass:"scroll",staticStyle:{height:"60%"}},[s("tree",{attrs:{topic:e.treeSelectedTopic,data:e.renderedMessages},on:{change:e.treeValueChangeHandler}})],1),s("div",{staticClass:"scroll tree__message"},[e._l(e.treeModeValue,(function(t,i,r){return["undefined"!==typeof t.payload?s("message",{key:"tree-message-"+i+"-"+r,attrs:{message:t,highlight:e.config.highlight},on:{"action-send":function(t){e.$emit("action-send",t)}}}):s("div",{key:"tree-message-empty-"+r,staticClass:"text-center",staticStyle:{height:"100%"}},[s("div",{staticClass:"q-pt-sm text-grey-9",staticStyle:{"font-size":"1.5rem"}},[e._v("No messages")]),s("div",{staticClass:"text-grey-8"},[e._v(e._s(t.topic))]),s("q-icon",{attrs:{color:"red",name:"mail",size:"5rem"}})],1)]}))],2)]):e.status&&e.subscribed&&!e.processingFlag?s("div",{staticClass:"subscriber__list--empty"},[e._v("No messages")]):e._e(),s("q-inner-loading",{attrs:{showing:e.isNeedLoading}},[s("q-spinner-gears",{attrs:{size:"150px",color:"orange"}})],1)],1)],1):s("q-card",{staticClass:"subscriber__item q-ma-sm"},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none text-white bg-orange"},[s("q-toolbar-title",[e._v("Subscriber")]),s("q-btn",{attrs:{round:"",flat:"",disable:!e.isValidSubscriber,icon:"mdi-play"},on:{click:e.subscribeMessageHandler}},[s("q-tooltip",[e._v("Subscribe")])],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide pannel")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.removeSubscriber()}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"mdi-delete-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Remove")])],1)],1)],1)],1)],1)],1)],1),s("q-card-section",{staticClass:"item__main q-py-none"},[s("div",{staticClass:"q-pt-md"},[s("q-input",{staticClass:"q-mb-xs",attrs:{disable:e.status,color:"grey-9",outlined:"","hide-bottom-space":"",label:"Topic",error:!e.isValidSubscriber,"reactive-rules":"","no-error-icon":"",rules:[function(t){return-1===t.indexOf(",")||-1!==t.indexOf(",")&&e.config.options.properties.subscriptionIdentifier||"You need to set up subscription identifier in the properties below"}]},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}},[0===e.config.topic.indexOf("$share")?s("q-btn",{attrs:{slot:"append",color:"yellow-9",icon:"mdi-alert",flat:"",round:""},on:{click:e.showSharedSubscriptionNotification},slot:"append"}):e._e(),e.isFlespiMode?s("q-btn",{attrs:{slot:"append",color:"red-9",icon:"icon-flespi2-02-01",flat:"",round:""},on:{click:function(t){e.flespiTopicOpened=!0}},slot:"append"},[s("q-tooltip",[e._v("Flespi topic generator")])],1):e._e()],1),s("q-btn-toggle",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mt-md",staticStyle:{width:"100%"},attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:e.modeSelectOptions},on:{input:e.changeModeHandler},model:{value:e.config.mode,callback:function(t){e.$set(e.config,"mode",t)},expression:"config.mode"}}),1===e.config.mode&&5===e.version?s("q-input",{staticClass:"q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Field to group by",hint:"User properties field name by which messages will be grouped."},model:{value:e.config.treeField,callback:function(t){e.$set(e.config,"treeField",t)},expression:"config.treeField"}}):e._e(),s("q-toggle",{staticClass:"q-my-md",attrs:{color:"grey-9",label:"Highlight messages content"},model:{value:e.config.highlight,callback:function(t){e.$set(e.config,"highlight",t)},expression:"config.highlight"}}),s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{value:!0,label:"Options"}},[s("div",{staticClass:"q-pa-sm"},[s("div",{staticClass:"q-px-md q-py-sm"},[e._v("\n              QoS\n              "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{disable:e.status,flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.qos,callback:function(t){e.$set(e.config.options,"qos",t)},expression:"config.options.qos"}})],1),5===e.version?s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{disable:e.status,color:"grey-9",label:"No local"},model:{value:e.config.options.nl,callback:function(t){e.$set(e.config.options,"nl",t)},expression:"config.options.nl"}}):e._e(),5===e.version?s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{disable:e.status,color:"grey-9",label:"Retain as Published"},model:{value:e.config.options.rap,callback:function(t){e.$set(e.config.options,"rap",t)},expression:"config.options.rap"}}):e._e(),5===e.version?s("div",[s("div",{staticClass:"q-mb-sm"},[e._v("\n                Retain handling\n                "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{disable:e.status,flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.rh,callback:function(t){e.$set(e.config.options,"rh",t)},expression:"config.options.rh"}})],1)]):e._e(),5===e.version?s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-4",attrs:{label:"Properties"}},[s("div",{staticClass:"q-px-md q-py-sm"},[s("q-input",{staticClass:"q-my-xs",attrs:{disable:e.status,color:"grey-9",label:"Subscription identifier",clearable:"",type:"number",outlined:"","hide-bottom-space":"",error:!e.isNil(e.config.options.properties.subscriptionIdentifier)&&(e.config.options.properties.subscriptionIdentifier<=0||e.config.options.properties.subscriptionIdentifier>268435455)},on:{clear:function(t){e.config.options.properties.subscriptionIdentifier=void 0}},model:{value:e.config.options.properties.subscriptionIdentifier,callback:function(t){e.$set(e.config.options.properties,"subscriptionIdentifier",e._n(t))},expression:"config.options.properties.subscriptionIdentifier"}}),!e.status||e.config.options.properties.userProperties?s("div",[s("div",{staticClass:"q-mt-md"},[e._v("User Properties")]),s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Also use to unsubscribe"},model:{value:e.needUseSubUserPropsToUnsub,callback:function(t){e.needUseSubUserPropsToUnsub=t},expression:"needUseSubUserPropsToUnsub"}}),s("div",[e.config.options.properties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.options.properties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[e.status?e._e():s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removeSubscriberUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{outlined:"","hide-bottom-space":"",color:"grey-9",label:"User property name"},model:{value:e.subscriberUserProperty.name,callback:function(t){e.$set(e.subscriberUserProperty,"name",t)},expression:"subscriberUserProperty.name"}}),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{outlined:"","hide-bottom-space":"",color:"grey-9",label:"User property value"},model:{value:e.subscriberUserProperty.value,callback:function(t){e.$set(e.subscriberUserProperty,"value",t)},expression:"subscriberUserProperty.value"}}),e.status?e._e():s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.subscriberUserProperty.name||!e.subscriberUserProperty.value,color:"grey-9"},on:{click:e.addSubscriberUserProperty}},[e._v("Add")])],1)],1):e._e()],1)]):e._e(),5!==e.version||e.needUseSubUserPropsToUnsub?e._e():s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-4",attrs:{value:!!e.config.unsubscribeProperties.userProperties,label:"Unsubscribe properties"}},[!e.status||e.config.unsubscribeProperties.userProperties?s("div",{staticClass:"q-px-md q-py-sm"},[s("div",{staticClass:"q-mt-md"},[e._v("User Properties")]),s("div",[e.config.unsubscribeProperties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.unsubscribeProperties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[e.status?e._e():s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removeUnsubscribeUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property name"},model:{value:e.unsubscribeUserProperty.name,callback:function(t){e.$set(e.unsubscribeUserProperty,"name",t)},expression:"unsubscribeUserProperty.name"}}),e.status?e._e():s("q-input",{staticClass:"q-my-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property value"},model:{value:e.unsubscribeUserProperty.value,callback:function(t){e.$set(e.unsubscribeUserProperty,"value",t)},expression:"unsubscribeUserProperty.value"}}),e.status?e._e():s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.unsubscribeUserProperty.name||!e.unsubscribeUserProperty.value,color:"grey-9"},on:{click:e.addUnsubscribeUserProperty}},[e._v("Add")])],1)]):e._e()])],1)])],1)])],1),e.flespiTopicOpened?s("flespi-topic-configurator",{ref:"ftopic",attrs:{opened:e.flespiTopicOpened,color:"orange",bus:e.client.restBus},on:{close:function(t){e.flespiTopicOpened=!1}},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}}):e._e()],1)},H=[],D=(s("f751"),function(){var e,t,s=this,i=s.$createElement,r=s._self._c||i;return r("q-dialog",{attrs:{"content-class":"mqtt-board__popup",maximized:s.$q.platform.is.mobile},model:{value:s.opened,callback:function(e){s.opened=e},expression:"opened"}},[r("q-card",{style:{minWidth:s.$q.platform.is.mobile?"100%":"30vw"}},[r("q-card-section",{staticClass:"q-pa-none"},[r("q-toolbar",{class:(e={},e["bg-"+s.color]=!0,e["text-white"]=!!s.color,e)},[r("q-toolbar-title",[s._v("\n          Flespi topic generator\n        ")])],1)],1),r("q-separator"),r("q-card-section",{staticClass:"scroll",style:{height:s.$q.platform.is.mobile?"calc(100% - 96px)":""}},[r("flespi-selector",{attrs:{value:this.currentTopic,connector:s.bus,theme:{color:"orange"}},on:{input:s.update}})],1),r("q-separator"),r("q-card-actions",{class:(t={},t["bg-"+s.color]=!0,t["text-white"]=!!s.color,t),attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:""},on:{click:function(e){return s.$emit("close")}}},[s._v("Close")]),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:""},on:{click:s.saveSettingsHandler}},[s._v("Save")])],1)],1)],1)}),L=[],z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.$q.platform.is.desktop?s("q-btn-toggle",{staticClass:"q-mb-md",attrs:{options:e.options,spread:"",unelevated:"","toggle-color":e.cTheme.color},model:{value:e.entity,callback:function(t){e.entity=t},expression:"entity"}}):s("q-select",{staticClass:"q-mb-md",attrs:{options:e.options,"emit-value":"","map-options":"",outlined:"",dense:"",color:e.cTheme.color},model:{value:e.entity,callback:function(t){e.entity=t},expression:"entity"}}),s("div",{staticClass:"relative-position"},[e.entity?e._e():s("div",{staticClass:"selectors__settings-splash"}),e.renderConfig.selectors?e._l(e.renderConfig.selectors,(function(t){return s("div",{key:e.entity+"-"+t.name},[s("q-select",{staticClass:"q-mb-md",attrs:{value:e.model[t.name],options:e.renderLists[t.name],"emit-value":"","map-options":"",multiple:"",clearable:"","use-input":"","use-chips":"",outlined:"",dense:"",color:e.cTheme.color,label:e.model[t.name]?t.name:"All "+t.name},on:{input:function(s){return e.update(t.name,s)},filter:function(s,i){return e.filterItems(t,s,i)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",[s("div",{staticClass:"text-italic text-grey-9 text-h6 text-center text-bold"},[e._v(e._s("No "+t.name))]),s("div",{staticClass:"text-grey text-center"},[e._v("Maybe you need to clean another related selectors")])])],1)]},proxy:!0},{key:"option",fn:function(t){return[s("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[s("q-item-section",[s("q-item-label",{domProps:{innerHTML:e._s(t.opt.label||"*Empty*")}}),s("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.opt.value))])],1)],1)]}}],null,!0)})],1)})):e._e(),e.renderConfig.children?[s("flespi-selectors",{key:e.entity,attrs:{value:e.value,config:e.renderConfig.children,connector:e.connector,entities:e.model,theme:e.cTheme},on:{input:e.updateModel}})]:e._e()],2)],1)},R=[],F=(s("3b2b"),s("db97"));function B(e,t){var s;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(s=V(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,a=!1;return{s:function(){s=e[Symbol.iterator]()},n:function(){var e=s.next();return o=e.done,e},e:function(e){a=!0,n=e},f:function(){try{o||null==s.return||s.return()}finally{if(a)throw n}}}}function V(e,t){if(e){if("string"===typeof e)return W(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?W(e,t):void 0}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}function J(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function X(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?J(Object(s),!0).forEach((function(t){d()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):J(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Q={name:"FlespiSelectors",props:{config:{type:Object,default:function(){return F}},connector:Object,entities:{type:Object,default:function(){return{}}},value:String,theme:Object,default:function(){return{color:"grey-9",bgColor:"white"}}},data:function(){var e=void 0,t={},s={},i="";return{entity:e,lists:s,renderLists:X({},s),model:t,topic:i,cTheme:X({color:"grey-9",bgColor:"white"},this.theme)}},computed:{options:function(){return Object.keys(this.config).map((function(e){return{label:e,value:e}}))},entitiesNames:function(){return Object.keys(this.config)},renderConfig:function(){return this.entity?this.config[this.entity]:this.config[this.entitiesNames[0]]}},methods:{initByEntity:function(e){var t=this.config[e].selectors,s={},i={};return t&&t.forEach((function(e){e.value&&(i[e.name]=null),e.list?(s[e.name]=e.list,s[e.name].inited=!0):(s[e.name]=[],s[e.name].inited=!1)})),{lists:s,model:i}},filterItems:function(e,t,s){var i,r=this;if(this.lists[e.name].inited)return this.$set(this.renderLists,e.name,t?this.lists[e.name].filter((function(e){return e.label.toLowerCase().indexOf(t.toLowerCase())>-1})):this.lists[e.name]),void s();(i=this.connector)[e.getter.name].apply(i,o()(e.getter.params.map((function(e){return r.model[e]||"all"})))).then((function(i){r.$set(r.lists,e.name,i),r.$set(r.renderLists,e.name,t?r.lists[e.name].filter((function(e){return e.label.toLowerCase().indexOf(t.toLowerCase())>-1})):r.lists[e.name]),r.lists[e.name].inited=!0,s()}))},update:function(e,t){var s=this;this.$set(this.model,e,t&&t.length?t:null),this.entity&&this.config[this.entity].selectors&&this.config[this.entity].selectors.forEach((function(t){t.getter&&t.getter.params&&t.getter.params.includes(e)&&(s.$set(s.lists,t.name,[]),s.$set(s.renderLists,t.name,[]))})),this.$emit("input",this.getCurrentTopic(this.topic,this.model))},updateModel:function(e){this.topic=e,this.$emit("input",this.getCurrentTopic(this.topic,this.model))},getCurrentTopic:function(e,t){var s=e&&e.topicPattern;if(e&&this.entity&&this.config[this.entity].selectors){var i=this.config[this.entity].selectors.map((function(e){return e.name}));s=i.reduce((function(e,s){var i=s,r=t[i];return void 0!==r&&(e=r&&r.length?e.replace("${".concat(i,"}"),r):e.replace("${".concat(i,"}"),"+")),e}),s)}return X(X({},e),{},{topicPattern:s})},topicToModelHandler:function(e){function t(e){var s=[];for(var i in e){var r=e[i],n=[i],a=r.topic&&r.topic.topicPattern;if(r.children){var l,c=t(r.children),p=B(c);try{for(p.s();!(l=p.n()).done;){var u=l.value;s.push({path:[].concat(n,o()(u.path)),topic:u.topic})}}catch(d){p.e(d)}finally{p.f()}}else s.push({path:n,topic:a})}return s}var s,i=t(this.config),r=i.filter((function(t){t.path;var s=t.topic;return s=new RegExp(s.replace(/\$\{\w+\}/g,".*")),s.test(e)})),n=r.pop();if(n){s={path:n.path,values:{}};var a=n.topic.split("/"),l=e.split("/");a.forEach((function(e,t){e.replace(/\$\{(\w+)\}/,(function(e,i){var r=l[t];s.values[i]="+"===r?null:r.split(",")}))}))}return s},setModel:function(e){if(!e)return!1;var t=this.initByEntity(e.path[0]),s=t.lists,i=t.model;this.entity=e.path[0],this.lists=s,this.model=Object.assign(i,e.values),this.topic=this.config[e.path[0]].topic,this.topic&&this.$emit("input",this.getCurrentTopic(this.topic,this.model))},changeEntity:function(e){var t=this.initByEntity(e),s=t.lists,i=t.model;this.lists=s,this.model=X(X({},i),this.entities),this.topic=this.config[e].topic,this.topic&&this.$emit("input",this.getCurrentTopic(this.topic,this.model))}},created:function(){this.setModel(this.topicToModelHandler(this.value));var e=this.getCurrentTopic(this.topic,this.model);this.$watch("entity",this.changeEntity),e&&this.$emit("input",e)},watch:{entities:{deep:!0,handler:function(e){if(this.model=X(X({},this.model),e),this.entity){var t=this.initByEntity(this.entity),s=t.lists;this.lists=s}}}}},Y=Q,K=(s("049c"),s("2877")),G=Object(K["a"])(Y,z,R,!1,null,null,null),Z=G.exports,ee={name:"FlespiTopicConfigurator",props:{color:{type:String,default:"grey-9"},value:String,bus:Object,opened:Boolean},data:function(){return{currentTopic:this.value}},methods:{saveSettingsHandler:function(){this.$emit("input",this.currentTopic),this.$emit("close")},update:function(e){var t=e.topicPattern;t&&(this.currentTopic=t)}},components:{FlespiSelector:Z}},te=ee,se=Object(K["a"])(te,D,L,!1,null,null,null),ie=se.exports,re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{"user-select":"none"},style:e.$q.platform.is.desktop?{display:"inline-block",minWidth:"100%"}:[]},[e._l(e.limitedKeys,(function(t,i){return[s("div",{key:""+t,staticClass:"cursor-pointer",class:{"bg-grey-2":e.topic&&e.topic===e.data[t].topic},style:{paddingLeft:10*e.nesting+(e.data[t].children?0:14)+"px",display:e.$q.platform.is.desktop?"inline-block":"",minWidth:e.$q.platform.is.desktop?"100%":"",overflow:e.$q.platform.is.desktop?"":"hidden",textOverflow:e.$q.platform.is.desktop?"":"ellipsis"},on:{click:function(s){return e.toggle(t,i)}}},[e.data[t].children?[e.showObj[t]?s("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:"grey-9",name:"mdi-menu-down"}}):s("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:"grey-9",name:"mdi-menu-right"}})]:e._e(),s("span",{class:{"text-grey-9":!0,"text-italic":!t,"text-grey-10":e.data[t].value,"text-bold":e.data[t].value}},[e._v(e._s(t||"*Empty*"))])],2),e.showObj[t]&&e.data[t].children?s("tree-mode-view",{key:"nest-"+t,attrs:{nesting:e.nesting+1,topic:e.topic,data:e.data[t].children},on:{change:function(t){e.$emit("change",t)}}}):e._e()]})),e.keys.length>e.limitedKeys.length?s("div",{staticClass:"more-button cursor-pointer text-bold",staticStyle:{display:"inline-block"},style:{marginLeft:10*e.nesting+14+"px"},on:{click:function(t){e.limit+=1e3}}},[e._v("\n    more "+e._s(e.keys.length-e.limit>=1e3?1e3:e.keys.length-e.limit)+"\n  ")]):e._e()],2)},ne=[],oe=(s("c5f6"),{name:"TreeModeView",props:{data:Object,topic:String,nesting:{type:Number,default:0}},data:function(){for(var e={},t=Object.keys(this.data),s=t.length,i=0,r=s;i<r;i++)e[t[i]]=!1;return{showObj:e,limit:1e4}},computed:{keys:function(){return Object.keys(this.data).sort((function(e,t){if(e=e.toLowerCase(),t=t.toLowerCase(),e!==t){var s=Number(e),i=Number(t);return s+""===e&&i+""===t?s-i:e>t?1:-1}}))},limitedKeys:function(){return this.keys.slice(0,this.limit)}},methods:{toggle:function(e,t){this.$set(this.showObj,e,!this.showObj[e]),this.$emit("change",this.data[e].topic)}}}),ae=oe,le=(s("fbcf"),Object(K["a"])(ae,re,ne,!1,null,null,null)),ce=le.exports,pe=s("89c1"),ue=s.n(pe),de=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-card",{staticClass:"message q-my-sm q-mx-sm"},[s("div",{staticClass:"message__title q-pt-sm q-pl-sm q-pr-sm"},[s("div",{staticClass:"message__topic ellipsis",attrs:{title:e.message.topic}},[e._v("\n      "+e._s(e.message.topic)+"\n    ")]),s("div",{staticClass:"message__sys text-grey-7"},[e._v("\n      "+e._s("qos: "+e.message.qos+", dup: "+(e.message.dup?"+":"-")+", retain: "+(e.message.retain?"+":"-")+e.timestamp)+"\n    ")]),s("q-btn",{staticClass:"absolute-top-right",staticStyle:{top:"10px",right:"8px",transform:"rotate(-45deg)"},attrs:{color:"indigo-4",size:"sm",flat:"",icon:"mdi-send",round:""},on:{click:function(t){return e.$emit("action-send",e.message)}}},[s("q-tooltip",{staticClass:"desktop-only"},[e._v("Resend message")])],1)],1),s("div",{staticClass:"message__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2 relative-position"},["string"!==typeof e.payload||e.payload.length?e.highlight?s("json-tree",{attrs:{data:e.payload}}):e.highlight?e._e():s("div",{staticClass:"message__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2"},[e._v(e._s(e.message.payload))]):s("div",[e._v("No message")]),e.canCopy?s("q-btn",{staticStyle:{position:"absolute",right:"0",bottom:"2px"},attrs:{icon:"content_copy",size:"0.7rem",flat:"",color:"orange"},on:{click:e.copyPayloadHandler}}):e._e()],1),s("div",{staticClass:"message__properties q-pa-sm text-grey-7"},[e._v(e._s(JSON.stringify(e.message.properties)))])])},be=[],me=s("bd4c"),fe=s("cdde"),he=function(){var e,t=this,s=t.$createElement,i=t._self._c||s;return t.data&&(Array.isArray(t.data)||"object"===typeof t.data)?i("div",[i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(t._s(Array.isArray(t.data)?"[":"{"))]),t._l(t.data,(function(e,s,r){var n;return i("div",{key:s+"-"+r,staticClass:"margin-left"},[e&&"object"===typeof e?i("div",[i("div",{staticClass:"cursor-pointer",on:{click:function(e){t.toggle(Array.isArray(t.data)?s:r)}}},[t.showObj[Array.isArray(t.data)?s:r]?i("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:void 0!==t.inverted?"white":"grey-9",name:"mdi-menu-down"}}):i("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:void 0!==t.inverted?"white":"grey-9",name:"mdi-menu-right"}}),i("span",{class:[t.theme.label]},[t._v(t._s(s))]),i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(" : "+t._s(Array.isArray(e)?"Array ["+e.length+"]":"Object"))])],1),t.showObj[Array.isArray(t.data)?s:r]?i("json-tree",{staticClass:"margin-left",attrs:{data:e,inverted:t.inverted}}):t._e()],1):i("div",[i("span",{class:[t.theme.label]},[t._v(t._s(s))]),i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(" : ")]),i("span",{class:(n={},n[t.theme.typeNumberOrBool]="number"===typeof e||"boolean"===typeof e,n[t.theme.typeString]="string"===typeof e,n[t.theme.typeEmpty]="undefined"===typeof e||null===e,n)},[t._v(t._s(JSON.stringify(e)))])])])})),i("span",{class:{"text-white":void 0!==t.inverted}},[t._v(t._s(Array.isArray(t.data)?"]":"}"))])],2):i("div",[i("span",{class:(e={},e[t.theme.typeNumberOrBool]="number"===typeof t.data||"boolean"===typeof t.data,e[t.theme.typeString]="string"===typeof t.data,e[t.theme.typeEmpty]="undefined"===typeof t.data||null===t.data,e),staticStyle:{"font-size":"1rem"}},[t._v(t._s(""+t.data))])])},ge=[],ve={name:"JsonTree",props:{data:{requered:!0},inverted:function(){return!0}},data:function(){for(var e=[],t=this.data?Object.keys(this.data).length:0,s=0,i=t;s<i;s++)e.push(!0);return{showObj:e}},computed:{theme:function(){return void 0!==this.inverted?{label:"text-pink-4",typeString:"text-red-3",typeNumberOrBool:"text-blue-3",typeEmpty:"text-grey-5"}:{label:"text-pink-8",typeString:"text-red-6",typeNumberOrBool:"text-blue-6",typeEmpty:"text-grey-6"}}},methods:{toggle:function(e){this.$set(this.showObj,e,!this.showObj[e])}}},ye=ve,qe=(s("ab66"),Object(K["a"])(ye,he,ge,!1,null,null,null)),xe=qe.exports,Ce={name:"Message",props:["message","highlight"],computed:{canCopy:function(){return!("string"===typeof this.payload&&!this.payload.length)&&!!fe["a"]},payload:function(){return this.message.payload},timestamp:function(){return this.message.properties&&this.message.properties.userProperties&&this.message.properties.userProperties.timestamp?", ".concat(me["a"].formatDate(1e3*this.message.properties.userProperties.timestamp,"DD/MM/YYYY HH:mm:ss")):""}},methods:{copyPayloadHandler:function(){var e=this;Object(fe["a"])("string"===typeof this.payload?this.payload:JSON.stringify(this.payload)).then((function(t){e.$q.notify({color:"positive",icon:"content_copy",message:'<div class="text-center" style="font-size: 1.2rem;">Payload copied</div>',html:!0,timeout:1e3})}),(function(t){e.$q.notify({color:"negative",icon:"content_copy",message:'<div class="text-center" style="font-size: 1.2rem;">Coping error</div>',html:!0,timeout:1e3})}))}},components:{JsonTree:xe}},Se=Ce,we=(s("04a0"),Object(K["a"])(Se,de,be,!1,null,"299524db",null)),_e=we.exports,ke={methods:{validateTopic:function(e){for(var t=e.split("/"),s=0;s<t.length;s++)if("+"!==t[s]){if("#"===t[s])return s===t.length-1;if(-1!==t[s].indexOf("+")||-1!==t[s].indexOf("#"))return!1}return!0}}},Pe=s("2768"),$e=s.n(Pe),Oe=0,Me=1,Ie={name:"Subscriber",props:["value","messages","status","client","subscribed"],data:function(){return{version:this.client.config.protocolVersion,filterMode:!1,config:this.value,loadingStatus:!1,needUseSubUserPropsToUnsub:!1,subscriberUserProperty:{value:"",name:""},unsubscribeUserProperty:{value:"",name:""},modeSelectOptions:[{label:"History",value:Oe},{label:"Tree",value:Me}],needAutoScroll:!0,isPlayed:this.status||null,filter:"",treeSelectedTopic:null,processingFlag:null,Message:_e,flespiTopicOpened:!1}},computed:{isFlespiMode:function(){return this.client.config.host.indexOf("flespi")>-1},renderedMessages:function(){var e=this,t=[];switch(this.config.mode){case Oe:t=this.filter?this.messages.filter((function(t){return-1!==t.topic.indexOf(e.filter)})):this.messages;break;case Me:t=this.messages;break}return t},treeModeValue:function(){var e=this,t=null;if(this.config.mode===Me){if(null===this.treeSelectedTopic)return{"":{topic:"*Empty*"}};var s=this.treeSelectedTopic.split("/");t=s.reduce((function(t,i,r){return r===s.length-1?t[i]?t[i].value&&Object.keys(t[i].value).reduce((function(e,s){return e[s]=JSON.parse(t[i].value[s]),e}),{}):(e.treeValueChangeHandler(null),{"":{topic:"*Empty*"}}):t[i].children}),this.messages),t&&Object.keys(t).length||(t={"":{topic:this.treeSelectedTopic}})}return t},isValidSubscriber:function(){return!!this.config.topic&&(-1===this.config.topic.indexOf(",")||-1!==this.config.topic.indexOf(",")&&this.config.options.properties.subscriptionIdentifier)&&this.validateTopic(this.config.topic)&&($e()(this.config.options.properties.subscriptionIdentifier)||this.config.options.properties.subscriptionIdentifier>0&&this.config.options.properties.subscriptionIdentifier<=268435455)},isNeedLoading:function(){return 1===this.config.mode&&this.status&&this.subscribed&&null===this.processingFlag&&this.checkProcessing(),1===this.config.mode&&this.status&&(!this.subscribed||!!this.processingFlag)}},methods:{isNil:$e.a,checkProcessing:function(){var e=this;Object.keys(this.messages).length||(this.processingFlag=!0,setTimeout((function(){e.processingFlag=!1}),500))},getMessageProps:function(e){var t=this,s={key:"subMsg$".concat(e),props:{highlight:this.config.highlight,message:this.renderedMessages[e]},on:{"action-send":function(e){t.$emit("action-send",e)}}};return s},playStopHandler:function(){this.isPlayed?this.$emit("pause"):this.$emit("play"),this.isPlayed=!this.isPlayed},subscribeMessageHandler:function(){this.loadingStatus=!0,this.needUseSubUserPropsToUnsub&&this.$set(this.config.unsubscribeProperties,"userProperties",Object.assign({},this.config.options.properties.userProperties)),this.$emit("subscribe")},unsubscribeMessageHandler:function(e,t){this.isPlayed=null,this.treeSelectedTopic=null,this.clearScrollParams(),this.$emit("unsubscribe"),this.processingFlag=null},removeSubscriber:function(e){this.$emit("remove")},addSubscriberUserProperty:function(){this.config.options.properties.userProperties||this.$set(this.config.options.properties,"userProperties",{}),this.$set(this.config.options.properties.userProperties,this.subscriberUserProperty.name,this.subscriberUserProperty.value),this.subscriberUserProperty={value:"",name:""}},removeSubscriberUserProperty:function(e){this.$delete(this.config.options.properties.userProperties,e),Object.keys(this.config.options.properties.userProperties).length||this.$set(this.config.options.properties,"userProperties",null)},addUnsubscribeUserProperty:function(){this.config.unsubscribeProperties.userProperties||this.$set(this.config.unsubscribeProperties,"userProperties",{}),this.$set(this.config.unsubscribeProperties.userProperties,this.unsubscribeUserProperty.name,this.unsubscribeUserProperty.value),this.unsubscribeUserProperty={value:"",name:""}},removeUnsubscribeUserProperty:function(e){this.$delete(this.config.unsubscribeProperties.userProperties,e),Object.keys(this.config.unsubscribeProperties.userProperties).length||this.$set(this.config.unsubscribeProperties,"userProperties",null)},showSharedSubscriptionNotification:function(){this.$q.dialog({title:"Shared subscription info",message:"You are trying to subscribe to a Shared Subscription. Publication that matches its Topic Filter is sent to one of the subscribed sessions only.",color:"primary",ok:!0,preventClose:!0})},listScroll:function(e){if(this.status){var t=this.$refs.scroller&&this.$refs.scroller.$el;if(!t)return!1;t.scrollTop<t.scrollHeight-t.clientHeight?this.needAutoScroll=!1:this.needAutoScroll=!0}},clearScrollParams:function(){this.currentScrollTop=0,this.allScrollTop=0,this.needAutoScroll=!0},clearMessagesHandler:function(){this.$emit("clear")},treeValueChangeHandler:function(e){this.treeSelectedTopic=e},changeModeHandler:function(){this.treeSelectedTopic=null}},watch:{config:{deep:!0,handler:function(e){this.$emit("input",e)}},status:function(e){e&&this.loadingStatus?(this.loadingStatus=!1,this.isPlayed=!0):e||(this.isPlayed=null)},value:{deep:!0,handler:function(e){this.config=e}}},components:{VirtualList:ue.a,Tree:ce,Message:_e,FlespiTopicConfigurator:ie},directives:{autoscroll:{inserted:function(e,t){var s=t.value;s&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated:function(e,t){var s=t.value;setTimeout((function(){s&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),50)}}},mixins:[ke]},Ue=Ie,Te=(s("db71"),Object(K["a"])(Ue,N,H,!1,null,null,null)),je=Te.exports,Ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__publisher"},[s("q-card",{staticClass:"publisher__item q-ma-sm"},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none text-white bg-indigo"},[s("q-toolbar-title",[e._v("Publisher")]),s("q-btn",{attrs:{round:"",disable:!e.isValidPublisher,flat:"",icon:"mdi-send"},on:{click:function(t){return e.$emit("publish")}}},[s("q-tooltip",[e._v("Publish")])],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide pannel")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("remove")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"mdi-delete-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Remove")])],1)],1)],1)],1)],1)],1)],1),s("q-card-section",{staticClass:"publisher__main q-pb-none"},[s("div",[s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Topic",error:!e.isValidPublisher,outlined:"","hide-bottom-space":""},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}}),s("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",autogrow:"",type:"textarea",label:"Message"},model:{value:e.config.payload,callback:function(t){e.$set(e.config,"payload",t)},expression:"config.payload"}}),s("q-expansion-item",{staticClass:"q-my-sm bg-grey-2",attrs:{value:!0,label:"Options"}},[s("div",{staticClass:"q-pa-sm"},[s("div",{staticClass:"q-px-md q-py-sm"},[s("div",{staticClass:"q-mb-sm"},[e._v("\n                QoS\n                "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.qos,callback:function(t){e.$set(e.config.options,"qos",t)},expression:"config.options.qos"}})],1)]),s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Retain"},model:{value:e.config.options.retain,callback:function(t){e.$set(e.config.options,"retain",t)},expression:"config.options.retain"}}),s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Duplicate flag"},model:{value:e.config.options.dup,callback:function(t){e.$set(e.config.options,"dup",t)},expression:"config.options.dup"}}),5===e.version?s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-4",attrs:{label:"Properties"}},[s("div",{staticClass:"q-px-md q-py-sm"},[s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",attrs:{color:"grey-9",label:"Payload format indicator"},model:{value:e.config.options.properties.payloadFormatIndicator,callback:function(t){e.$set(e.config.options.properties,"payloadFormatIndicator",t)},expression:"config.options.properties.payloadFormatIndicator"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Message expiry interval",clearable:"",outlined:"","hide-bottom-space":"",error:!e.isNil(e.config.options.properties.messageExpiryInterval)&&(e.config.options.properties.messageExpiryInterval<0||e.config.options.properties.messageExpiryInterval>4294967295)},on:{clear:function(t){e.config.options.properties.messageExpiryInterval=void 0}},model:{value:e.config.options.properties.messageExpiryInterval,callback:function(t){e.$set(e.config.options.properties,"messageExpiryInterval",e._n(t))},expression:"config.options.properties.messageExpiryInterval"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Topic alias",clearable:"",outlined:"","hide-bottom-space":"",error:!e.isNil(e.config.options.properties.topicAlias)&&(e.config.options.properties.topicAlias<=0||e.config.options.properties.topicAlias>65535)},on:{clear:function(t){e.config.options.properties.topicAlias=void 0}},model:{value:e.config.options.properties.topicAlias,callback:function(t){e.$set(e.config.options.properties,"topicAlias",e._n(t))},expression:"config.options.properties.topicAlias"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Response topic",outlined:"","hide-bottom-space":""},model:{value:e.config.options.properties.responseTopic,callback:function(t){e.$set(e.config.options.properties,"responseTopic",t)},expression:"config.options.properties.responseTopic"}}),s("q-input",{staticClass:"q-textarea--fix q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"textarea",autogrow:"",label:"Correlation data"},model:{value:e.config.options.properties.correlationData,callback:function(t){e.$set(e.config.options.properties,"correlationData",t)},expression:"config.options.properties.correlationData"}}),s("div",{staticClass:"q-mb-sm"},[s("div",{staticClass:"q-mt-md"},[e._v("User Properties")]),s("div",[e.config.options.properties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.options.properties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removePublishUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property name"},model:{value:e.publishUserProperty.name,callback:function(t){e.$set(e.publishUserProperty,"name",t)},expression:"publishUserProperty.name"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property value"},model:{value:e.publishUserProperty.value,callback:function(t){e.$set(e.publishUserProperty,"value",t)},expression:"publishUserProperty.value"}}),s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.publishUserProperty.name||!e.publishUserProperty.value,color:"grey-9"},on:{click:function(t){return e.addPublishUserProperty()}}},[e._v("Add")])],1)]),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Content type"},model:{value:e.config.options.properties.contentType,callback:function(t){e.$set(e.config.options.properties,"contentType",t)},expression:"config.options.properties.contentType"}})],1)]):e._e()],1)])],1)])],1)],1)},Ae=[],Ne={name:"Publisher",props:["value","version"],data:function(){return{config:this.value,publishUserProperty:{value:"",name:""}}},computed:{isValidPublisher:function(){return!!this.config.topic&&this.validateTopic(this.config.topic)&&($e()(this.config.options.properties.messageExpiryInterval)||this.config.options.properties.messageExpiryInterval>=0&&this.config.options.properties.messageExpiryInterval<=4294967295)&&($e()(this.config.options.properties.topicAlias)||this.config.options.properties.topicAlias>0&&this.config.options.properties.topicAlias<=65535)}},methods:{isNil:$e.a,addPublishUserProperty:function(){this.config.options.properties.userProperties||this.$set(this.config.options.properties,"userProperties",{});var e=this.config.options.properties.userProperties;e[this.publishUserProperty.name]?Array.isArray(e[this.publishUserProperty.name])?e[this.publishUserProperty.name].push(this.publishUserProperty.value):this.$set(e,this.publishUserProperty.name,[e[this.publishUserProperty.name],this.publishUserProperty.value]):this.$set(e,this.publishUserProperty.name,this.publishUserProperty.value),this.publishUserProperty={value:"",name:""}},removePublishUserProperty:function(e){this.$delete(this.config.options.properties.userProperties,e),Object.keys(this.config.options.properties.userProperties).length||this.$set(this.config.options.properties,"userProperties",null)}},watch:{config:{deep:!0,handler:function(e){this.$emit("input",e)}},value:{deep:!0,handler:function(e){this.config=e}}},mixins:[ke]},He=Ne,De=(s("57fe"),Object(K["a"])(He,Ee,Ae,!1,null,null,null)),Le=De.exports,ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__not-resolved-msgs"},[s("q-card",{staticClass:"not-resolved-msgs__main q-ma-sm"},[s("q-card-section",{staticClass:"q-pa-none"},[e.filterMode?s("q-input",{staticClass:"q-ma-sm q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Filter by topic",autofocus:""},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-btn",{attrs:{slot:"prepend",color:"grey-9",icon:"mdi-arrow-left",flat:"",round:""},on:{click:function(t){e.filterMode=!1,e.filter=""}},slot:"prepend"}),e.filter?s("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-close",flat:"",round:""},on:{click:function(t){e.filter=""}},slot:"append"}):e._e()],1):s("q-toolbar",{staticClass:"q-pr-none text-white bg-red-6"},[s("q-toolbar-title",[e._v("Unresolved messages")]),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-magnify"},on:{click:function(t){e.filterMode=!0}}}),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide pannel")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.clearMessagesHandler}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-playlist-remove"}})],1),s("q-item-section",[s("q-item-label",[e._v("Clear messages")])],1)],1)],1)],1)],1)],1)],1),s("virtual-list",{directives:[{name:"autoscroll",rawName:"v-autoscroll",value:e.needAutoScroll,expression:"needAutoScroll"}],ref:"scroller",staticClass:"not-resolved-msgs__list",attrs:{size:110,remain:15,onscroll:e.listScroll}},e._l(e.filteredNotResolvedMessages,(function(e,t){return s("message",{key:"subNRMsg"+t,attrs:{message:e}})})),1)],1)],1)},Re=[],Fe={name:"Unresolved",props:["messages"],data:function(){return{filter:"",needAutoScroll:!0,filterMode:!1}},computed:{filteredNotResolvedMessages:function(){var e=this;return this.messages.filter((function(t){return-1!==t.topic.indexOf(e.filter)}))}},methods:{listScroll:function(e,t){var s=this.$refs.scroller&&this.$refs.scroller.$el;if(!s)return!1;s.scrollTop<s.scrollHeight-s.clientHeight?this.needAutoScroll=!1:this.needAutoScroll=!0},clearMessagesHandler:function(){this.$emit("clear")}},components:{VirtualList:ue.a,Message:_e},directives:{autoscroll:{inserted:function(e,t){var s=t.value;s&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated:function(e,t){var s=t.value;setTimeout((function(){s&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),50)}}}},Be=Fe,Ve=(s("744b"),Object(K["a"])(Be,ze,Re,!1,null,null,null)),We=Ve.exports,Je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mqtt-client__logs"},[s("q-card",{staticClass:"logs__wrapper q-ma-sm",staticStyle:{overflow:"hidden"}},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none text-white bg-blue"},[s("q-toolbar-title",[e._v("Logs")]),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"}},[s("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"mqtt-board__popup"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.clearLogsHandler}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-playlist-remove"}})],1),s("q-item-section",[s("q-item-label",[e._v("Clear logs")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"},{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("hide")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"mdi-eye-off-outline"}})],1),s("q-item-section",[s("q-item-label",[e._v("Hide pannel")])],1)],1)],1)],1)],1)],1)],1),s("q-card-section",{directives:[{name:"autoscroll",rawName:"v-autoscroll",value:e.needAutoScroll,expression:"needAutoScroll"}],ref:"scroller",staticClass:"scroll q-pa-none",staticStyle:{height:"calc(100% - 50px)"},nativeOn:{scroll:function(t){return e.listScroll(t)}}},e._l(e.logs,(function(t,i){return s("q-card",{key:"log"+i,staticClass:"log__item q-ma-sm",class:["bg-"+e.getColor(t)+"-3"]},[s("div",{staticClass:"log__title q-py-xs q-px-sm text-bold"},[e._v("\n          "+e._s(t.type)+"\n        ")]),"offline"===t.type||"reconnect"===t.type||"end"===t.type?[s("div",{staticClass:"log__payload q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}})]:"disconnect"===t.type?[t.data?s("div",{staticClass:"log__payload q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[e._v("\n            disconnected by broker:\n            "),s("div",[e._v(e._s(t.data.reasonCode+": "+e.codes[t.data.reasonCode]))])]):e._e()]:"created"===t.type||"updated"===t.type?[s("div",{staticClass:"log__payload q-px-sm q-pt-xs q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticClass:"q-ma-none",staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[s("json-tree",{attrs:{data:t.data}})],1)])]:"connect"===t.type?[e.codes[t.data.returnCode]||e.codes[t.data.reasonCode]?s("div",{staticClass:"log__payload q-px-sm q-py-xs q-mr-xs q-ml-xs bg-grey-2"},[e._v("\n            "+e._s(e.codes[t.data.returnCode]||e.codes[t.data.reasonCode])+"\n          ")]):e._e(),t.data.properties?s("div",{staticClass:"log__properties q-pt-xs q-mr-xs q-ml-xs text-grey-7 bg-green-1",staticStyle:{"font-size":".75rem","word-break":"break-all"}},[s("json-tree",{attrs:{data:t.data.properties}})],1):e._e()]:"error"===t.type?[s("div",{staticClass:"log__payload q-px-sm q-py-xs q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticClass:"q-ma-none",staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(t.data.error.message))])])]:"subscribe"===t.type?[s("div",{staticClass:"log__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2 row",staticStyle:{"font-size":".75rem"}},[t.data.restored?e._e():s("div",{staticClass:"col-6 q-pr-xs"},[s("div",{staticClass:"text-bold"},[e._v("Request")]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.settings.topic))]),s("div",[s("span",{staticClass:"text-bold"},[e._v("QoS: ")]),e._v(e._s(t.data.settings.options.qos))]),void 0!==t.data.settings.options.nl?s("div",[s("span",{staticClass:"text-bold"},[e._v("No Local: ")]),e._v(e._s(t.data.settings.options.nl))]):e._e(),void 0!==t.data.settings.options.rap?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain as Published: ")]),e._v(e._s(t.data.settings.options.rap))]):e._e(),void 0!==t.data.settings.options.rh?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain handling: ")]),e._v(e._s(t.data.settings.options.rh))]):e._e()]),t.data.grants[0]&&0===(128&t.data.grants[0].qos)?s("div",{staticClass:"col-6 q-pl-xs"},[t.data.restored?s("div",{staticClass:"col-6 q-pr-xs text-bold"},[e._v("Access (restored by broker)")]):s("div",{staticClass:"col-6 q-pr-xs text-bold"},[e._v("Access")]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.grants[0].topic))]),s("div",[s("span",{staticClass:"text-bold"},[e._v("QoS: ")]),e._v(e._s(t.data.grants[0].qos))]),void 0!==t.data.grants[0].nl?s("div",[s("span",{staticClass:"text-bold"},[e._v("No Local: ")]),e._v(e._s(t.data.grants[0].nl))]):e._e(),void 0!==t.data.grants[0].rap?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain as Published: ")]),e._v(e._s(t.data.grants[0].rap))]):e._e(),void 0!==t.data.grants[0].rh?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain handling: ")]),e._v(e._s(t.data.grants[0].rh))]):e._e()]):e._e(),t.data.grants[0]&&(128&t.data.grants[0].qos)>0?s("div",[s("div",{staticClass:"col-6 q-pr-xs text-bold"},[e._v("Error")]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.grants[0].topic))]),s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Message: ")]),e._v(e._s(e.codes[t.data.grants[0].qos]))])]):e._e()])]:"unsubscribe"===t.type?[s("div",{staticClass:"log__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticStyle:{"word-break":"break-all"}},[s("span",{staticClass:"text-bold"},[e._v("Topic: ")]),e._v(e._s(t.data.topic))]),s("div",[s("span",{staticClass:"text-bold"},[e._v("QoS: ")]),e._v(e._s(t.data.options.qos))]),void 0!==t.data.options.nl?s("div",[s("span",{staticClass:"text-bold"},[e._v("No Local: ")]),e._v(e._s(t.data.options.nl))]):e._e(),void 0!==t.data.options.rap?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain as Published: ")]),e._v(e._s(t.data.options.rap))]):e._e(),void 0!==t.data.options.rh?s("div",[s("span",{staticClass:"text-bold"},[e._v("Retain handling: ")]),e._v(e._s(t.data.options.rh))]):e._e()])]:[s("div",{staticClass:"log__payload q-pa-sm q-mr-xs q-ml-xs bg-grey-2",staticStyle:{"font-size":".75rem"}},[s("div",{staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(t.data))])])],s("div",{staticClass:"log__timestamp q-py-xs q-px-sm text-grey-7"},[e._v(e._s(e.date.formatDate(t.timestamp,"DD/MM/YYYY HH:mm:ss")))])],2)})),1)],1)],1)},Xe=[],Qe={name:"Logs",props:["logs"],data:function(){return{needAutoScroll:!0,colors:{connect:"green",error:"red",offline:"grey",reconnect:"yellow",subscribe:"orange",unsubscribe:"purple",disconnect:"red",end:"grey",created:"green",updated:"yellow"},date:me["a"],codes:{0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"}}},methods:{getColor:function(e){return"connect"===e.type&&(this.codes[e.data.returnCode]||this.codes[e.data.reasonCode])?"red":"subscribe"===e.type&&e.data.restored?"blue":"subscribe"===e.type&&e.data.grants&&(128&e.data.grants[0].qos)>0?"red":"disconnect"===e.type&&e.data?"brown":this.colors[e.type]},listScroll:function(e){var t=this.$refs.scroller.$el;t.scrollTop<t.scrollHeight-t.clientHeight?this.needAutoScroll=!1:this.needAutoScroll=!0},clearScrollParams:function(){this.currentScrollTop=0,this.allScrollTop=0,this.needAutoScroll=!0},clearLogsHandler:function(){this.$emit("clear")}},created:function(){var e=this;this.$nextTick((function(){if(e.needAutoScroll&&e.$refs.scroller){var t=e.$refs.scroller.$el;t.scrollTop=t.scrollHeight-t.clientHeight}}))},directives:{autoscroll:{inserted:function(e,t){var s=t.value;s&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated:function(e,t){var s=t.value;setTimeout((function(){s&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),50)}}},components:{JsonTree:xe}},Ye=Qe,Ke=(s("3b81"),Object(K["a"])(Ye,Je,Xe,!1,null,null,null)),Ge=Ke.exports,Ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"modal",attrs:{"content-class":"mqtt-board__popup",maximized:e.$q.platform.is.mobile},on:{show:function(t){return e.$emit("show")},hide:function(t){return e.$emit("hide")}}},[s("q-card",{style:{width:e.$q.platform.is.mobile?"100%":"50vw"}},[s("q-card-section",{staticClass:"q-pa-none"},[s("q-toolbar",{staticClass:"q-pr-none bg-indigo text-white"},[s("q-toolbar-title",[e._v("Publisher")]),s("q-btn",{attrs:{round:"",disable:!e.isValidPublisher,flat:"",icon:"mdi-send"},on:{click:function(t){e.$emit("publish",e.config),e.hide()}}},[s("q-tooltip",[e._v("Publish")])],1),s("q-btn",{attrs:{round:"",flat:"",icon:"mdi-close"},on:{click:e.hide}})],1)],1),s("q-separator"),s("q-card-section",{staticClass:"scroll q-pa-none",style:{height:e.$q.platform.is.mobile?"calc(100% - 50px)":"70vh"}},[s("div",{staticClass:"mqtt-client__publisher"},[s("div",{staticClass:"q-pa-md"},[s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Topic",error:!e.isValidPublisher},model:{value:e.config.topic,callback:function(t){e.$set(e.config,"topic",t)},expression:"config.topic"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",autogrow:"",type:"textarea q-textarea--fix",label:"Message"},model:{value:e.config.payload,callback:function(t){e.$set(e.config,"payload",t)},expression:"config.payload"}}),s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{value:!0,label:"Options"}},[s("div",{staticClass:"q-pa-sm"},[s("div",{staticClass:"q-px-md q-py-sm"},[s("div",{staticClass:"q-mb-sm"},[e._v("\n                  QoS\n                  "),s("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:e.config.options.qos,callback:function(t){e.$set(e.config.options,"qos",t)},expression:"config.options.qos"}})],1)]),s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Retain"},model:{value:e.config.options.retain,callback:function(t){e.$set(e.config.options,"retain",t)},expression:"config.options.retain"}}),s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Duplicate flag"},model:{value:e.config.options.dup,callback:function(t){e.$set(e.config.options,"dup",t)},expression:"config.options.dup"}}),5===e.version?s("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-4",attrs:{label:"Properties",value:!0}},[s("div",{staticClass:"q-px-md q-py-sm"},[s("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",attrs:{color:"grey-9",label:"Payload format indicator"},model:{value:e.config.options.properties.payloadFormatIndicator,callback:function(t){e.$set(e.config.options.properties,"payloadFormatIndicator",t)},expression:"config.options.properties.payloadFormatIndicator"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Message expiry interval",clearable:"",outlined:"","hide-bottom-space":"",error:!e.isNil(e.config.options.properties.messageExpiryInterval)&&(e.config.options.properties.messageExpiryInterval<0||e.config.options.properties.messageExpiryInterval>4294967295)},on:{clear:function(t){e.config.options.properties.messageExpiryInterval=void 0}},model:{value:e.config.options.properties.messageExpiryInterval,callback:function(t){e.$set(e.config.options.properties,"messageExpiryInterval",e._n(t))},expression:"config.options.properties.messageExpiryInterval"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Topic alias",clearable:"",outlined:"","hide-bottom-space":"",error:!e.isNil(e.config.options.properties.topicAlias)&&(e.config.options.properties.topicAlias<=0||e.config.options.properties.topicAlias>65535)},on:{clear:function(t){e.config.options.properties.topicAlias=void 0}},model:{value:e.config.options.properties.topicAlias,callback:function(t){e.$set(e.config.options.properties,"topicAlias",e._n(t))},expression:"config.options.properties.topicAlias"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Response topic",outlined:"","hide-bottom-space":""},model:{value:e.config.options.properties.responseTopic,callback:function(t){e.$set(e.config.options.properties,"responseTopic",t)},expression:"config.options.properties.responseTopic"}}),s("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",type:"textarea",autogrow:"",label:"Correlation data",outlined:"","hide-bottom-space":""},model:{value:e.config.options.properties.correlationData,callback:function(t){e.$set(e.config.options.properties,"correlationData",t)},expression:"config.options.properties.correlationData"}}),s("div",{staticClass:"q-mb-sm"},[s("div",{staticClass:"q-mt-md"},[e._v("User Properties")]),s("div",[e.config.options.properties.userProperties?s("q-list",{staticClass:"q-mb-xs"},e._l(e.config.options.properties.userProperties,(function(t,i){return s("q-item",{key:i+": "+t,staticStyle:{"min-height":"17px"}},[s("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(t){return e.removePublishUserProperty(i)}}}),s("span",[e._v(e._s(i+": "+t))])],1)})),1):e._e(),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property name"},model:{value:e.publishUserProperty.name,callback:function(t){e.$set(e.publishUserProperty,"name",t)},expression:"publishUserProperty.name"}}),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"User property value"},model:{value:e.publishUserProperty.value,callback:function(t){e.$set(e.publishUserProperty,"value",t)},expression:"publishUserProperty.value"}}),s("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!e.publishUserProperty.name||!e.publishUserProperty.value,color:"grey-9"},on:{click:function(t){return e.addPublishUserProperty()}}},[e._v("Add")])],1)]),s("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Content type"},model:{value:e.config.options.properties.contentType,callback:function(t){e.$set(e.config.options.properties,"contentType",t)},expression:"config.options.properties.contentType"}})],1)]):e._e()],1)])],1)])])],1)],1)},et=[],tt={name:"PublisherModal",props:["message","version"],data:function(){return{config:{topic:this.message.topic,payload:JSON.stringify(this.message.payload),options:{qos:this.message.qos,retain:this.message.retain,dup:this.message.dup,properties:w()(this.message.properties)}},publishUserProperty:{value:"",name:""}}},computed:{isValidPublisher:function(){return!!this.config.topic&&this.validateTopic(this.config.topic)&&(4===this.version||5===this.version&&($e()(this.config.options.properties.messageExpiryInterval)||this.config.options.properties.messageExpiryInterval>=0&&this.config.options.properties.messageExpiryInterval<=4294967295)&&($e()(this.config.options.properties.topicAlias)||this.config.options.properties.topicAlias>0&&this.config.options.properties.topicAlias<=65535))}},methods:{isNil:$e.a,addPublishUserProperty:function(){this.config.options.properties.userProperties||this.$set(this.config.options.properties,"userProperties",{});var e=this.config.options.properties.userProperties;e[this.publishUserProperty.name]?Array.isArray(e[this.publishUserProperty.name])?e[this.publishUserProperty.name].push(this.publishUserProperty.value):this.$set(e,this.publishUserProperty.name,[e[this.publishUserProperty.name],this.publishUserProperty.value]):this.$set(e,this.publishUserProperty.name,this.publishUserProperty.value),this.publishUserProperty={value:"",name:""}},removePublishUserProperty:function(e){this.$delete(this.config.options.properties.userProperties,e),Object.keys(this.config.options.properties.userProperties).length||this.$set(this.config.options.properties,"userProperties",null)},show:function(){this.$refs.modal.show()},hide:function(){this.$refs.modal.hide()}},mixins:[ke]},st=tt,it=(s("0a8d"),Object(K["a"])(st,Ze,et,!1,null,null,null)),rt=it.exports,nt=function(){var e,t,s,i=this,r=i.$createElement,n=i._self._c||r;return n("q-dialog",{attrs:{"content-class":"mqtt-board__popup",maximized:i.$q.platform.is.mobile,"no-backdrop-dismiss":"","no-esc-dismiss":""},model:{value:i.model,callback:function(e){i.model=e},expression:"model"}},[n("q-card",{style:{minWidth:i.$q.platform.is.mobile?"100%":"50vw"}},[n("q-card-section",{staticClass:"q-pa-none",class:(e={},e["bg-"+i.color]=!0,e["text-white"]=!!i.color,e)},[n("q-toolbar",{class:(t={},t["bg-"+i.color]=!0,t["text-white"]=!!i.color,t)},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"keyboard_arrow_left"},on:{click:i.close}}),n("q-toolbar-title",[i._v("\n          Connection settings\n        ")])],1)],1),n("q-separator"),n("q-card-section",{staticClass:"scroll",style:{height:i.$q.platform.is.mobile?"calc(100% - 94px)":"50vh"}},[n("div",[n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"",label:"Client name"},model:{value:i.currentSettings.clientName,callback:function(e){i.$set(i.currentSettings,"clientName",e)},expression:"currentSettings.clientName"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"",label:"Client ID",error:!i.currentSettings.clientId,"hide-bottom-space":""},model:{value:i.currentSettings.clientId,callback:function(e){i.$set(i.currentSettings,"clientId",e)},expression:"currentSettings.clientId"}},[n("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-refresh",flat:"",round:""},on:{click:function(e){i.currentSettings.clientId="mqtt-board-"+Math.random().toString(16).substr(2,8)}},slot:"append"})],1),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"",label:"Host",error:!i.currentSettings.host||i.secure&&0===i.currentSettings.host.indexOf("ws:"),"error-message":"Host must be not empty and only over secured sockets","hide-bottom-space":""},model:{value:i.currentSettings.host,callback:function(e){i.$set(i.currentSettings,"host",e)},expression:"currentSettings.host"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"number",label:"Keep alive",error:!i.isNil(i.currentSettings.keepalive)&&(i.currentSettings.keepalive<=0||i.currentSettings.keepalive>65535)},model:{value:i.currentSettings.keepalive,callback:function(e){i.$set(i.currentSettings,"keepalive",i._n(e))},expression:"currentSettings.keepalive"}}),n("q-select",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","popup-content-class":"mqtt-board__popup","map-options":"","emit-value":"",options:[{label:"3.1.1",value:4},{label:"5.0",value:5}],label:"Version of MQTT","hide-bottom-space":"","options-selected-class":"bg-grey-2 text-grey-9"},model:{value:i.currentSettings.protocolVersion,callback:function(e){i.$set(i.currentSettings,"protocolVersion",e)},expression:"currentSettings.protocolVersion"}}),n("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",attrs:{color:"grey-9",label:5===i.currentSettings.protocolVersion?"Clean start":"Clean session"},model:{value:i.currentSettings.clean,callback:function(e){i.$set(i.currentSettings,"clean",e)},expression:"currentSettings.clean"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Username"},model:{value:i.currentSettings.username,callback:function(e){i.$set(i.currentSettings,"username",e)},expression:"currentSettings.username"}},[-1!==i.currentSettings.host.indexOf("flespi")?n("q-btn",{attrs:{slot:"append",color:"grey-9",icon:"mdi-login",flat:"",round:""},on:{click:i.flespiLoginHandler},slot:"append"}):i._e()],1),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",label:"Password"},model:{value:i.currentSettings.password,callback:function(e){i.$set(i.currentSettings,"password",e)},expression:"currentSettings.password"}}),5===i.currentSettings.protocolVersion?n("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{label:"Properties"}},[n("div",{staticClass:"q-px-md q-py-sm"},[n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"","hide-bottom-space":"",type:"number",min:0,clearable:"",label:"Session expiry interval",error:!i.isNil(i.currentSettings.properties.sessionExpiryInterval)&&(i.currentSettings.properties.sessionExpiryInterval<0||i.currentSettings.properties.sessionExpiryInterval>4294967295)},on:{clear:function(e){i.currentSettings.properties.sessionExpiryInterval=void 0}},model:{value:i.currentSettings.properties.sessionExpiryInterval,callback:function(e){i.$set(i.currentSettings.properties,"sessionExpiryInterval",i._n(e))},expression:"currentSettings.properties.sessionExpiryInterval"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Receive maximum",clearable:"",outlined:"","hide-bottom-space":"",error:!i.isNil(i.currentSettings.properties.receiveMaximum)&&(i.currentSettings.properties.receiveMaximum<=0||i.currentSettings.properties.receiveMaximum>65535)},on:{clear:function(e){i.currentSettings.properties.receiveMaximum=void 0}},model:{value:i.currentSettings.properties.receiveMaximum,callback:function(e){i.$set(i.currentSettings.properties,"receiveMaximum",i._n(e))},expression:"currentSettings.properties.receiveMaximum"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Maximum packet size",clearable:"",outlined:"","hide-bottom-space":"",error:!i.isNil(i.currentSettings.properties.maximumPacketSize)&&(i.currentSettings.properties.maximumPacketSize<=0||i.currentSettings.properties.maximumPacketSize>4294967295)},on:{clear:function(e){i.currentSettings.properties.maximumPacketSize=void 0}},model:{value:i.currentSettings.properties.maximumPacketSize,callback:function(e){i.$set(i.currentSettings.properties,"maximumPacketSize",i._n(e))},expression:"currentSettings.properties.maximumPacketSize"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Topic alias maximum",clearable:"",outlined:"","hide-bottom-space":"",error:!i.isNil(i.currentSettings.properties.topicAliasMaximum)&&(i.currentSettings.properties.topicAliasMaximum<0||i.currentSettings.properties.topicAliasMaximum>65535)},model:{value:i.currentSettings.properties.topicAliasMaximum,callback:function(e){i.$set(i.currentSettings.properties,"topicAliasMaximum",i._n(e))},expression:"currentSettings.properties.topicAliasMaximum"}}),n("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Request-Response information"},model:{value:i.currentSettings.properties.requestResponseInformation,callback:function(e){i.$set(i.currentSettings.properties,"requestResponseInformation",e)},expression:"currentSettings.properties.requestResponseInformation"}}),n("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",staticStyle:{display:"flex"},attrs:{color:"grey-9",label:"Request problem information"},model:{value:i.currentSettings.properties.requestProblemInformation,callback:function(e){i.$set(i.currentSettings.properties,"requestProblemInformation",e)},expression:"currentSettings.properties.requestProblemInformation"}}),n("div",{staticClass:"q-mb-sm"},[n("div",{staticClass:"q-mt-md"},[i._v("User Properties")]),n("div",[i.currentSettings.properties.userProperties?n("q-list",{staticClass:"q-mb-xs",attrs:{bordered:""}},i._l(i.currentSettings.properties.userProperties,(function(e,t){return n("q-item",{key:t+": "+e,staticStyle:{"min-height":"17px"}},[n("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1.2rem",name:"mdi-close-circle"},nativeOn:{click:function(e){return i.removeConnectUserProperty(t)}}}),n("span",[i._v(i._s(t+": "+e))])],1)})),1):i._e(),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"User property name",outlined:"","hide-bottom-space":""},model:{value:i.connectUserProperty.name,callback:function(e){i.$set(i.connectUserProperty,"name",e)},expression:"connectUserProperty.name"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"User property value",outlined:"","hide-bottom-space":""},model:{value:i.connectUserProperty.value,callback:function(e){i.$set(i.connectUserProperty,"value",e)},expression:"connectUserProperty.value"}}),n("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{color:"grey-9"},on:{click:i.addUserProperty}},[i._v("Add")])],1)]),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Authentication method",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.properties.authenticationMethod,callback:function(e){i.$set(i.currentSettings.properties,"authenticationMethod",e)},expression:"currentSettings.properties.authenticationMethod"}}),n("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",type:"textarea",label:"Authentication data",outlined:"","hide-bottom-space":"",autogrow:""},model:{value:i.currentSettings.properties.authenticationData,callback:function(e){i.$set(i.currentSettings.properties,"authenticationData",e)},expression:"currentSettings.properties.authenticationData"}})],1)]):i._e(),n("q-expansion-item",{staticClass:"q-mt-sm q-mb-sm bg-grey-2",attrs:{label:"Will"}},[n("div",{staticClass:"q-px-md q-py-sm"},[n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",error:!i.currentSettings.will.topic&&!!i.currentSettings.will.payload,label:"Will topic",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.will.topic,callback:function(e){i.$set(i.currentSettings.will,"topic",e)},expression:"currentSettings.will.topic"}}),n("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",error:!!i.currentSettings.will.topic&&!i.currentSettings.will.payload,type:"textarea",label:"Will payload",outlined:"","hide-bottom-space":"",autogrow:""},model:{value:i.currentSettings.will.payload,callback:function(e){i.$set(i.currentSettings.will,"payload",e)},expression:"currentSettings.will.payload"}}),n("div",{staticClass:"q-my-sm"},[i._v("\n              QoS\n              "),n("q-btn-toggle",{staticClass:"q-ml-sm",attrs:{flat:"",rounded:"","toggle-text-color":"grey-9","text-color":"grey-6",options:[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}]},model:{value:i.currentSettings.will.qos,callback:function(e){i.$set(i.currentSettings.will,"qos",e)},expression:"currentSettings.will.qos"}})],1),n("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",attrs:{color:"grey-9",label:"Will retain"},model:{value:i.currentSettings.will.retain,callback:function(e){i.$set(i.currentSettings.will,"retain",e)},expression:"currentSettings.will.retain"}}),5===i.currentSettings.protocolVersion?n("q-expansion-item",{staticClass:"bg-grey-4",attrs:{label:"Will properties"}},[n("div",{staticClass:"q-px-md q-py-sm"},[n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",outlined:"",clearable:"","hide-bottom-space":"",type:"number",label:"Will delay interval"},on:{clear:function(e){i.currentSettings.will.properties.willDelayInterval=void 0}},model:{value:i.currentSettings.will.properties.willDelayInterval,callback:function(e){i.$set(i.currentSettings.will.properties,"willDelayInterval",i._n(e))},expression:"currentSettings.will.properties.willDelayInterval"}}),n("q-checkbox",{staticClass:"q-mt-sm q-mb-sm",attrs:{color:"grey-9",label:"Payload format indicator"},model:{value:i.currentSettings.will.properties.payloadFormatIndicator,callback:function(e){i.$set(i.currentSettings.will.properties,"payloadFormatIndicator",e)},expression:"currentSettings.will.properties.payloadFormatIndicator"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",type:"number",label:"Message expiry interval",clearable:"",outlined:"","hide-bottom-space":""},on:{clear:function(e){i.currentSettings.will.properties.messageExpiryInterval=void 0}},model:{value:i.currentSettings.will.properties.messageExpiryInterval,callback:function(e){i.$set(i.currentSettings.will.properties,"messageExpiryInterval",i._n(e))},expression:"currentSettings.will.properties.messageExpiryInterval"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Content type",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.will.properties.contentType,callback:function(e){i.$set(i.currentSettings.will.properties,"contentType",e)},expression:"currentSettings.will.properties.contentType"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Response topic",outlined:"","hide-bottom-space":""},model:{value:i.currentSettings.will.properties.responseTopic,callback:function(e){i.$set(i.currentSettings.will.properties,"responseTopic",e)},expression:"currentSettings.will.properties.responseTopic"}}),n("q-input",{staticClass:"q-mb-xs q-textarea--fix",attrs:{color:"grey-9",type:"textarea",label:"Correlation data",outlined:"","hide-bottom-space":"",autogrow:""},model:{value:i.currentSettings.will.properties.correlationData,callback:function(e){i.$set(i.currentSettings.will.properties,"correlationData",e)},expression:"currentSettings.will.properties.correlationData"}}),n("div",[n("div",{staticClass:"q-mt-md"},[i._v("Will user properties")]),n("div",[i.currentSettings.will.properties.userProperties?n("q-list",{staticClass:"q-mb-xs",staticStyle:{"border-color":"#b7b7b7"}},i._l(i.currentSettings.will.properties.userProperties,(function(e,t){return n("q-item",{key:t+": "+e,staticStyle:{"min-height":"17px"}},[n("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1.2rem",name:"mdi-close-circle"},nativeOn:{click:function(e){return i.removeWillConnectUserProperty(t)}}}),n("span",[i._v(i._s(t+": "+e))])],1)})),1):i._e(),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Will user property name",outlined:"","hide-bottom-space":""},model:{value:i.willConnectUserProperty.name,callback:function(e){i.$set(i.willConnectUserProperty,"name",e)},expression:"willConnectUserProperty.name"}}),n("q-input",{staticClass:"q-mb-xs",attrs:{color:"grey-9",label:"Will user property value",outlined:"","hide-bottom-space":""},model:{value:i.willConnectUserProperty.value,callback:function(e){i.$set(i.willConnectUserProperty,"value",e)},expression:"willConnectUserProperty.value"}}),n("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{color:"grey-9"},on:{click:i.addWillUserProperty}},[i._v("Add")])],1)])],1)]):i._e()],1)])],1)]),n("q-separator"),n("q-card-actions",{class:(s={},s["bg-"+i.color]=!0,s["text-white"]=!!i.color,s),attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-sm",attrs:{flat:"",dense:""},on:{click:i.close}},[i._v("Close")]),n("q-btn",{attrs:{flat:"",dense:"",disable:!i.isCurrentSettingsValid},on:{click:i.save}},[i._v("Save")])],1)],1)],1)},ot=[],at=s("d0b1"),lt=s("8993"),ct=s.n(lt),pt={publisher:{topic:"string",payload:"string",options:{qos:"number",retain:"boolean",dup:"boolean",properties:{payloadFormatIndicator:"boolean",messageExpiryInterval:"number",topicAlias:"number",responseTopic:"string",correlationData:"string",userProperties:{},contentType:"string"}}},subscriber:{topic:"string",mode:"number",options:{qos:"number",nl:"boolean",rap:"boolean",rh:"number",properties:{subscriptionIdentifier:"number",userProperties:{}}}},settings:{clientId:"string",host:"string",keepalive:"number",protocolVersion:"number",clean:"boolean",username:"string",password:"string",properties:{sessionExpiryInterval:"number",receiveMaximum:"number",maximumPacketSize:"number",topicAliasMaximum:"number",requestResponseInformation:"boolean",requestProblemInformation:"boolean",userProperties:{},authenticationMethod:"string",authenticationData:"string"},will:{topic:"string",payload:"string",qos:"number",retain:"boolean",properties:{willDelayInterval:"number",payloadFormatIndicator:"boolean",messageExpiryInterval:"number",contentType:"string",responseTopic:"string",correlationData:"string",userProperties:{}}}},entity:{type:"string",index:"number",id:"string"}},ut={methods:{validateObjectBySchema:function(e,t){var s=this;return Object.keys(t).reduce((function(i,r){if(void 0!==e[r]&&null!==e[r]){var n=ct()(e[r]);i="object"===ct()(t[r])?i&&s.validateObjectBySchema(e[r],t[r]):n===t[r]?i&&!0:i&&!1}return i}),!0)},validateEntity:function(e){switch(e.type){case"publisher":return this.validatePublisher(e.settings);case"subscriber":return this.validateSubscriber(e.settings);default:return!1}},validateSettings:function(e){return this.validateObjectBySchema(e,pt.settings)&&!!e.clientId&&!!e.host&&($e()(e.keepalive)||e.keepalive>=0&&e.keepalive<=65535)&&(!e.will||!!e.will&&(!!e.will.topic&&!!e.will.payload||!e.will.topic&&!e.will.payload))&&(!e.properties||!!e.properties&&($e()(e.properties.sessionExpiryInterval)||e.properties.sessionExpiryInterval>=0&&e.properties.sessionExpiryInterval<=4294967295)&&($e()(e.properties.receiveMaximum)||e.properties.receiveMaximum>0&&e.properties.receiveMaximum<=65535)&&($e()(e.properties.maximumPacketSize)||e.properties.maximumPacketSize>0&&e.properties.maximumPacketSize<=4294967295)&&($e()(e.properties.topicAliasMaximum)||e.properties.topicAliasMaximum>=0&&e.properties.topicAliasMaximum<=65535))},validatePublisher:function(e){return this.validateObjectBySchema(e,pt.publisher)&&!!e.topic&&!!e.options&&(!e.options.properties||!!e.options.properties&&($e()(e.options.properties.messageExpiryInterval)||e.options.properties.messageExpiryInterval>=0&&e.options.properties.messageExpiryInterval<=4294967295)&&($e()(e.options.properties.topicAlias)||e.options.properties.topicAlias>0&&e.options.properties.topicAlias<=65535))},validateSubscriber:function(e){return this.validateObjectBySchema(e,pt.subscriber)&&!!e.topic&&!!e.options&&(!e.options.properties||!!e.options.properties&&($e()(e.options.properties.subscriptionIdentifier)||e.options.properties.subscriptionIdentifier>0&&e.options.properties.subscriptionIdentifier<=268435455))},validateEntityRecord:function(e){return this.validateObjectBySchema(e,pt.entity)}}},dt={props:{initSettings:{type:Object,default:function(){return{}}},settings:{type:Object,default:function(){return{}}},color:String,secure:Boolean},mixins:[ut],data:function(){return{model:!0,currentSettings:w()(C()({},at["b"],this.initSettings,this.settings)),connectUserProperty:{value:"",name:""},willConnectUserProperty:{value:"",name:""}}},computed:{isCurrentSettingsValid:function(){var e=this.currentSettings;return this.validateSettings(this.currentSettings)&&!(this.secure&&0===e.host.indexOf("ws:"))}},methods:{isNil:$e.a,close:function(){this.$emit("close")},save:function(){this.$emit("save",this.currentSettings),this.close()},addUserProperty:function(){this.currentSettings.properties.userProperties||(this.currentSettings.properties.userProperties={}),this.currentSettings.properties.userProperties[this.connectUserProperty.name]=this.connectUserProperty.value,this.connectUserProperty={value:"",name:""}},addWillUserProperty:function(){this.currentSettings.will.properties.userProperties||(this.currentSettings.will.properties.userProperties={}),this.currentSettings.will.properties.userProperties[this.willConnectUserProperty.name]=this.willConnectUserProperty.value,this.willConnectUserProperty={value:"",name:""}},removeConnectUserProperty:function(e){this.$delete(this.currentSettings.properties.userProperties,e),Object.keys(this.currentSettings.properties.userProperties).length||(this.currentSettings.properties.userProperties=null)},removeWillConnectUserProperty:function(e){this.$delete(this.currentSettings.will.properties.userProperties,e),Object.keys(this.currentSettings.will.properties.userProperties).length||(this.currentSettings.will.properties.userProperties=null)},openWindow:function(e,t){t=t||"auth";var s=500,i=600,r=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=o/2-s/2+r,c=a/2-i/2+n,p=window.open(e,t,"toolbar=no,location=no,status=yes,resizable=yes,scrollbars=yes, width="+s+", height="+i+", top="+c+", left="+l);window.focus&&p.focus()},flespiLoginHandler:function(){var e=this,t=function t(s){if("string"===typeof s.data&&~s.data.indexOf("FlespiLogin|token:")){var i=s.data;i=i.replace("FlespiLogin|token:",""),i=JSON.parse(i),e.currentSettings.username=i.token,e.currentSettings.host="wss://".concat(i.region["mqtt-ws"]),window.removeEventListener("message",t)}};window.addEventListener("message",t),this.openWindow("https://flespi.io/login/#/providers")}}},bt=dt,mt=Object(K["a"])(bt,nt,ot,!1,null,null,null),ft=mt.exports,ht=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrapper__footer row no-wrap items-center justify-between bg-grey-9"},[s("q-resize-observer",{on:{resize:function(t){var s=t.width;return e.wrapperWidth=s}}}),s("div",[e.needScrollButtons?s("q-btn",{attrs:{disable:e.buttonsDisable.prev,color:"white",icon:"mdi-chevron-left",dense:"",flat:"",size:"21px"},on:{click:function(t){return e.$emit("swipe","right")}}},[s("q-tooltip",[e._v("Previous pannel")])],1):e._e()],1),s("div",{staticClass:"flex relative-position"},[e.needShowMore[0]?s("q-btn",{staticClass:"wrapper__left-more",attrs:{color:"white",icon:"mdi-dots-horizontal",dense:"",flat:"",size:"10px"},on:{click:function(t){return e.$emit("swipe-to",0)}}},[s("q-tooltip",[e._v("Go to first pannel")])],1):e._e(),e._l(e.shownItems,(function(t){return s("div",{key:t.queue,staticClass:"q-py-xs row inline",class:e.getItemClasses(t.queue),on:{click:function(s){return e.$emit("swipe-to",t.queue)}}},[s("q-btn",{staticClass:"q-mx-xs",attrs:{round:"",size:"4px",color:e.colors[t.type],unelevated:""}},[s("q-tooltip",{attrs:{"content-class":["bg-"+e.colors[t.type]],"max-width":"250px"}},[s("div",[s("div",{staticClass:"text-bold"},[e._v(e._s(t.type.toUpperCase()))]),t.config&&t.config.topic?s("div",{staticClass:"ellipsis"},[e._v("Topic: "+e._s(t.config.topic))]):e._e(),t.config&&t.config.payload?s("div",{staticClass:"ellipsis"},[e._v("Payload: "+e._s(t.config.payload))]):e._e()])])],1)],1)})),e.needShowMore[1]?s("q-btn",{staticClass:"wrapper__right-more",attrs:{color:"white",icon:"mdi-dots-horizontal",dense:"",flat:"",size:"10px"},on:{click:function(t){return e.$emit("swipe-to",e.entities.length-1)}}},[s("q-tooltip",[e._v("Go to last pannel")])],1):e._e()],2),s("div",[e.needScrollButtons?s("q-btn",{attrs:{disable:e.buttonsDisable.next,color:"white",icon:"mdi-chevron-right",dense:"",flat:"",size:"21px"},on:{click:function(t){return e.$emit("swipe","left")}}},[s("q-tooltip",[e._v("Next pannel")])],1):e._e()],1)],1)},gt=[];function vt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function yt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(s),!0).forEach((function(t){d()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):vt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var qt={props:{entities:Array,buttonsDisable:Object,active:Array},data:function(){return{colors:{logs:"blue",subscriber:"orange",publisher:"indigo",unresolved:"red-6"},wrapperWidth:0}},computed:{viewedItemsCount:function(){return Math.floor((this.wrapperWidth-96)/20)},visibleItemsRange:function(){var e=Math.floor((this.viewedItemsCount-(this.active[1]-this.active[0]+1))/2),t=0,s=this.entities.length-1,i=2*e+(this.active[1]-this.active[0]+1),r=this.active[0]-e<0?0:this.active[0]-e,n=this.active[1]+e>s?s:this.active[1]+e;return r===t&&(n=i-1),n===s&&(r=s-i+1),[r,n]},shownItems:function(){var e=this;return this.entities.reduce((function(t,s,i){return e.visibleItemsRange[0]<=i&&e.visibleItemsRange[1]>=i&&t.push(yt({queue:i},s)),t}),[])},needScrollButtons:function(){return this.shownItems.length<this.entities.length},needShowMore:function(){var e=[!1,!1];return this.visibleItemsRange[0]>0&&(e[0]=!0),this.visibleItemsRange[1]<this.entities.length-1&&(e[1]=!0),e}},methods:{getItemClasses:function(e){var t=[];return this.active[0]<=e&&this.active[1]>=e&&t.push("item--active"),this.active[1]===e&&this.active[0]===e?t.push("item--active-all"):this.active[0]===e?t.push("item--active-left"):this.active[1]===e&&t.push("item--active-right"),t}}},xt=qt,Ct=(s("b2fe"),Object(K["a"])(xt,ht,gt,!1,null,null,null)),St=Ct.exports,wt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-list",[s("q-item-label",{attrs:{header:""}},[e._v("Panes")]),s("div",{staticClass:"scroll absolute full-width",staticStyle:{height:"calc(100% - 48px)"}},e._l(e.visibleItems,(function(t,i){return s("q-item",{key:t.type+"-"+t.id,staticClass:"q-ma-xs rounded-borders",class:e.getItemClasses(t),staticStyle:{overflow:"hidden"},attrs:{active:t.rendered,clickable:""},on:{click:function(t){return e.$emit("pick",i)}}},[s("div",{staticClass:"absolute-top-left absolute-bottom-left",class:["bg-"+e.colorByType[t.type]+"-6"],staticStyle:{width:"10px"}}),s("q-item-section",[s("q-item-label",{staticClass:"q-pa-none text-bold",class:["text-"+(t.rendered?"white":e.colorByType[t.type]+"-10")],attrs:{header:""}},[e._v(e._s(e.labelByType[t.type]))]),"subscriber"===t.type||"publisher"===t.type?s("q-item-label",{staticClass:"ellipsis",class:["text-"+(t.rendered?"grey-2":e.colorByType[t.type]+"-10")],attrs:{caption:""}},[e._v(e._s(t.settings.topic))]):e._e(),"publisher"===t.type?s("q-item-label",{staticClass:"ellipsis",class:["text-"+(t.rendered?"grey-2":e.colorByType[t.type]+"-10")],attrs:{caption:""}},[s("small",[e._v(e._s(t.settings.payload))])]):e._e()],1),"subscriber"===t.type||"publisher"===t.type?s("q-item-section",{attrs:{side:""}},["publisher"===t.type?s("q-btn",{attrs:{dense:"",outline:"",color:"white",disable:!e.isValidPublisher(t.settings),icon:"mdi-send"},on:{click:function(s){return s.stopPropagation(),e.$emit("publish",t.settings)}}},[s("q-tooltip",[e._v("Publish")])],1):e._e(),"subscriber"===t.type?s("q-btn",{attrs:{dense:"",outline:"",color:"white",disable:!e.isValidSubscriber(t.settings),icon:t.status?"mdi-stop":"mdi-play"},on:{click:function(s){return s.stopPropagation(),e.$emit(t.status?"subscriber:stop":"subscriber:play",t.index)}}},[s("q-tooltip",[e._v(e._s(t.status?"Stop":"Subscribe"))])],1):e._e()],1):e._e()],1)})),1)],1)},_t=[];function kt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Pt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(s),!0).forEach((function(t){d()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):kt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var $t={props:["entities","active"],data:function(){return{colorByType:{subscriber:"orange",publisher:"indigo",logs:"blue",unresolved:"red"},labelByType:{subscriber:"Subscriber",publisher:"Publisher",logs:"Logs",unresolved:"Unresolved"}}},computed:{visibleItems:function(){var e=0;return this.entities.reduce((function(t,s){var i=Pt({},s);return s.rendered&&(i.visibleIndex=e,e++),t.push(i),t}),[])}},methods:{isValidPublisher:function(e){return!!e.topic&&this.validateTopic(e.topic)&&($e()(e.options.properties.messageExpiryInterval)||e.options.properties.messageExpiryInterval>=0&&e.options.properties.messageExpiryInterval<=4294967295)&&($e()(e.options.properties.topicAlias)||e.options.properties.topicAlias>0&&e.options.properties.topicAlias<=65535)},isValidSubscriber:function(e){return!!e.topic&&this.validateTopic(e.topic)&&($e()(e.options.properties.subscriptionIdentifier)||e.options.properties.subscriptionIdentifier>0&&e.options.properties.subscriptionIdentifier<=268435455)},getItemClasses:function(e){var t=["bg-".concat(e.rendered?"".concat(this.colorByType[e.type],"-6"):"grey-13")];return(this.active[0]>e.visibleIndex||this.active[1]<e.visibleIndex||void 0===e.visibleIndex)&&t.push("q-ml-md"),t}},mixins:[ke]},Ot=$t,Mt=Object(K["a"])(Ot,wt,_t,!1,null,null,null),It=Mt.exports,Ut=s("9224"),Tt=s("2b0e");function jt(e,t,s){function i(e,s,i){var r=e.split("/"),n=i,o="";r.forEach((function(e,i,r){if(n[e]||Tt["default"].set(n,e,{children:void 0,topic:"",value:void 0}),0!==i&&(o+="/"),o+="".concat(e),Tt["default"].set(n[e],"topic",o),i!==r.length-1)n[e].children||Tt["default"].set(n[e],"children",{}),n=n[e].children;else{n[e].value||Tt["default"].set(n[e],"value",{});var a=s.properties&&s.properties.userProperties&&s.properties.userProperties[t]?s.properties.userProperties[t]:"";Tt["default"].set(n[e].value,a,JSON.stringify(s))}}))}function r(e,s,i){function r(e,t){var s=new Array(t.length).fill(void 0);return s[0]=e,t.reduce((function(e,t,i,r){var n={container:s[i]||null,name:t};return s[i+1]=n.container&&n.container[t]?n.container[t].children:null,n}),{container:e,name:t[0]})}var n=e.split("/");new Array(n.length).fill("").forEach((function(e,o){var a=n.length-o,l=n.slice(0,a),c=r(i,l);if(!c.container||!c.container[c.name])return!1;var p=c.container[c.name],u=p.children&&!!Object.keys(p.children).length;if(p.value&&0===o){var d=s.properties&&s.properties.userProperties&&s.properties.userProperties[t]?s.properties.userProperties[t]:"";Tt["default"].delete(p.value,d),Object.keys(p.value).length||Tt["default"].set(p,"value",void 0)}u||(Tt["default"].set(p,"children",void 0),p.value||Tt["default"].delete(c.container,c.name))}))}function n(e){return"string"!==typeof e.payload||e.payload.length?i:r}Array.isArray(e)?e.forEach((function(e){n(e)(e.topic,e,s)})):n(e)(e.topic,e,s)}var Et=jt,At=s("70e1"),Nt=s.n(At);function Ht(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Dt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(s),!0).forEach((function(t){d()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ht(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Lt=function(){function e(t){m()(this,e),this.bus=new Nt.a(t)}return h()(e,[{key:"getDevices",value:function(){var e=p()(l.a.mark((function e(t){var s,i,r,n,o,a,c;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s="all",!t||"all"===t){e.next=15;break}return i=t.join(","),e.prev=3,e.next=6,this.bus.gw.getCalcsDevices(i,"all",{fileds:"device_id"});case 6:r=e.sent,n=k()(r,"data.result",[]),o=n.reduce((function(e,t){return e[t.device_id]=!0,e}),{}),s=Object.keys(o).join(","),e.next=15;break;case 12:return e.prev=12,e.t0=e["catch"](3),e.abrupt("return",[]);case 15:return e.next=17,this.bus.gw.getDevices(s,{fields:"id,name"});case 17:return a=e.sent,c=k()(a,"data.result",[]),c=c.map((function(e){return{label:e.name||"#".concat(e.id),value:"".concat(e.id)}})),e.abrupt("return",c);case 21:case"end":return e.stop()}}),e,this,[[3,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getChannels",value:function(){var e=p()(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.bus.gw.getChannels("all",{fileds:"id,name"});case 2:return t=e.sent,s=k()(t,"data.result",[]),s=s.map((function(e){return{label:e.name||"#".concat(e.id),value:"".concat(e.id)}})),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getCalcs",value:function(){var e=p()(l.a.mark((function e(t){var s,i,r,n,o,a,c;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s="all",!t||"all"===t){e.next=15;break}return e.prev=2,i=t.join(","),e.next=6,this.bus.gw.getCalcsDevices("all",i,{fields:"calc_id"});case 6:r=e.sent,n=k()(r,"data.result",[]),o=n.reduce((function(e,t){return e[t.calc_id]=!0,e}),{}),s=Object.keys(o).join(","),e.next=15;break;case 12:return e.prev=12,e.t0=e["catch"](2),e.abrupt("return",[]);case 15:return e.next=17,this.bus.gw.getCalcs(s,{fileds:"id,name"});case 17:return a=e.sent,c=k()(a,"data.result",[]),c=c.map((function(e){return{label:e.name||"#".concat(e.id),value:"".concat(e.id)}})),e.abrupt("return",c);case 21:case"end":return e.stop()}}),e,this,[[2,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getDevicesTelemetry",value:function(){var e=p()(l.a.mark((function e(t){var s,i;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.bus.gw.getDevicesTelemetry(t,"all");case 2:return s=e.sent,i=k()(s,"data.result",[]),i=i.reduce((function(e,t){var s=t.telemetry;return s&&(e=Dt(Dt({},e),s)),e}),{}),i=Object.keys(i).sort().map((function(e){return{label:e,value:e}})),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getDevicesSettings",value:function(){var e=p()(l.a.mark((function e(t){var s,i;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.bus.gw.getDevicesSettings(t,"all",{fields:"name,schema"});case 2:return s=e.sent,i=k()(s,"data.result",[]),i=i.reduce((function(e,t){var s=t.name,i=t.schema.title;return e[s]||(e[s]={}),e[s][i]=!0,e}),{}),i=Object.keys(i).map((function(e){return{label:Object.keys(i[e]).join(", "),value:e}})),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"settings",get:function(){return this.bus.settings},set:function(e){this.bus.settings=e}},{key:"token",get:function(){return this.bus.token},set:function(e){this.bus.token=e}}]),e}(),zt=Lt;function Rt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ft(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(s),!0).forEach((function(t){d()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Rt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Bt(e,t){var s;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(s=Vt(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,a=!1;return{s:function(){s=e[Symbol.iterator]()},n:function(){var e=s.next();return o=e.done,e},e:function(e){a=!0,n=e},f:function(){try{o||null==s.return||s.return()}finally{if(a)throw n}}}}function Vt(e,t){if(e){if("string"===typeof e)return Wt(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Wt(e,t):void 0}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var Jt=function(e){return Object.keys(e).map((function(t){var s=e[t];return{status:s.status,config:s.config,publishers:s.publishers,subscribers:s.subscribers,entities:s.entities.filter((function(e){return"unresolved"!==e.type})),subscribersStatuses:s.subscribersStatuses,subscribersConnectivityStatuses:s.subscribersConnectivityStatuses}}))},Xt=$()((function(e){O["a"].set(Qt,Jt(e))}),500,{trailing:!0}),Qt="clients",Yt=!0,Kt=!1,Gt=null,Zt={name:"MqttClient",props:{initSettings:{type:Object},whiteLabel:{type:String,default:""},useLocalStorage:{type:Boolean,default:!0},needInitNewClient:{type:Boolean,default:!1},clientsCloseable:{type:Boolean,default:!0},secure:{type:Boolean,default:!0},color:{type:String,default:"grey-9"},accentColor:{type:String,default:"light-blue-7"},initEntities:{type:Array,default:function(){return[{type:"subscriber",rendered:!0,settings:w()(at["c"])},{type:"publisher",settings:w()(at["a"]),rendered:!0}]},validator:function(e){return e.reduce((function(e,t,s){return ut.methods.validateEntity(t)?e&&!0:e&&!1}),!0)}},configuredClients:{type:Array,default:function(){return[]},validator:function(e){var t=!0;return e.forEach((function(e){if(!e.config||!e.entities||!e.publishers||!e.subscribers)return t=!1,!1;t=t&&ut.methods.validateSettings(e.config),e.entities.forEach((function(e){t=t&&ut.methods.validateEntityRecord(e)})),e.publishers.forEach((function(e){t=t&&ut.methods.validatePublisher(e)})),e.subscribers.forEach((function(e){t=t&&ut.methods.validateSubscriber(e)}))})),t}}},data:function(){return{version:Ut["a"],drawerRight:this.$q.platform.is.desktop,clients:{},statuses:{},activeClient:null,entities:[],publishers:[],subscribers:[],subscribersStatuses:[!1],subscribersConnectivityStatuses:[!1],subscribersMessages:[[]],subscribersMessagesBuffer:[[]],settingsModalModel:!1,editedClientId:null,renderInterval:0,messagesLimitCount:3e3,notResolvedMessages:[],isNeedScroll:!1,isInited:!1,republishMessage:null,wrapperWidth:0,firstViewedPanelIndex:0}},computed:{renderedEntities:function(){var e,t=[],s=Bt(this.entities);try{for(s.s();!(e=s.n()).done;){var i=e.value;if(i.rendered||void 0===i.rendered){var r=i;"publisher"===i.type?r.config=this.publishers[i.index]:"subscriber"===i.type&&(r.config=this.subscribers[i.index]),t.push(r)}}}catch(n){s.e(n)}finally{s.f()}return t},menuEnitites:function(){var e,t=[],s=Bt(this.entities);try{for(s.s();!(e=s.n()).done;){var i=e.value,r=Ft({},i);"subscriber"===i.type?(r.settings=this.subscribers[i.index],r.status=this.subscribersStatuses[i.index]):"publisher"===i.type&&(r.settings=this.publishers[i.index]),t.push(r)}}catch(n){s.e(n)}finally{s.f()}return t},colsCount:function(){return this.getÐ¡olsCount(this.wrapperWidth)}},methods:{openURL:M["a"],"getÐ¡olsCount":function(e){var t=350,s=Math.floor(e/t);s=12/Math.ceil(12/s),s>this.renderedEntities.length&&(s=this.renderedEntities.length);var i=this.wrapperWidth<600?1:s;return i},closeSettingsHandler:function(){this.settingsModalModel=!1,this.editedClientId=null},saveSettingsHandler:function(e){this.createClient(e,this.editedClientId)},clearObject:function(e){var t=this;return Object.keys(e).reduce((function(s,i){var r=e[i];return r instanceof Object&&!Array.isArray(r)&&(r=t.clearObject(r),Object.keys(r).length||(r=void 0)),void 0!==r&&null!==r&&(s[i]=r),s}),{})},resolveSubscription:function(e,t){var s=k()(t,"options.properties.subscriptionIdentifier",void 0),i=k()(e,"properties.subscriptionIdentifier",void 0);return i&&s?!!("number"===typeof i&&i===s||Array.isArray(i)&&i.includes(s)):!!this.resolveTopics(e.topic,t.topic)},resolveSubscriptions:function(e,t,s){var i=this;return t.reduce((function(t,r,n){return s[n]&&i.resolveSubscription(e,r)&&t.push(n),t}),[])},getSharedTopicFilter:function(e){return e.replace(/^\$share\/[^/]+\//,"")},resolveTopics:function(e,t){0===t.indexOf("$share")&&(t=this.getSharedTopicFilter(t));var s=t.split("/"),i=e.split("/");return(i.length===s.length||"#"===s[s.length-1])&&s.reduce((function(e,t,s){return"#"===t||"+"===t?e&&!0:e&&t===i[s]}),!0)},errorHandler:function(e,t,s){var i=this.clients[e];i.logs.push({type:"error",data:{error:t},timestamp:Date.now()}),s&&this.showError(t)},showError:function(e){this.$q.notify({message:'<div class="text-center" style="font-size: 1.2rem;">'.concat(e.message,"</div>"),html:!0,color:"negative",icon:"mdi-alert-outline",timeout:2e3})},saveClients:function(){if(!this.isInited)return!1;this.$emit("change",Jt(this.clients)),this.useLocalStorage&&Xt(this.clients)},createConnectPacket:function(e){return e=this.clearObject(e),5!==e.protocolVersion&&(delete e.properties,e.will&&delete e.will.properties),!e.will||e.will.topic||e.will.payload||delete e.will,e},setClientStatus:function(e,t){return!!this.clients[e]&&(!(this.clients[e].status===Gt&&!t)&&(this.$set(this.statuses,e,t),void this.$set(this.clients[e],"status",t)))},messageProcessing:function(e,t){var s=this;e.payload=e.payload.toString();try{e.payload=JSON.parse(e.payload)}catch(o){}var i=this.clients[t];if(i.subscribersStatuses.length&&i.subscribersStatuses.filter((function(e){return!!e})).length){var r=this.resolveSubscriptions(e,i.subscribers,i.subscribersStatuses),n=!!r.length;n?r.forEach((function(t){!0===i.subscribersStatuses[t]?i.subscribersMessagesBuffer[t].push(e):"paused"===i.subscribersStatuses[t]&&(void 0===i.subscribers[t].missedMessages&&(i.subscribers[t].missedMessages=0),i.subscribers[t].missedMessages++)})):(i.notResolvedFlagInit||(this.$set(i,"notResolvedFlagInit",!0),this.entities.push({type:"unresolved",rendered:!1})),i.notResolvedMessages.push(e))}else i.subscribers.filter((function(t,r){s.resolveSubscription(e,t)&&!i.subscribersConnectivityStatuses[r]&&(i.notResolvedFlagInit||(s.$set(i,"notResolvedFlagInit",!0),s.entities.push({type:"unresolved",rendered:!1})),i.notResolvedMessages.push(e))}))},initClient:function(e,t){var s=this,i=this.clients[e],r=function(){s.setClientStatus(e,Kt)},n=q.connect(t.host,t);n.on("connect",(function(t){var r=i.subscribersStatuses,n=i.subscribers,o=t.properties&&t.properties.userProperties&&t.properties.userProperties.subscriptions?JSON.parse(t.properties.userProperties.subscriptions):[];n.forEach((function(t,n){var a=r[n],l=o.findIndex((function(e){return e.topic===t.topic})),c=-1!==l;if(c&&!a)s.$set(r,n,!0);else if(!c&&a){if(0===t.mode)i.messages[n].splice(0,i.messages[n].length);else{var p=i.messages[n],u=Object.keys(p);u.forEach((function(e){s.$delete(p,e)}))}i.subscribersMessagesBuffer[n]=[],s.subscribe(e,n)}c&&o.splice(l,1)})),o.forEach((function(t){s.addSubscriber(void 0,e);var o=n.length-1,a=n[o],l={nl:t.no_local,rap:t.rap,rh:t.retain_handling,qos:t.qos,properties:{}};t.subscription_id&&(l.subscriptionIdentifier=t.subscription_id),s.$set(a,"options",l),s.$set(a,"topic",t.topic),s.$set(r,o,!0);var c=[{nl:t.no_local,rap:t.rap,rh:t.retain_handling,qos:t.qos,topic:t.topic}];s.$nextTick((function(){i.logs.push({type:"subscribe",data:{grants:c,restored:!0},timestamp:Date.now()})}))}))})),n.on("connect",(function(){s.setClientStatus(e,Yt)})),n.on("connect",(function(e){i.logs.push({type:"connect",data:Ft({},e),timestamp:Date.now()})})),n.once("connect",(function(t){s.$set(i,"cid",s.getCid(t)),s.$set(i,"inited",!0),s.activateRender();var r=[];i.processTimer=setInterval((function(){r.forEach((function(t){s.messageProcessing(t,e)})),r=[]}),500),n.on("message",(function(e,t,s){r.push(s)}))})),n.on("error",(function(t){s.errorHandler(e,t,!1)})),n.on("disconnect",(function(e){143===e.reasonCode&&i.subscribersStatuses.forEach((function(e,t){e&&(s.$delete(i.client._client._resubscribeTopics,i.subscribers[t].topic),s.$set(i.subscribersStatuses,t,!1),s.$set(i.subscribersConnectivityStatuses,t,!1))})),i.logs.push({type:"disconnect",data:Ft({},e),timestamp:Date.now()}),r()})),n.on("close",(function(){i.logs.push({type:"disconnect",timestamp:Date.now()}),r()})),n.on("offline",(function(){s.$set(i,"inited",!1),i.logs.push({type:"offline",timestamp:Date.now()}),r()})),n.on("end",(function(){i.logs.push({type:"end",timestamp:Date.now()}),r()})),n.on("reconnect",(function(){s.$set(i,"inited",!0),i.logs.push({type:"reconnect",timestamp:Date.now()})})),this.$set(this.clients[e],"client",n),this.makeFlespiRestBus(e)},createClient:function(e,t){var s=this;return p()(l.a.mark((function i(){var r,n,o,a,c;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=s.createConnectPacket(e),n="string"===typeof t||"number"===typeof t,o=n?t:Object.keys(s.clients).reduce((function(e,t){return e>parseInt(t)?e:parseInt(t)}),-1)+1,s.clients[o]?(c=s.clients[o],c.client&&(c.processTimer&&clearInterval(c.processTimer),s.destroyClient(c.client),s.setClientStatus(o,Kt)),c.logs.push({type:"updated",data:Ft({},r),timestamp:Date.now()})):(a={},a.id=o,a.status=!1,s.createInitEntities(a),a.logs=[{type:"created",data:Ft({},r),timestamp:Date.now()}],a.notResolvedMessages=[],s.clients[o]=a),s.statuses[o]!==Gt&&s.initClient(o,r),s.$set(s.clients[o],"config",r),s.saveClients();case 5:case"end":return i.stop()}}),i)})))()},initExternalClients:function(e){var t=this;e&&e.forEach((function(e){var s=Object.keys(t.clients).length,i={};i.config=e.config,i.id=s,i.client=null,i.status=e.status,i.publishers=e.publishers,i.subscribers=e.subscribers,i.entities=e.entities.map((function(e,t){return void 0===e.rendered&&(e.rendered=!0),e})),"logs"!==i.entities[0].type&&i.entities.unshift({type:"logs",rendered:!0}),i.messages=new Array(e.subscribers.length),i.subscribersMessagesBuffer=new Array(e.subscribers.length);for(var r=0;r<e.subscribers.length;r++)i.messages[r]=e.subscribers[r].mode?{}:[],i.subscribersMessagesBuffer[r]=[];e.subscribersStatuses?i.subscribersStatuses=e.subscribersStatuses:(i.subscribersStatuses=new Array(e.subscribers.length),i.subscribersStatuses.fill(!1)),e.subscribersConnectivityStatuses?i.subscribersConnectivityStatuses=e.subscribersConnectivityStatuses:(i.subscribersConnectivityStatuses=new Array(e.subscribers.length),i.subscribersConnectivityStatuses.fill(!1)),i.logs=[{type:"created",data:Ft({},e.config),timestamp:Date.now()}],i.notResolvedMessages=[],t.$set(t.statuses,s,e.status),t.$set(t.clients,s,i),e.status!==Gt&&t.initClient(s,t.createConnectPacket(e.config))}))},createInitEntities:function(e){var t=this,s=this.initEntities;e.subscribers=[],e.publishers=[],e.entities=[],e.messages=[],e.subscribersMessagesBuffer=[],e.subscribersStatuses=[],e.subscribersConnectivityStatuses=[],e.entities.push({type:"logs",rendered:!0}),s.forEach((function(s,i){switch(s.type){case"subscriber":e.subscribers.push(w()(C()({},at["c"],s.settings))),e.messages.push(s.settings.mode?{}:[]),e.subscribersMessagesBuffer.push([]),e.subscribersStatuses.push(!1),e.subscribersConnectivityStatuses.push(!1),e.entities.push({type:"subscriber",rendered:s.rendered,index:e.subscribers.length-1,id:Math.random().toString(16).substr(2,8)});break;case"publisher":e.publishers.push(w()(C()({},at["a"],s.settings))),e.entities.push({type:"publisher",rendered:s.rendered,index:e.publishers.length-1,id:Math.random().toString(16).substr(2,8)});break;default:t.showError(new Error("Unknown type of entity: ".concat(s.type)))}}))},addClientHandler:function(){this.settingsModalModel=!0},editClientHandler:function(e){this.editedClientId=e,this.settingsModalModel=!0},connectClientHandler:function(e){var t=this.clients[e];t.client&&(t.processTimer&&clearInterval(t.processTimer),this.destroyClient(t.client),this.setClientStatus(e,Kt)),this.initClient(e,t.config),this.saveClients()},destroyClient:function(e){return e.removeAllListeners(["reconnect","end","offline","close","disconnect","error","message","connect"]),e.end(!0)},disconnectClientHandler:function(e){var t=this;return p()(l.a.mark((function s(){var i;return l.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.clients[e],i.processTimer&&clearInterval(i.processTimer),t.setClientStatus(e,Gt),s.next=5,t.destroyClient(i.client);case 5:i.client=null,t.saveClients();case 7:case"end":return s.stop()}}),s)})))()},deleteClientHandler:function(e){var t=this,s=this.clients[e];this.$q.dialog({title:"Confirm",message:"Do you really want to delete client for ".concat(s.config.clientId,"?"),cancel:!0,ok:!0}).onOk((function(){s.processTimer&&clearInterval(s.processTimer),s.client?t.destroyClient(s.client).then((function(){t.$delete(t.statuses,e),t.$delete(t.clients,e),t.saveClients()})):(t.$delete(t.statuses,e),t.$delete(t.clients,e),t.saveClients())})).onCancel((function(){}))},activateRender:function(){var e=this;this.renderInterval||(this.renderInterval=setInterval((function(){Object.values(e.clients).forEach((function(t){t.subscribersMessagesBuffer.forEach((function(s,i){if(!s.length)return!1;var r=t.subscribers[i],n=t.messages[i];0===r.mode?(n&&(s=s.splice(-e.messagesLimitCount),n.splice.apply(n,[n.length,0].concat(o()(s))),n.splice(0,n.length-e.messagesLimitCount)),t.subscribersMessagesBuffer[i]=[]):t.subscribersStatuses[i]&&t.subscribersConnectivityStatuses[i]&&(Et(s,5===t.config.protocolVersion&&r.treeField?r.treeField:"",n),t.subscribersMessagesBuffer[i]=[])}))}))}),500))},setActiveClient:function(e){var t=this.clients[e];if(!t)return this.showError("No current client"),!1;this.entities=t.entities,this.subscribers=t.subscribers,this.publishers=t.publishers,this.subscribersMessages=t.messages,this.subscribersMessagesBuffer=t.subscribersMessagesBuffer,this.notResolvedMessages=t.notResolvedMessages,this.subscribersStatuses=t.subscribersStatuses,this.subscribersConnectivityStatuses=t.subscribersConnectivityStatuses,this.activeClient=t},clearActiveClient:function(){this.activeClient=null,this.entities=[],this.subscribers=[],this.publishers=[],this.subscribersMessagesBuffer=[],this.notResolvedMessages=[],this.subscribersStatuses=[],this.subscribersConnectivityStatuses=[]},findEntity:function(e){return this.entities.findIndex((function(t){return e.type===t.type&&e.index===t.index}))},addPublisher:function(e){e=C()({},at["a"],e),this.publishers.push(w()(e));var t={type:"publisher",rendered:!0,index:this.publishers.length-1,id:Math.random().toString(16).substr(2,8)};this.activeClient.notResolvedFlagInit?this.entities.splice(-1,0,t):this.entities.push(t),this.saveClients(),this.isNeedScroll=!0},addSubscriber:function(e,t){t="number"===typeof t||"string"===typeof t?t:this.activeClient.id;var s=this.clients[t];e=C()({},at["c"],e),s.subscribers.push(w()(e)),s.messages.push([]),s.subscribersMessagesBuffer.push([]),s.subscribersStatuses.push(!1),s.subscribersConnectivityStatuses.push(!1);var i={type:"subscriber",rendered:!0,index:s.subscribers.length-1,id:Math.random().toString(16).substr(2,8)};this.activeClient.notResolvedFlagInit?this.entities.splice(-1,0,i):s.entities.push(i),this.saveClients(),this.activeClient&&(this.isNeedScroll=!0)},removePublisher:function(e){this.publishers.splice(e,1),this.entities.splice(this.findEntity({type:"publisher",index:e}),1),this.entities.forEach((function(t){"publisher"===t.type&&t.index>e&&t.index--})),this.saveClients()},removeSubscriber:function(e){var t=this;return p()(l.a.mark((function s(){var i;return l.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(i=t.subscribersStatuses[e],!i){s.next=4;break}return s.next=4,t.unsubscribeMessageHandler(t.activeClient.id,e);case 4:t.subscribers.splice(e,1),t.clients[t.activeClient.id].subscribersStatuses.splice(e,1),t.subscribersConnectivityStatuses.splice(e,1),t.subscribersMessages.splice(e,1),t.entities.splice(t.findEntity({type:"subscriber",index:e}),1),t.entities.forEach((function(t){"subscriber"===t.type&&t.index>e&&t.index--})),t.saveClients();case 11:case"end":return s.stop()}}),s)})))()},inputSubscriber:function(e,t){this.$set(this.subscribers,e,t),this.saveClients()},inputPublisher:function(e,t){this.$set(this.publishers,e,t),this.saveClients()},publishMessageHandler:function(e,t){var s=this;return p()(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s.publishFreeMessage(s.publishers[t]);case 2:case"end":return e.stop()}}),e)})))()},publishFreeMessage:function(e){var t=this;return p()(l.a.mark((function s(){return l.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e=t.clearObject(e),s.prev=1,s.next=4,t.activeClient.client.publish(e.topic,e.payload,e.options);case 4:t.$q.notify({message:'<div class="text-center" style="font-size: 1.2rem;">Published successfuly in topic '.concat(e.topic,"</div>"),html:!0,color:"positive",timeout:700}),s.next=10;break;case 7:s.prev=7,s.t0=s["catch"](1),t.activeClient.status?t.errorHandler(t.activeClient.id,s.t0,!0):t.errorHandler(t.activeClient.id,new Error("Client disconnected"),!0);case 10:case"end":return s.stop()}}),s,null,[[1,7]])})))()},subscribeMessageHandler:function(e,t){var s=this;return p()(l.a.mark((function i(){var r;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(r=s.clearObject(s.subscribers[t]),!s.subscribers.reduce((function(e,t,i){return s.subscribersStatuses[i]&&e.push(t.topic),e}),[]).filter((function(e){return e===r.topic||r.topic===s.getSharedTopicFilter(e)||e===s.getSharedTopicFilter(r.topic)})).length){i.next=4;break}return s.showError(new Error("You have another subscription with same topic")),i.abrupt("return",!1);case 4:return s.subscribersMessages&&s.subscribersMessages.length&&s.$set(s.subscribersMessages,t,1===r.mode?{}:[]),i.next=7,s.subscribe(e,t);case 7:case"end":return i.stop()}}),i)})))()},subscribe:function(e,t){var s=this;return p()(l.a.mark((function i(){var r,n,o;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return r=s.clients[e],n=s.clearObject(r.subscribers[t]),i.prev=1,s.$set(s.clients[e].subscribersStatuses,t,!0),s.$set(s.clients[e].subscribersConnectivityStatuses,t,!1),i.next=6,r.client.subscribe(n.topic,n.options);case 6:if(o=i.sent,s.$set(s.clients[e].subscribersConnectivityStatuses,t,!0),!o.length){i.next=12;break}if(r.logs.push({type:"subscribe",data:{settings:n,grants:o},timestamp:Date.now()}),!((128&o[0].qos)>0)){i.next=12;break}throw new Error("Subscription error ".concat(o[0].qos));case 12:i.next=19;break;case 14:i.prev=14,i.t0=i["catch"](1),s.$set(s.clients[e].subscribersStatuses,t,!1),s.$set(s.clients[e].subscribersConnectivityStatuses,t,!1),r.status?s.errorHandler(e,i.t0,!0):s.errorHandler(e,new Error("Client disconnected"),!0);case 19:s.saveClients();case 20:case"end":return i.stop()}}),i,null,[[1,14]])})))()},playSubscriberHandler:function(e){this.$set(this.subscribers[e],"missedMessages",void 0),this.$set(this.subscribersStatuses,e,!0)},pauseSubscriberHandler:function(e){this.$set(this.subscribers[e],"missedMessages",0),this.$set(this.subscribersStatuses,e,"paused")},clearMessagesHandler:function(e){var t=this.subscribersMessages[e];t.splice(0,t.length)},unsubscribeMessageHandler:function(e,t){var s=this;return p()(l.a.mark((function i(){return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,s.unsubscribe(e,t);case 2:case"end":return i.stop()}}),i)})))()},unsubscribe:function(e,t){var s=this;return p()(l.a.mark((function i(){var r,n;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return r=s.clients[e],n=s.clearObject(r.subscribers[t]),i.prev=1,r.subscribersConnectivityStatuses[t]||s.$set(r.subscribersConnectivityStatuses,t,!0),s.$set(r.subscribersStatuses,t,!1),s.$set(r.messages,t,1===n.mode?{}:[]),s.$set(r.subscribersMessagesBuffer,t,[]),i.next=8,r.client.unsubscribe(n.topic,{properties:n.unsubscribeProperties});case 8:r.logs.push({type:"unsubscribe",data:s.clearObject(n),timestamp:Date.now()}),s.$set(r.subscribersConnectivityStatuses,t,!1),i.next=15;break;case 12:i.prev=12,i.t0=i["catch"](1),r.status?s.errorHandler(e,i.t0,!0):s.errorHandler(e,new Error("Client disconnected"),!0);case 15:case"end":return i.stop()}}),i,null,[[1,12]])})))()},sendFromSubscriberHandler:function(e){var t=this;this.republishMessage=w()(e),this.$nextTick((function(){t.$refs.publisherModal.show()}))},clearLogs:function(){var e=this.activeClient.logs;e.splice(0,e.length)},pickEntity:function(e){var t=this.entities[e];t.rendered||this.$set(this.entities[e],"rendered",!0),this.scrollToEntity(e)},scrollToEntity:function(e){if(this.$refs.wrapper){var t=this.$refs.wrapper,s=this.wrapperWidth/this.colsCount,i=s*e,r=Math.abs(t.scrollLeft-i)/s*50;A.start({from:t.scrollLeft,to:i,duration:r,apply:function(e){t.scrollLeft=e}})}},clearUnresolvedMessages:function(){var e=this.activeClient.notResolvedMessages;e.splice(0,e.length)},swipeHandler:function(e){var t=this.$refs.wrapper,s=this.wrapperWidth/this.colsCount,i=e.direction,r=0;t&&"left"===i?r=t.scrollLeft+s:t&&"right"===i&&(r=t.scrollLeft-s),A.start({from:t.scrollLeft,to:r,duration:200,apply:function(e){t.scrollLeft=e}})},getCid:function(e){return k()(JSON.parse(k()(e,"properties.userProperties.token","{}")),"cid",null)},makeFlespiRestBus:function(e){var t=this,s=this.clients[e],i=new zt;i.bus.auth.getRegions().then((function(r){r=k()(r,"data.result",[]);var n=r.reduce((function(e,t){var i=t["mqtt-ws"].split(":")[0];return-1!==s.config.host.indexOf(i)?t:e}));n?(i.settings={server:n.rest},i.token=s.config.username,t.$set(t.clients[e],"restBus",i)):t.$set(t.clients[e],"restBus",null)}))},onWrapperResize:function(e){var t=e.width;this.wrapperWidth=t;var s=this.$refs.wrapper,i=this.getÐ¡olsCount(t),r=t/i,n=r*this.firstViewedPanelIndex;s.scrollLeft=n},closeAllHandler:function(){for(var e=this.entities.length-1;e>=0;e--){var t=this.entities[e],s=t.type,i=t.index;"subscriber"===s?this.removeSubscriber(i):"publisher"===s&&this.removePublisher(i)}}},watch:{subscribersStatuses:function(e){this.saveClients()}},created:function(){var e=this;if(this.wrapperScroll=$()((function(t){if(e.$refs.wrapper){var s=e.$refs.wrapper,i=e.wrapperWidth/e.colsCount;e.firstViewedPanelIndex=Math.round(s.scrollLeft/i)}}),100),this.needInitNewClient&&!this.configuredClients.length&&(this.createClient(w()(C()({},at["b"],this.initSettings))),this.setActiveClient(0)),this.configuredClients.length)this.initExternalClients(this.configuredClients);else if(this.useLocalStorage){var t=O["a"].getItem(Qt);this.initExternalClients(t)}this.isInited=!0,window&&window.addEventListener("beforeunload",(function(){for(var t in e.clients){var s=e.clients[t];s.status&&(s.processTimer&&clearInterval(s.processTimer),e.destroyClient(s.client))}}))},destroyed:function(){for(var e in this.clients){var t=this.clients[e];t.status&&(t.processTimer&&clearInterval(t.processTimer),this.destroyClient(t.client))}},components:{ClientSettingsModal:ft,SliderController:St,Subscriber:je,Publisher:Le,Unresolved:We,Logs:Ge,PublisherModal:rt,EntitiesMenu:It},updated:function(){if(this.isNeedScroll){var e=this.$refs.wrapper;A.start({from:e.scrollLeft,to:e.scrollWidth,duration:300,apply:function(t){e.scrollLeft=t}}),this.isNeedScroll=!1}},mixins:[ut]},es=Zt,ts=(s("dec3"),Object(K["a"])(es,i,r,!1,null,null,null));t["a"]=ts.exports},f67f:function(e,t,s){},fbcf:function(e,t,s){"use strict";var i=s("d619"),r=s.n(i);r.a}}]);